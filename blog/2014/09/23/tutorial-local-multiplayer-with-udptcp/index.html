<!DOCTYPE html>
<html lang="en-US"
	prefix="og: http://ogp.me/ns#" >
<head>
	
	<meta charset="UTF-8" />
	
	<title>Tutorial: Local multiplayer with UDP/TCP | Corona Labs</title><link rel="stylesheet" href="/wordpress/wp-content/cache/min/1/00d0de513e0511587eebe2100ad2cfec.css" data-minify="1" />

	
	<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=yes">
	
	<link rel="profile" href="https://gmpg.org/xfn/11" />
	<link rel="pingback" href="/wordpress/xmlrpc.php" />
	
	<link rel="shortcut icon" href="/favicon.ico">
	<link rel="apple-touch-icon" sizes="180x180" href="/fav/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/fav/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/fav/favicon-16x16.png">
	<link rel="manifest" href="/fav/site.webmanifest">
	<link rel="mask-icon" href="/fav/safari-pinned-tab.svg" color="#f96f29">
	<meta name="msapplication-TileColor" content="#f96f29">
	<meta name="msapplication-config" content="/fav/browserconfig.xml">
	<meta name="theme-color" content="#ffffff">
	
	<script type="application/javascript">var QodeAjaxUrl = "/wordpress/wp-admin/admin-ajax.php"</script><link rel="alternate" hreflang="en" href="/blog/2014/09/23/tutorial-local-multiplayer-with-udptcp/" />

<!-- All in One SEO Pack 2.11 by Michael Torbert of Semper Fi Web Designob_start_detected [-1,-1] -->
<link rel="author" href="https://plus.google.com/106405667962965815359/" />
<meta name="description"  content="In this guest tutorial, Corona developer Mark Steelman discusses the implementation of local area networking between two devices using LuaSocket and UDP/TCP. Read further to learn how." />

<meta name="keywords"  content="lan,network,peer-to-peer,tutorial,guest bloggers,tutorials, tips and demos" />

<link rel="canonical" href="/blog/2014/09/23/tutorial-local-multiplayer-with-udptcp/" />
<meta property="og:title" content="Tutorial: Local multiplayer with UDP/TCP | Corona Labs" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/blog/2014/09/23/tutorial-local-multiplayer-with-udptcp/" />
<meta property="og:image" content="/wordpress/wp-content/uploads/2014/09/lan-feat.png" />
<meta property="og:site_name" content="Corona Labs" />
<meta property="fb:app_id" content="1891032014500066" />
<meta property="og:description" content="Today&#039;s guest tutorial comes to you courtesy of Mark Steelman, founder of Steelman Games LLC. Mark is currently working on a turn-based RPG incorporating local multiplayer called Legend of Us Roleplaying Game. Before becoming an indie developer, Mark worked for four years at Electronic Arts as a game designer. You can follow the progress of his projects on Facebook, Google+, or by subscribing to his newsletter. Make devices find each other with UDP As noted in the introduction, I&#039;m building a turn-based role-playing game using Corona SDK. As part of the design, I wanted local multiplayer and I also wanted it to be cross-platform. After a lot of research, I figured out how to accomplish this and, in this tutorial, I will share some of what I learned. Even better: this architecture will work for both turn-based and action games, so stick around if you&#039;re making an action game! This tutorial assumes that you have a basic understanding of Corona SDK, Lua, and peer-to-peer networking. We" />
<meta property="article:published_time" content="2014-09-23T21:56:05Z" />
<meta property="article:modified_time" content="2014-09-23T21:56:05Z" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@coronalabs" />
<meta name="twitter:title" content="Tutorial: Local multiplayer with UDP/TCP | Corona Labs" />
<meta name="twitter:description" content="Today&#039;s guest tutorial comes to you courtesy of Mark Steelman, founder of Steelman Games LLC. Mark is currently working on a turn-based RPG incorporating local multiplayer called Legend of Us Roleplaying Game. Before becoming an indie developer, Mark worked for four years at Electronic Arts as a game designer. You can follow the progress of his projects on Facebook, Google+, or by subscribing to his newsletter. Make devices find each other with UDP As noted in the introduction, I&#039;m building a turn-based role-playing game using Corona SDK. As part of the design, I wanted local multiplayer and I also wanted it to be cross-platform. After a lot of research, I figured out how to accomplish this and, in this tutorial, I will share some of what I learned. Even better: this architecture will work for both turn-based and action games, so stick around if you&#039;re making an action game! This tutorial assumes that you have a basic understanding of Corona SDK, Lua, and peer-to-peer networking. We" />
<meta name="twitter:image" content="/wordpress/wp-content/uploads/2014/09/lan-feat.png" />
<meta itemprop="image" content="/wordpress/wp-content/uploads/2014/09/lan-feat.png" />
			<script type="text/javascript" >
				window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
				ga('create', 'UA-9574984-6', 'auto', { 'allowLinker': true } );
				// Plugins
				ga('require', 'linkid', 'linkid.js');ga('require', 'outboundLinkTracker');
				ga('send', 'pageview');
			</script>
			<script async src="https://www.google-analytics.com/analytics.js"></script>
			<script data-minify="1" async src="/wordpress/wp-content/cache/min/1/wordpress/wp-content/plugins/all-in-one-seo-pack/public/js/vendor/autotrack-b66c534ea2d32d9123d9ba2034031f08.js"></script>
<!-- /all in one seo pack -->
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="Corona Labs &raquo; Feed" href="/feed/" />
<link rel="alternate" type="application/rss+xml" title="Corona Labs &raquo; Comments Feed" href="/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Corona Labs &raquo; Tutorial: Local multiplayer with UDP/TCP Comments Feed" href="/blog/2014/09/23/tutorial-local-multiplayer-with-udptcp/feed/" />





<style id='contact-form-7-inline-css' type='text/css'>
.wpcf7 .wpcf7-recaptcha iframe {margin-bottom: 0;}
</style>

<link rel='stylesheet' id='tp-open-sans-css'  href='https://fonts.googleapis.com/css?family=Open+Sans%3A300%2C400%2C600%2C700%2C800&#038;ver=4.9.8' type='text/css' media='all' />
<link rel='stylesheet' id='tp-raleway-css'  href='https://fonts.googleapis.com/css?family=Raleway%3A100%2C200%2C300%2C400%2C500%2C600%2C700%2C800%2C900&#038;ver=4.9.8' type='text/css' media='all' />
<link rel='stylesheet' id='tp-exo2-css'  href='https://fonts.googleapis.com/css?family=Exo+2%3A600&#038;subset=cyrillic&#038;ver=4.9.8' type='text/css' media='all' />
<link rel='stylesheet' id='tp-lato-css'  href='https://fonts.googleapis.com/css?family=Lato&#038;ver=4.9.8' type='text/css' media='all' />

<style id='rs-plugin-settings-inline-css' type='text/css'>
#rs-demo-id {}
</style>














<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/jquery-1.12.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/jquery-migrate.min-1.4.1.js'></script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/plugins/nix-gravatar-cache-master/js/main-b8674cbf705f6800e4c39626ea12a541.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"\/wordpress\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min-_2.7.2_beta.js'></script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/plugins/handl-utm-grabber/js/js.cookie-1a19bb4009b00727ae545e834c88ec1f.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var handl_utm = [];
/* ]]> */
</script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/plugins/handl-utm-grabber/js/handl-utm-grabber-88312d6ccff4a3570b3db197b12cb532.js'></script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/plugins/essential-grid/public/assets/js/lightbox-698aa832940bd67decd795f1bd23433b.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-content/plugins/essential-grid/public/assets/js/jquery.themepunch.tools.min-2.1.0.2.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-content/plugins/revslider/public/assets/js/jquery.themepunch.revolution.min-5.4.7.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-content/plugins/wp-popups-lite/src/assets/js/hooks.min-2.0.3.7.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_browser_redirect_params = {"pageLanguage":"en","languageUrls":{"en_US":"\/blog\/2014\/09\/23\/tutorial-local-multiplayer-with-udptcp\/","en":"\/blog\/2014\/09\/23\/tutorial-local-multiplayer-with-udptcp\/","US":"\/blog\/2014\/09\/23\/tutorial-local-multiplayer-with-udptcp\/"},"cookie":{"name":"_icl_visitor_lang_js","domain":"coronalabs.com","path":"\/","expiration":24}};
/* ]]> */
</script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/plugins/sitepress-multilingual-cms/dist/js/browser-redirect/app-824426e66e79e692e26c5e5b63cb6452.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"\/wordpress\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data-3d7bf654e9e30cc40e584574182b2763.js'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/wordpress/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wordpress/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='From the Forum &#8212; Issue #38' href='/blog/2014/09/19/from-the-forum-issue-38/' />
<link rel='next' title='OSX 10.9.5 and Corona SDK' href='/blog/2014/09/23/os-x-mavericks-10-9-5-and-corona-sdk/' />
<meta name="generator" content="WordPress 4.9.8" />
<link rel='shortlink' href='/?p=59630' />
<meta name="generator" content="WPML ver:4.1.1 stt:1,46;" />
<link rel="alternate" type="application/json" title="Corona Labs &raquo; JSON Feed" href="/feed/json/" />		<script type="text/javascript">
			var ajaxRevslider;
			
			jQuery(document).ready(function() {
				// CUSTOM AJAX CONTENT LOADING FUNCTION
				ajaxRevslider = function(obj) {
				
					// obj.type : Post Type
					// obj.id : ID of Content to Load
					// obj.aspectratio : The Aspect Ratio of the Container / Media
					// obj.selector : The Container Selector where the Content of Ajax will be injected. It is done via the Essential Grid on Return of Content
					
					var content = "";

					data = {};
					
					data.action = 'revslider_ajax_call_front';
					data.client_action = 'get_slider_html';
					data.token = 'a5acf8e1ab';
					data.type = obj.type;
					data.id = obj.id;
					data.aspectratio = obj.aspectratio;
					
					// SYNC AJAX REQUEST
					jQuery.ajax({
						type:"post",
						url:"/wordpress/wp-admin/admin-ajax.php",
						dataType: 'json',
						data:data,
						async:false,
						success: function(ret, textStatus, XMLHttpRequest) {
							if(ret.success == true)
								content = ret.data;								
						},
						error: function(e) {
							console.log(e);
						}
					});
					
					 // FIRST RETURN THE CONTENT WHEN IT IS LOADED !!
					 return content;						 
				};
				
				// CUSTOM AJAX FUNCTION TO REMOVE THE SLIDER
				var ajaxRemoveRevslider = function(obj) {
					return jQuery(obj.selector+" .rev_slider").revkill();
				};

				// EXTEND THE AJAX CONTENT LOADING TYPES WITH TYPE AND FUNCTION
				var extendessential = setInterval(function() {
					if (jQuery.fn.tpessential != undefined) {
						clearInterval(extendessential);
						if(typeof(jQuery.fn.tpessential.defaults) !== 'undefined') {
							jQuery.fn.tpessential.defaults.ajaxTypes.push({type:"revslider",func:ajaxRevslider,killfunc:ajaxRemoveRevslider,openAnimationSpeed:0.3});   
							// type:  Name of the Post to load via Ajax into the Essential Grid Ajax Container
							// func: the Function Name which is Called once the Item with the Post Type has been clicked
							// killfunc: function to kill in case the Ajax Window going to be removed (before Remove function !
							// openAnimationSpeed: how quick the Ajax Content window should be animated (default is 0.3)
						}
					}
				},30);
			});
		</script>
		<meta name="generator" content="Powered by WPBakery Page Builder - drag and drop page builder for WordPress."/>
<!--[if lte IE 9]><link rel="stylesheet" type="text/css" href="/wordpress/wp-content/plugins/js_composer/assets/css/vc_lte_ie9.min.css" media="screen"><![endif]--><style type="text/css" id="spu-css-76435" class="spu-css">		#spu-bg-76435 {
			background-color: rgba(117, 169, 177, 0.33);
		}

		#spu-76435 .spu-close {
			font-size: 40px;
			color: rgb(255, 255, 255);
			text-shadow: 0 1px 0#000;
		}

		#spu-76435 .spu-close:hover {
			color: #000;
		}

		#spu-76435 {
			background-color: rgb(246, 246, 240);
			max-width: 750px;
			
					height: auto;
					box-shadow:  5px 5px 5px 0px #ccc;
				}

		#spu-76435 .spu-container {
					border: 5px solid;
			border-color: rgb(6, 94, 79);
			border-radius: 0px;
			margin: 14px;
					padding: 50px;
			height: calc(100% - 28px);
		}
								</style>
		<script type="text/javascript">function setREVStartSize(e){									
						try{ e.c=jQuery(e.c);var i=jQuery(window).width(),t=9999,r=0,n=0,l=0,f=0,s=0,h=0;
							if(e.responsiveLevels&&(jQuery.each(e.responsiveLevels,function(e,f){f>i&&(t=r=f,l=e),i>f&&f>r&&(r=f,n=e)}),t>r&&(l=n)),f=e.gridheight[l]||e.gridheight[0]||e.gridheight,s=e.gridwidth[l]||e.gridwidth[0]||e.gridwidth,h=i/s,h=h>1?1:h,f=Math.round(h*f),"fullscreen"==e.sliderLayout){var u=(e.c.width(),jQuery(window).height());if(void 0!=e.fullScreenOffsetContainer){var c=e.fullScreenOffsetContainer.split(",");if (c) jQuery.each(c,function(e,i){u=jQuery(i).length>0?u-jQuery(i).outerHeight(!0):u}),e.fullScreenOffset.split("%").length>1&&void 0!=e.fullScreenOffset&&e.fullScreenOffset.length>0?u-=jQuery(window).height()*parseInt(e.fullScreenOffset,0)/100:void 0!=e.fullScreenOffset&&e.fullScreenOffset.length>0&&(u-=parseInt(e.fullScreenOffset,0))}f=u}else void 0!=e.minHeight&&f<e.minHeight&&(f=e.minHeight);e.c.closest(".rev_slider_wrapper").css({height:f})					
						}catch(d){console.log("Failure at Presize of Slider:"+d)}						
					};</script>
<noscript><style type="text/css"> .wpb_animate_when_almost_visible { opacity: 1; }</style></noscript>	
<script>
var trackOutboundLink = function(url, name) {
ga('send', 'event', name, 'click', url, {
'transport': 'beacon'
});
}
</script>

<!-- Counters go here --></head>

<body data-rsssl=1 class="post-template-default single single-post postid-59630 single-format-standard  qode-child-theme-ver-1.0.0 qode-theme-ver-11.0 qode-theme-bridge wpb-js-composer js-comp-ver-5.5.5 vc_responsive" itemscope itemtype="http://schema.org/WebPage">

						<div class="wrapper">
	<div class="wrapper_inner">
	<!-- Google Analytics start -->
	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-9574984-6', 'auto');
  ga('send', 'pageview');

</script>
	<!-- Google Analytics end -->

	


<header class="scroll_header_top_area  stick transparent scrolled_not_transparent page_header">
    <div class="header_inner clearfix">

		<div class="header_top_bottom_holder">
		<div class="header_bottom clearfix" style=' background-color:rgba(255, 255, 255, 0);' >
		                    					<div class="header_inner_left">
                        													<div class="mobile_menu_button">
                                <span>
                                    <i class="qode_icon_font_awesome fa fa-bars" ></i>                                </span>
                            </div>
												<div class="logo_wrapper">
                            							<div class="q_logo">
								<a itemprop="url" href="/">
									<img itemprop="image" class="normal" src="/wordpress/wp-content/uploads/2017/12/logo_s.svg" alt="Logo"/>
									<img itemprop="image" class="light" src="/wordpress/wp-content/uploads/2017/12/logo_s.svg" alt="Logo"/>
									<img itemprop="image" class="dark" src="/wordpress/wp-content/uploads/2017/12/logo_s.svg" alt="Logo"/>
									<img itemprop="image" class="sticky" src="/wordpress/wp-content/uploads/2017/12/logo_w.svg" alt="Logo"/>
									<img itemprop="image" class="mobile" src="/wordpress/wp-content/uploads/2017/12/logo_w.svg" alt="Logo"/>
																	</a>
							</div>
                            						</div>
                                                					</div>
                    					                                                							<div class="header_inner_right">
                                <div class="side_menu_button_wrapper right">
																		                                    <div class="side_menu_button">
									
										                                                                                                                    </div>
                                </div>
							</div>
												
						
						<nav class="main_menu drop_down right">
						<ul id="menu-top-menu-corona" class=""><li id="nav-menu-item-71022" class="menu-item menu-item-type-custom menu-item-object-custom  narrow"><a title="Product" href="/product/" class=""><i class="menu_icon blank fa"></i><span>PRODUCT</span><span class="plus"></span></a></li>
<li id="nav-menu-item-71023" class="menu-item menu-item-type-custom menu-item-object-custom  narrow"><a title="Learn" href="/learn/" class=""><i class="menu_icon blank fa"></i><span>LEARN</span><span class="plus"></span></a></li>
<li id="nav-menu-item-71024" class="menu-item menu-item-type-custom menu-item-object-custom  narrow"><a title="Stories" href="/stories/" class=""><i class="menu_icon blank fa"></i><span>STORIES</span><span class="plus"></span></a></li>
<li id="nav-menu-item-76070" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent  narrow"><a href="/blog/" class=""><i class="menu_icon blank fa"></i><span>BLOG</span><span class="plus"></span></a></li>
<li id="nav-menu-item-71112" class="menu-item menu-item-type-custom menu-item-object-custom  narrow"><a title="Forum" target="_blank" href="https://forums.solar2d.com/" class=""><i class="menu_icon blank fa"></i><span>FORUM</span><span class="plus"></span></a></li>
<li id="nav-menu-item-72910" class="menu-item menu-item-type-custom menu-item-object-custom  narrow"><a title="Marketplace" target="_blank" href="https://marketplace.coronalabs.com/" class=""><i class="menu_icon blank fa"></i><span>MARKET</span><span class="plus"></span></a></li>
<li id="nav-menu-item-71027" class="menu-item menu-item-type-custom menu-item-object-custom  narrow"><a title="Login" target="_blank" href="https://github.com/coronalabs/corona" class=""><i class="menu_icon blank fa"></i><span>LOG IN</span><span class="plus"></span></a></li>
<li id="nav-menu-item-71028" class="menu-item menu-item-type-custom menu-item-object-custom  narrow"><a title="Download" target="_blank" href="https://github.com/coronalabs/corona/releases/latest" class=""><i class="menu_icon blank fa"></i><span>DOWNLOAD</span><span class="plus"></span></a></li>
<li id="nav-menu-item-wpml-ls-1014-en" class="menu-item wpml-ls-slot-1014 wpml-ls-item wpml-ls-item-en wpml-ls-current-language wpml-ls-menu-item wpml-ls-first-item wpml-ls-last-item menu-item-type-wpml_ls_menu_item menu-item-object-wpml_ls_menu_item  narrow"><a title="EN" href="/blog/2014/09/23/tutorial-local-multiplayer-with-udptcp/" class=""><i class="menu_icon blank fa"></i><span><span class="wpml-ls-native">EN</span></span><span class="plus"></span></a></li>
</ul>						</nav>
						                        										<nav class="mobile_menu">
                        <ul id="menu-top-menu-corona-1" class=""><li id="mobile-menu-item-71022" class="menu-item menu-item-type-custom menu-item-object-custom"><a title="Product" href="/product/" class=""><span>PRODUCT</span></a><span class="mobile_arrow"><i class="fa fa-angle-right"></i><i class="fa fa-angle-down"></i></span></li>
<li id="mobile-menu-item-71023" class="menu-item menu-item-type-custom menu-item-object-custom"><a title="Learn" href="/learn/" class=""><span>LEARN</span></a><span class="mobile_arrow"><i class="fa fa-angle-right"></i><i class="fa fa-angle-down"></i></span></li>
<li id="mobile-menu-item-71024" class="menu-item menu-item-type-custom menu-item-object-custom"><a title="Stories" href="/stories/" class=""><span>STORIES</span></a><span class="mobile_arrow"><i class="fa fa-angle-right"></i><i class="fa fa-angle-down"></i></span></li>
<li id="mobile-menu-item-76070" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent"><a href="/blog/" class=""><span>BLOG</span></a><span class="mobile_arrow"><i class="fa fa-angle-right"></i><i class="fa fa-angle-down"></i></span></li>
<li id="mobile-menu-item-71112" class="menu-item menu-item-type-custom menu-item-object-custom"><a title="Forum" target="_blank" href="https://forums.solar2d.com/" class=""><span>FORUM</span></a><span class="mobile_arrow"><i class="fa fa-angle-right"></i><i class="fa fa-angle-down"></i></span></li>
<li id="mobile-menu-item-72910" class="menu-item menu-item-type-custom menu-item-object-custom"><a title="Marketplace" target="_blank" href="https://marketplace.coronalabs.com/" class=""><span>MARKET</span></a><span class="mobile_arrow"><i class="fa fa-angle-right"></i><i class="fa fa-angle-down"></i></span></li>
<li id="mobile-menu-item-71027" class="menu-item menu-item-type-custom menu-item-object-custom"><a title="Login" target="_blank" href="https://github.com/coronalabs/corona" class=""><span>LOG IN</span></a><span class="mobile_arrow"><i class="fa fa-angle-right"></i><i class="fa fa-angle-down"></i></span></li>
<li id="mobile-menu-item-71028" class="menu-item menu-item-type-custom menu-item-object-custom"><a title="Download" target="_blank" href="https://github.com/coronalabs/corona/releases/latest" class=""><span>DOWNLOAD</span></a><span class="mobile_arrow"><i class="fa fa-angle-right"></i><i class="fa fa-angle-down"></i></span></li>
<li id="mobile-menu-item-wpml-ls-1014-en" class="menu-item wpml-ls-slot-1014 wpml-ls-item wpml-ls-item-en wpml-ls-current-language wpml-ls-menu-item wpml-ls-first-item wpml-ls-last-item menu-item-type-wpml_ls_menu_item menu-item-object-wpml_ls_menu_item"><a title="EN" href="/blog/2014/09/23/tutorial-local-multiplayer-with-udptcp/" class=""><span><span class="wpml-ls-native">EN</span></span></a><span class="mobile_arrow"><i class="fa fa-angle-right"></i><i class="fa fa-angle-down"></i></span></li>
</ul>					</nav>
				</div>
	</div>
	</div>

</header>
		

    		<a id='back_to_top' href='#'>
			<span class="fa-stack">
				<i class="fa fa-arrow-up" style=""></i>
			</span>
		</a>
	    	
    
		
	
    
<div class="content">
						<div class="content_inner">
						<div class="title_outer title_without_animation"    data-height="364">
		<div class="title title_size_large  position_center  has_background" style="background-size:1920px auto;background-image:url(/wordpress/wp-content/uploads/2017/06/bg_short_header.jpg);height:364px;">
			<div class="image not_responsive"><img itemprop="image" src="/wordpress/wp-content/uploads/2017/06/bg_short_header.jpg" alt="&nbsp;" /> </div>
										<div class="title_holder"  style="padding-top:42px;height:322px;">
					<div class="container">
						<div class="container_inner clearfix">
								<div class="title_subtitle_holder" >
                                                                									<div class="title_subtitle_holder_inner">
																										<h1 ><span>Tutorial: Local multiplayer with UDP/TCP</span></h1>
																	
																																			</div>
								                                                            </div>
						</div>
					</div>
				</div>
								</div>
			</div>
										<div class="container">
														<div class="container_inner default_template_holder" >
																
							<div class="two_columns_75_25 background_color_sidebar grid2 clearfix">
								<div class="column1">
											
									<div class="column_inner">
										<div class="blog_single blog_holder">
													<article id="post-59630" class="post-59630 post type-post status-publish format-standard has-post-thumbnail hentry category-guest-bloggers category-tutorials-tips-demos tag-lan tag-network tag-peer-to-peer tag-tutorial">
			<div class="post_content_holder">
								<div class="post_text">
					<div class="post_text_inner">
<p><span itemprop="dateCreated" class="date entry_date updated">23 September 2014<meta itemprop="interactionCount" content="UserComments: 25"/></span></p>
						<h2 itemprop="name" class="entry_title">Tutorial: Local multiplayer with UDP/TCP</h2>

						<div class="post_info">

<i class="fa fa-user" aria-hidden="true"></i> <span class="post_author" itemprop="author" itemscope itemtype="http://schema.org/Person"> <a itemprop="name" class="post_author_link" href="/blog/author/rob/">Rob Miracle</a>
							</span>

							<br><i class="fa fa-hashtag" aria-hidden="true"></i> <span class="time"><a href="/blog/topics/guest-bloggers/" rel="category tag">Guest Bloggers</a>, <a href="/blog/topics/tutorials-tips-demos/" rel="category tag">Tutorials, Tips and Demos</a></span>
							
							
							
                                            <span class="dots"><i class="fa fa-square"></i></span><div class="blog_share qode_share"><div class="social_share_holder"><a href="javascript:void(0)" target="_self"><span class="social_share_title">Share</span></a><div class="social_share_dropdown"><div class="inner_arrow"></div><ul><li class="facebook_share"><a href="javascript:void(0)" onclick="window.open('http://www.facebook.com/sharer.php?s=100&amp;p[title]=Tutorial%3A+Local+multiplayer+with+UDP%2FTCP&amp;p[url]=%2Fblog%2F2014%2F09%2F23%2Ftutorial-local-multiplayer-with-udptcp%2F&amp;p[images][0]=/wordpress/wp-content/uploads/2014/09/lan-feat.png&amp;p[summary]=In+this+guest+tutorial%2C+Corona+developer+Mark+Steelman+discusses+the+implementation+of+local+area+networking+between+two+devices+using+LuaSocket+and+UDP%2FTCP.+Read+further+to+learn+how.', 'sharer', 'toolbar=0,status=0,width=620,height=280');"><i class="fa fa-facebook"></i></a></li><li class="twitter_share"><a href="#" onclick="popUp=window.open('http://twitter.com/home?status=In+this+guest+tutorial%2C+Corona+developer+Mark+Steelman+discusses+the+implementation+of+local+area+networking+between+/blog/2014/09/23/tutorial-local-multiplayer-with-udptcp/', 'popupwindow', 'scrollbars=yes,width=800,height=400');popUp.focus();return false;"><i class="fa fa-twitter"></i></a></li><li  class="vk_share"><a href="#" onclick="popUp=window.open('http://vkontakte.ru/share.php?url=%2Fblog%2F2014%2F09%2F23%2Ftutorial-local-multiplayer-with-udptcp%2F&amp;title=Tutorial%3A+Local+multiplayer+with+UDP%2FTCP&amp;description=In+this+guest+tutorial%2C+Corona+developer+Mark+Steelman+discusses+the+implementation+of+local+area+networking+between+two+devices+using+LuaSocket+and+UDP%2FTCP.+Read+further+to+learn+how.&amp;image=%2Fwordpress%2Fwp-content%2Fuploads%2F2014%2F09%2Flan-feat.png', 'popupwindow', 'scrollbars=yes,width=800,height=400');popUp.focus();return false"><i class="fa fa-vk"></i></a></li></ul></div></div></div>    						</div>
						<p><em>Today&#8217;s guest tutorial comes to you courtesy of Mark Steelman, founder of Steelman Games LLC. Mark is currently working on a turn-based RPG incorporating local multiplayer called <a href=http://www.legendofus.net/ target="_blank">Legend of Us Roleplaying Game</a>. Before becoming an indie developer, Mark worked for four years at Electronic Arts as a game designer. You can follow the progress of his projects on <a href=http://www.facebook.com/legendofusrpg target="_blank">Facebook</a>, <a title="Legend of Us RPG Google+" href=http://plus.google.com/+LegendofusNet target="_blank">Google+</a>, or by subscribing to his <a title="Legend of Us RPG main page" href=http://www.legendofus.net/ target="_blank">newsletter</a>.</em></p>
<hr />
<h3>Make devices find each other with UDP</h3>
<p>As noted in the introduction, I&#8217;m building a <a href=http://www.legendofus.net/ target="_blank">turn-based role-playing game</a> using Corona SDK. As part of the design, I wanted <strong>local multiplayer</strong> and I also wanted it to be <strong>cross-platform</strong>. After a lot of research, I figured out how to accomplish this and, in this tutorial, I will share some of what I learned. Even better: this architecture will work for both turn-based and action games, so stick around if you&#8217;re making an action game!</p>
<p>This tutorial assumes that you have a basic understanding of Corona SDK, Lua, and peer-to-peer networking. We are going to use <a title="link to LUA Socket documentation" href=http://w3.impa.br/~diego/software/luasocket/ target="_blank">LuaSocket</a> which is included in Corona SDK under the <a href=http://docs.coronalabs.com/api/library/socket/index.html target="_blank">socket</a> library. Because this design is intended for cross-platform multiplayer, it&#8217;s not going to use any native systems. While it does assume that the player has a Local Area Network (LAN), that network doesn’t need to be connected to the internet.</p>
<h3>Including LuaSocket</h3>
<p>In order to use LuaSocket, you must first include it:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df512cc5e7812437943" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
local socket = require( "socket" ) </textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df512cc5e7812437943-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df512cc5e7812437943-1"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">socket</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">require</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"socket"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0021 seconds] -->
<p>That&#8217;s the easy part &#8212; let&#8217;s continue&#8230;</p>
<h3>UDP and TCP</h3>
<p>First, let me give a brief explanation of <strong>UDP</strong> and <strong>TCP</strong>. Both of these are protocols which allow computers to talk to each other and each one has certain advantages and disadvantages. However, I’m only going to cover features that are relevant to the tutorial.</p>
<p><strong>UDP</strong> has the ability to send messages to an address without knowing if anything is there. It doesn’t check to see if the message made it anywhere &#8212; it simply transmits the message. UDP also allows you to listen to an address without being connected to a computer at that address.</p>
<p><strong>TCP</strong> is a reliable protocol. It sends messages to another computer that it&#8217;s connected to via a TCP socket. If the other computer responds that there was a problem with the message, it sends the message again.</p>
<p>Knowing this, you might ask &#8220;Why would anyone use UDP when TCP is so reliable?&#8221; Well, there are several reasons, but the reason most relevant to this tutorial is the fact that you must know the IP address of the server in order to use TCP. Any network which you can join without visiting the LAN administrator is assigning you a random IP address using DHCP. This means that we&#8217;ll need to discover the IP address of the server on our own. Fortunately, UDP can help with that.</p>
<h3>Advertise the server</h3>
<p>For local multiplayer to work, one of the devices must act as the server/host. The host doesn&#8217;t need to have special privileges in your game, but the primary record of the game in progress will be stored on this device. In the language of role-playing games, let&#8217;s call this player the <strong>game master</strong>. This game master is going to announce his/her presence to the local network via some method. I utilize an &#8220;Invite&#8221; button which calls the following function upon being pressed.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df512cc5fb440061676" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
local advertiseServer = function( button )

    local send = socket.udp()
    send:settimeout( 0 )  --this is important (see notes below)

    local stop

    local counter = 0  --using this, we can advertise our IP address for a limited time

    local function broadcast()
        local msg = "AwesomeGameServer"
        --multicast IP range from 224.0.0.0 to 239.255.255.255
        send:sendto( msg, "228.192.1.1", 11111 )
        --not all devices can multicast so it's a good idea to broadcast too
        --however, for broadcast to work, the network has to allow it
        send:setoption( "broadcast", true )  --turn on broadcast
        send:sendto( msg, "255.255.255.255", 11111 )
        send:setoption( "broadcast", false )  --turn off broadcast

        counter = counter + 1
        if ( counter == 80 ) then  --stop after 8 seconds
            stop()
        end
    end

    --pulse 10 times per second
    local serverBroadcast = timer.performWithDelay( 100, broadcast, 0 )

    button.stopLooking = function()
        timer.cancel( serverBroadcast )  --cancel timer
        button.stopLooking = nil
    end
    stop = button.stopLooking
end</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df512cc5fb440061676-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc5fb440061676-2">2</div><div class="crayon-num" data-line="crayon-5f8df512cc5fb440061676-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc5fb440061676-4">4</div><div class="crayon-num" data-line="crayon-5f8df512cc5fb440061676-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc5fb440061676-6">6</div><div class="crayon-num" data-line="crayon-5f8df512cc5fb440061676-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc5fb440061676-8">8</div><div class="crayon-num" data-line="crayon-5f8df512cc5fb440061676-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc5fb440061676-10">10</div><div class="crayon-num" data-line="crayon-5f8df512cc5fb440061676-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc5fb440061676-12">12</div><div class="crayon-num" data-line="crayon-5f8df512cc5fb440061676-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc5fb440061676-14">14</div><div class="crayon-num" data-line="crayon-5f8df512cc5fb440061676-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc5fb440061676-16">16</div><div class="crayon-num" data-line="crayon-5f8df512cc5fb440061676-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc5fb440061676-18">18</div><div class="crayon-num" data-line="crayon-5f8df512cc5fb440061676-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc5fb440061676-20">20</div><div class="crayon-num" data-line="crayon-5f8df512cc5fb440061676-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc5fb440061676-22">22</div><div class="crayon-num" data-line="crayon-5f8df512cc5fb440061676-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc5fb440061676-24">24</div><div class="crayon-num" data-line="crayon-5f8df512cc5fb440061676-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc5fb440061676-26">26</div><div class="crayon-num" data-line="crayon-5f8df512cc5fb440061676-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc5fb440061676-28">28</div><div class="crayon-num" data-line="crayon-5f8df512cc5fb440061676-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc5fb440061676-30">30</div><div class="crayon-num" data-line="crayon-5f8df512cc5fb440061676-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc5fb440061676-32">32</div><div class="crayon-num" data-line="crayon-5f8df512cc5fb440061676-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc5fb440061676-34">34</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df512cc5fb440061676-1"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">advertiseServer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">button</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc5fb440061676-2">&nbsp;</div><div class="crayon-line" id="crayon-5f8df512cc5fb440061676-3">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">send</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">socket</span><span class="crayon-sy">.</span><span class="crayon-e">udp</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc5fb440061676-4">  <span class="crayon-h"> </span> <span class="crayon-v">send</span><span class="crayon-o">:</span><span class="crayon-e">settimeout</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--this is important (see notes below)</span></div><div class="crayon-line" id="crayon-5f8df512cc5fb440061676-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc5fb440061676-6">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-i">stop</span></div><div class="crayon-line" id="crayon-5f8df512cc5fb440061676-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc5fb440061676-8">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">counter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--using this, we can advertise our IP address for a limited time</span></div><div class="crayon-line" id="crayon-5f8df512cc5fb440061676-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc5fb440061676-10">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">broadcast</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc5fb440061676-11"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">msg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"AwesomeGameServer"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc5fb440061676-12"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-c">--multicast IP range from 224.0.0.0 to 239.255.255.255</span></div><div class="crayon-line" id="crayon-5f8df512cc5fb440061676-13"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">send</span><span class="crayon-o">:</span><span class="crayon-e">sendto</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">msg</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"228.192.1.1"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">11111</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc5fb440061676-14"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-c">--not all devices can multicast so it's a good idea to broadcast too</span></div><div class="crayon-line" id="crayon-5f8df512cc5fb440061676-15"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-c">--however, for broadcast to work, the network has to allow it</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc5fb440061676-16"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">send</span><span class="crayon-o">:</span><span class="crayon-e">setoption</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"broadcast"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">true</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--turn on broadcast</span></div><div class="crayon-line" id="crayon-5f8df512cc5fb440061676-17"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">send</span><span class="crayon-o">:</span><span class="crayon-e">sendto</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">msg</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"255.255.255.255"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">11111</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc5fb440061676-18"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">send</span><span class="crayon-o">:</span><span class="crayon-e">setoption</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"broadcast"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">false</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--turn off broadcast</span></div><div class="crayon-line" id="crayon-5f8df512cc5fb440061676-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc5fb440061676-20"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">counter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">counter</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5f8df512cc5fb440061676-21"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">counter</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">then</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--stop after 8 seconds</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc5fb440061676-22">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">stop</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc5fb440061676-23"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc5fb440061676-24">  <span class="crayon-h"> </span> <span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df512cc5fb440061676-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc5fb440061676-26">  <span class="crayon-h"> </span> <span class="crayon-c">--pulse 10 times per second</span></div><div class="crayon-line" id="crayon-5f8df512cc5fb440061676-27">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">serverBroadcast</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">timer</span><span class="crayon-sy">.</span><span class="crayon-e">performWithDelay</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">broadcast</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc5fb440061676-28">&nbsp;</div><div class="crayon-line" id="crayon-5f8df512cc5fb440061676-29">  <span class="crayon-h"> </span> <span class="crayon-v">button</span><span class="crayon-sy">.</span><span class="crayon-v">stopLooking</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc5fb440061676-30"> <span class="crayon-h"> </span> <span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">timer</span><span class="crayon-sy">.</span><span class="crayon-e">cancel</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">serverBroadcast</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--cancel timer</span></div><div class="crayon-line" id="crayon-5f8df512cc5fb440061676-31"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">button</span><span class="crayon-sy">.</span><span class="crayon-v">stopLooking</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">nil</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc5fb440061676-32">  <span class="crayon-h"> </span> <span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df512cc5fb440061676-33">  <span class="crayon-h"> </span> <span class="crayon-v">stop</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">button</span><span class="crayon-sy">.</span><span class="crayon-e">stopLooking</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc5fb440061676-34"><span class="crayon-st">end</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0061 seconds] -->
<p>Here are some notes about this code:</p>
<ul>
<li><strong>Multicast</strong> is a device feature which allows one device to communicate with several. iPhones and iPads have it, but I&#8217;ve been told that iPods do not. I haven&#8217;t tried it on any Android devices, so maybe somebody can test it and report their results in the comments section. As a result of this inconsistency, we also use <strong>broadcast</strong>. &#8220;Why don&#8217;t we just use broadcast?&#8221; you might ask. Well, the catch with broadcast is that the LAN has to allow broadcasts. By using both, we are maximizing the chance of finding each other.</li>
<li>The &#8220;pulse&#8221; of the timer is ten times per second. I don&#8217;t recommend setting your timer pulse faster than that unless you have a good reason &#8212; after all, your game needs time to do other things. This is a standard pulse speed for most action games including MMOs.</li>
<li>The port you choose can be anything between <code>1</code> and <code>65535</code>, however, applications almost always block the port that they use and you&#8217;ll get an error if you try to bind to a port that is currently in use. Likewise, if you bind to a port, you need to unbind/close the port when you end the game so you don&#8217;t block it indefinitely on the players device. Lower number ports are used by commonly run applications, so it&#8217;s best to use a port between <code>1024</code> and <code>65535</code>.</li>
<li>The <code>settimeout()</code> function allows you to tell the socket how long to wait for a message before moving on. Default is to wait indefinitely, meaning that your game freezes until it gets a message. Setting it to <code>0</code> tells it to just check and if there&#8217;s nothing to receive and move on to the next task.</li>
</ul>
<h3>Finding the server</h3>
<p>The client will need to know its own IP address for the next step. Fortunately, UDP in LuaSocket can help with that:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df512cc604788702544" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
local getIP = function()
    local s = socket.udp()  --creates a UDP object
    s:setpeername( "74.125.115.104", 80 )  --Google website
    local ip, sock = s:getsockname()
    print( "myIP:", ip, sock )
    return ip
end</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df512cc604788702544-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc604788702544-2">2</div><div class="crayon-num" data-line="crayon-5f8df512cc604788702544-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc604788702544-4">4</div><div class="crayon-num" data-line="crayon-5f8df512cc604788702544-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc604788702544-6">6</div><div class="crayon-num" data-line="crayon-5f8df512cc604788702544-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df512cc604788702544-1"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">getIP</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc604788702544-2">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">socket</span><span class="crayon-sy">.</span><span class="crayon-e">udp</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--creates a UDP object</span></div><div class="crayon-line" id="crayon-5f8df512cc604788702544-3">  <span class="crayon-h"> </span> <span class="crayon-v">s</span><span class="crayon-o">:</span><span class="crayon-e">setpeername</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"74.125.115.104"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--Google website</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc604788702544-4">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">ip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sock</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-o">:</span><span class="crayon-e">getsockname</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc604788702544-5">  <span class="crayon-h"> </span> <span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"myIP:"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">sock</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc604788702544-6">  <span class="crayon-h"> </span> <span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">ip</span></div><div class="crayon-line" id="crayon-5f8df512cc604788702544-7"><span class="crayon-st">end</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0017 seconds] -->
<p>The IP address in the above function is arbitrary &#8212; I used the Google address because I know it. You don&#8217;t even need to be connected to the internet for this function to return your IP address, but you must at least be on a local network.</p>
<h3>Listening for the server</h3>
<p>Now we are prepared to listen for the server. We will recognize the server because of the message <code>AwesomeGameServer</code>. Obviously, this could be any string; we are just going to match strings.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df512cc60c844313031" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
local function findServer( button )

    local newServers = {}
    local msg = "AwesomeGameServer"

    local listen = socket.udp()
    listen:setsockname( "226.192.1.1", 11111 )  --this only works if the device supports multicast

    local name = listen:getsockname()
    if ( name ) then  --test to see if device supports multicast
        listen:setoption( "ip-add-membership", { multiaddr="226.192.1.1", interface = getIP() } )
    else  --the device doesn't support multicast so we'll listen for broadcast
        listen:close()  --first we close the old socket; this is important
        listen = socket.udp()  --make a new socket
        listen:setsockname( getIP(), 11111 )  --set the socket name to the real IP address
    end

    listen:settimeout( 0 )  --move along if there is nothing to hear

    local stop

    local counter = 0  --pulse counter

    local function look()
        repeat
            local data, ip, port = listen:receivefrom()
            --print( "data: ", data, "IP: ", ip, "port: ", port )
            if data and data == msg then
                if not newServers[ip] then
                    print( "I hear a server:", ip, port )
                    local params = { ["ip"]=ip, ["port"]=22222 }
                    newServers[ip] = params
                end
            end
        until not data

        counter = counter + 1
        if counter == 20 then  --stop after 2 seconds
            stop()
        end
     end

     --pulse 10 times per second
     local beginLooking = timer.performWithDelay( 100, look, 0 )

     function stop()
         timer.cancel( beginLooking )
         button.stopLooking = nil
         evaluateServerList( newServers ) --do something with your found servers
         listen:close()  --never forget to close the socket!
     end
     button.stopLooking = stopLooking
end</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-2">2</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-4">4</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-6">6</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-8">8</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-10">10</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-12">12</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-14">14</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-16">16</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-18">18</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-20">20</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-22">22</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-24">24</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-26">26</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-28">28</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-30">30</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-32">32</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-34">34</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-36">36</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-38">38</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-40">40</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-42">42</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-44">44</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-46">46</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-48">48</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-50">50</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc60c844313031-52">52</div><div class="crayon-num" data-line="crayon-5f8df512cc60c844313031-53">53</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df512cc60c844313031-1"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">findServer</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">button</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-2">&nbsp;</div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-3">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">newServers</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-4">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">msg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"AwesomeGameServer"</span></div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-6">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">listen</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">socket</span><span class="crayon-sy">.</span><span class="crayon-e">udp</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-7">  <span class="crayon-h"> </span> <span class="crayon-v">listen</span><span class="crayon-o">:</span><span class="crayon-e">setsockname</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"226.192.1.1"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">11111</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--this only works if the device supports multicast</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-8">&nbsp;</div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-9">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">listen</span><span class="crayon-o">:</span><span class="crayon-e">getsockname</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-10">  <span class="crayon-h"> </span> <span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">name</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">then</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--test to see if device supports multicast</span></div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-11"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">listen</span><span class="crayon-o">:</span><span class="crayon-e">setoption</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"ip-add-membership"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-v">multiaddr</span><span class="crayon-o">=</span><span class="crayon-s">"226.192.1.1"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interface</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">getIP</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-12">  <span class="crayon-h"> </span> <span class="crayon-st">else</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--the device doesn't support multicast so we'll listen for broadcast</span></div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-13"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">listen</span><span class="crayon-o">:</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--first we close the old socket; this is important</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-14"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">listen</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">socket</span><span class="crayon-sy">.</span><span class="crayon-e">udp</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--make a new socket</span></div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-15"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">listen</span><span class="crayon-o">:</span><span class="crayon-e">setsockname</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-e">getIP</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">11111</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--set the socket name to the real IP address</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-16">  <span class="crayon-h"> </span> <span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-18">  <span class="crayon-h"> </span> <span class="crayon-v">listen</span><span class="crayon-o">:</span><span class="crayon-e">settimeout</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--move along if there is nothing to hear</span></div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-20">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-i">stop</span></div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-22">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">counter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--pulse counter</span></div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-24">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">look</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-25"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">repeat</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-26">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">port</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">listen</span><span class="crayon-o">:</span><span class="crayon-e">receivefrom</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-27">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-c">--print( "data: ", data, "IP: ", ip, "port: ", port )</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-28">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">data </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-e">msg </span><span class="crayon-st">then</span></div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-29"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">newServers</span><span class="crayon-sy">[</span><span class="crayon-v">ip</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-30">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"I hear a server:"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">port</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-31">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"ip"</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-v">ip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"port"</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-cn">22222</span><span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-32">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-v">newServers</span><span class="crayon-sy">[</span><span class="crayon-v">ip</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">params</span></div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-33"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-34">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-35"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">until</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-i">data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-36">&nbsp;</div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-37"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">counter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">counter</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-38"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">counter</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-st">then</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--stop after 2 seconds</span></div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-39">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">stop</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-40"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-41">  <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-42">&nbsp;</div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">--pulse 10 times per second</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-44">  <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">beginLooking</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">timer</span><span class="crayon-sy">.</span><span class="crayon-e">performWithDelay</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-45">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-46">  <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">stop</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-47"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-v">timer</span><span class="crayon-sy">.</span><span class="crayon-e">cancel</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">beginLooking</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-48"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-v">button</span><span class="crayon-sy">.</span><span class="crayon-v">stopLooking</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">nil</span></div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-49"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-e">evaluateServerList</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">newServers</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c">--do something with your found servers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-50"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-v">listen</span><span class="crayon-o">:</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span> <span class="crayon-h"> </span><span class="crayon-c">--never forget to close the socket!</span></div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-51">  <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc60c844313031-52">  <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">button</span><span class="crayon-sy">.</span><span class="crayon-v">stopLooking</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">stopLooking</span></div><div class="crayon-line" id="crayon-5f8df512cc60c844313031-53"><span class="crayon-st">end</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0110 seconds] -->
<p>I put a lot of inline comments above, but I&#8217;ll elaborate on a few things:</p>
<ul>
<li>Notice that we account for the fact that not all devices have Multicast.</li>
<li>The <code>receivefrom()</code> function is going to just pull in anything that&#8217;s at that address, so we need to filter it. This is why we have the string message to compare with.</li>
<li>When two devices find each other, it can get painful if they both have a short duration. I like to make the server wait much longer than the clients. If the server is advertising, the client finds them pretty quick. Basically, I just want to avoid &#8220;Can you try that again? I missed it.&#8221;</li>
<li>In this example, I&#8217;m passing in a reference to the button that the player pressed to activate the function. I do this because so the player can push it again and stop broadcasting. If you don&#8217;t want to do that, you don&#8217;t need the button reference.</li>
</ul>
<p>So, at this point, we know how to let the game master be discovered by the players. The essential IP address required to use TCP is attached to the UDP message. Now that we have the game master&#8217;s IP address, we can connect to their device using TCP.</p>
<h3>Swapping strings</h3>
<p>Now we&#8217;ll discuss how to create a TCP server, connect to it, and send messages back and forth.</p>
<p>First, let&#8217;s discuss what TCP will provide and what it won&#8217;t. Like I said above, once we have a connection between devices, they&#8217;ll be able to send messages back and forth. These messages will just be strings. Imagine it like a text message app &#8212; in this case, the app on one device sends texts to the app on another device. These messages are then interpreted by the apps on each device and some action occurs.</p>
<h3>Security</h3>
<p>This tutorial will not go in depth about security, but a couple points should be covered:</p>
<ul>
<li>The server and client can only control each other as far as you allow it. As I&#8217;ve iterated several times now, TCP just sends and receives text strings. For a Pac-Man clone that could be controlled by a second device, about the only information the server would need is &#8220;BEGIN&#8221;, &#8220;UP&#8221;, &#8220;DOWN&#8221;, &#8220;LEFT&#8221;, and &#8220;RIGHT&#8221; &#8212; all else could simply be ignored.</li>
<li>You should <strong>never</strong> try to make your app accept functions that have been turned into a string. Let the client and the server have their own functions and just use the transmitted text to call the functions. If your app accepts functions, you open up a very serious security vulnerability, so don&#8217;t do it! Instead, just pass commands with parameters.</li>
</ul>
<p>In any case, don&#8217;t lie awake at night worrying about this. Neither iOS nor Android will let you damage someone&#8217;s device with such foolishness, but it may ruin the install of your game!</p>
<h3>Starting the server</h3>
<p>The server runs in a periodic loop. On each iteration of the loop, it checks to see if any clients want to join and whether connected clients sent a message. If the buffer has any messages to send out, it sends them. Here&#8217;s a basic TCP server module with further explanation following:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df512cc616370676017" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
local S = {}

local socket = require( "socket" )

local clientList = {}
local clientBuffer = {}

S.getIP = function()
    local s = socket.udp()
    s:setpeername( "74.125.115.104", 80 )
    local ip, sock = s:getsockname()
    print( "myIP:", ip, sock )
    return ip
end

S.createServer = function()

    local tcp, err = socket.bind( S.getIP(), 22222 )  --create a server object
    tcp:settimeout( 0 )

    local function sPulse()
        repeat
            local client = tcp:accept()  --allow a new client to connect
            if client then
                print( "found client" )
                client:settimeout( 0 )  --just check the socket and keep going
                --TO DO: implement a way to check to see if the client has connected previously
                --consider assigning the client a session ID and use it on reconnect.
                clientList[#clientList+1] = client
                clientBuffer[client] = { "hello_client\n" }  --just including something to send below
            end
        until not client
        
        local ready, writeReady, err = socket.select( clientList, clientList, 0 )
        if err == nil then
            for i = 1, #ready do  --list of clients who are available
                local client = ready[i]
                local allData = {}  --this holds all lines from a given client

                repeat
                    local data, err = client:receive()  --get a line of data from the client, if any
                    if data then
                        allData[#allData+1] = data
                    end
                until not data

                if ( #allData &gt; 0 ) then  --figure out what the client said to the server
                    for i, thisData in ipairs( allData ) do
                        print( "thisData: ", thisData )
                        --do stuff with data
                    end
                end
            end

            for sock, buffer in pairs( clientBuffer ) do
                for _, msg in pairs( buffer ) do  --might be empty
                    local data, err = sock:send( msg )  --send the message to the client
                end
            end
        end
    end

    --pulse 10 times per second
    local serverPulse = timer.performWithDelay( 100, sPulse, 0 )

    local function stopServer()
        timer.cancel( serverPulse )  --cancel timer
        tcp:close()
        for i, v in pairs( clientList ) do
            v:close()
        end
    end
    return stopServer
end

return S</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-2">2</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-4">4</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-6">6</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-8">8</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-10">10</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-12">12</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-14">14</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-16">16</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-18">18</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-20">20</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-22">22</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-24">24</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-26">26</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-28">28</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-30">30</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-32">32</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-34">34</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-36">36</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-38">38</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-40">40</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-42">42</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-44">44</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-46">46</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-48">48</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-50">50</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-52">52</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-54">54</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-56">56</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-58">58</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-60">60</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-62">62</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-64">64</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-66">66</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-68">68</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-70">70</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-72">72</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-74">74</div><div class="crayon-num" data-line="crayon-5f8df512cc616370676017-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc616370676017-76">76</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df512cc616370676017-1"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">S</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-2">&nbsp;</div><div class="crayon-line" id="crayon-5f8df512cc616370676017-3"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">socket</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">require</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"socket"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-4">&nbsp;</div><div class="crayon-line" id="crayon-5f8df512cc616370676017-5"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">clientList</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-6"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">clientBuffer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-8"><span class="crayon-v">S</span><span class="crayon-sy">.</span><span class="crayon-v">getIP</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-9">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">socket</span><span class="crayon-sy">.</span><span class="crayon-e">udp</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-10">  <span class="crayon-h"> </span> <span class="crayon-v">s</span><span class="crayon-o">:</span><span class="crayon-e">setpeername</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"74.125.115.104"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-11">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">ip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sock</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-o">:</span><span class="crayon-e">getsockname</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-12">  <span class="crayon-h"> </span> <span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"myIP:"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">sock</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-13">  <span class="crayon-h"> </span> <span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">ip</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-14"><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-16"><span class="crayon-v">S</span><span class="crayon-sy">.</span><span class="crayon-v">createServer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-18">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">tcp</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">err</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">socket</span><span class="crayon-sy">.</span><span class="crayon-e">bind</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">S</span><span class="crayon-sy">.</span><span class="crayon-e">getIP</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">22222</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--create a server object</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-19">  <span class="crayon-h"> </span> <span class="crayon-v">tcp</span><span class="crayon-o">:</span><span class="crayon-e">settimeout</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-20">&nbsp;</div><div class="crayon-line" id="crayon-5f8df512cc616370676017-21">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">sPulse</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-22"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">repeat</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-23">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tcp</span><span class="crayon-o">:</span><span class="crayon-e">accept</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--allow a new client to connect</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-24">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">client </span><span class="crayon-st">then</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-25"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"found client"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-26"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-o">:</span><span class="crayon-e">settimeout</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--just check the socket and keep going</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-27"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-c">--TO DO: implement a way to check to see if the client has connected previously</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">--consider assigning the client a session ID and use it on reconnect.</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-29"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">clientList</span><span class="crayon-sy">[</span><span class="crayon-o">#</span><span class="crayon-v">clientList</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">client</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-30"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">clientBuffer</span><span class="crayon-sy">[</span><span class="crayon-v">client</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-s">"hello_client\n"</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--just including something to send below</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-31">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-32"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">until</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-i">client</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-33"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">ready</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">writeReady</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">err</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">socket</span><span class="crayon-sy">.</span><span class="crayon-e">select</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">clientList</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">clientList</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-35"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">err</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-r">nil</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-36">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">#</span><span class="crayon-e">ready </span><span class="crayon-st">do</span> <span class="crayon-h"> </span><span class="crayon-c">--list of clients who are available</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-37"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ready</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-38"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">allData</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--this holds all lines from a given client</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-39">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-40"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">repeat</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-41">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">err</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">client</span><span class="crayon-o">:</span><span class="crayon-e">receive</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--get a line of data from the client, if any</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-42">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">data </span><span class="crayon-st">then</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-43"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">allData</span><span class="crayon-sy">[</span><span class="crayon-o">#</span><span class="crayon-v">allData</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-44">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-45"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">until</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-i">data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-46">&nbsp;</div><div class="crayon-line" id="crayon-5f8df512cc616370676017-47"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-o">#</span><span class="crayon-v">allData</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">then</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--figure out what the client said to the server</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-48">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">thisData </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">ipairs</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">allData</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">do</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-49"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"thisData: "</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">thisData</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-50"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-c">--do stuff with data</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-51">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-52"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-53">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-54">&nbsp;</div><div class="crayon-line" id="crayon-5f8df512cc616370676017-55">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">sock</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">buffer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">pairs</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">clientBuffer</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">do</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-56"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">msg </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">pairs</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">buffer</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">do</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--might be empty</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-57">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">err</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sock</span><span class="crayon-o">:</span><span class="crayon-e">send</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">msg</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--send the message to the client</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-58"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-59">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-60"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-61">  <span class="crayon-h"> </span> <span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-62">&nbsp;</div><div class="crayon-line" id="crayon-5f8df512cc616370676017-63"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">--pulse 10 times per second</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-64">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">serverPulse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">timer</span><span class="crayon-sy">.</span><span class="crayon-e">performWithDelay</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sPulse</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-65">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-66">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">stopServer</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-67"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">timer</span><span class="crayon-sy">.</span><span class="crayon-e">cancel</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">serverPulse</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--cancel timer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-68"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">tcp</span><span class="crayon-o">:</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-69"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">pairs</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">clientList</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">do</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-70">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">v</span><span class="crayon-o">:</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-71"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-72">  <span class="crayon-h"> </span> <span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-73">  <span class="crayon-h"> </span> <span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">stopServer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-74"><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df512cc616370676017-75">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc616370676017-76"><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">S</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0174 seconds] -->
<p>And that is a basic server. Let&#8217;s start at the top with some explanation:</p>
<ul>
<li><code>socket.bind()</code> creates a server object which you bind to the port of your choice. I used <code>11111</code>, but you can use any that we listed in the earlier section. Remember to close the TCP object when you shut down the server via the <code>stopServer()</code> function!</li>
<li><code>settimeout( 0 )</code> tells LuaSocket to move on if there&#8217;s no information waiting at the socket.</li>
<li><code>accept()</code> returns a client object which represents the connection to the other device. Each client will get their own object and each one will need to be closed when the game is done. We do this in the function at the bottom called <code>stopServer()</code>.</li>
<li><code>socket.select()</code> goes through our list of client connections to see which are available. Any that are not available are ignored but not closed.</li>
<li><code>receive()</code> receives one line of data. You can designate a line of data in a string by putting <code>\n</code> at the end. It&#8217;s simple and you&#8217;ll be able to create bite-sized pieces of data. This function is structured so that you end up with a numbered table of string lines. They are numbered in the order that they were received, but you can&#8217;t rely on the lines you send being received in the order you sent them. If this is important, and it often is, you&#8217;ll need to create a way for the server to know if a line is in the right order.</li>
<li>Next we go through the list of lines and interpret them. This is usually just a series of <code>if</code>&#8211;<code>then</code> statements with a liberal use of the <a href=http://docs.coronalabs.com/api/library/string/index.html target="_blank">string</a> library.</li>
<li>Finally, we send whatever is in the buffer. The buffer is another list of strings. Again, you can&#8217;t absolutely control the order in which they are received. You don&#8217;t have to use a buffer, but when you are using a multi-use device like a phone as a server, it&#8217;s a good idea. You may just <code>:send()</code> to a client socket at any time but the only way the device knows that the message didn&#8217;t go through is if the other device responds. If the other device is taking a call, it will ignore your message and the message will be lost. If you implement a buffer, it sends the message every pulse until something happens that removes the message from the buffer, however you&#8217;ll need to implement a way of knowing when to remove items from the buffer.</li>
</ul>
<h3>Connecting to the server</h3>
<p>Connecting to the server is much simpler:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df512cc629060302364" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
local function connectToServer( ip, port )
    local sock, err = socket.connect( ip, port )
    if sock == nil then
        return false
    end
    sock:settimeout( 0 )
    sock:setoption( "tcp-nodelay", true )  --disable Nagle's algorithm
    sock:send( "we are connected\n" )
    return sock
end</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df512cc629060302364-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc629060302364-2">2</div><div class="crayon-num" data-line="crayon-5f8df512cc629060302364-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc629060302364-4">4</div><div class="crayon-num" data-line="crayon-5f8df512cc629060302364-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc629060302364-6">6</div><div class="crayon-num" data-line="crayon-5f8df512cc629060302364-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc629060302364-8">8</div><div class="crayon-num" data-line="crayon-5f8df512cc629060302364-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc629060302364-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df512cc629060302364-1"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">connectToServer</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">ip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">port</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc629060302364-2">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">sock</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">err</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">socket</span><span class="crayon-sy">.</span><span class="crayon-e">connect</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">ip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">port</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc629060302364-3">  <span class="crayon-h"> </span> <span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">sock</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-r">nil</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc629060302364-4"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-r">false</span></div><div class="crayon-line" id="crayon-5f8df512cc629060302364-5">  <span class="crayon-h"> </span> <span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc629060302364-6">  <span class="crayon-h"> </span> <span class="crayon-v">sock</span><span class="crayon-o">:</span><span class="crayon-e">settimeout</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc629060302364-7">  <span class="crayon-h"> </span> <span class="crayon-v">sock</span><span class="crayon-o">:</span><span class="crayon-e">setoption</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"tcp-nodelay"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">true</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--disable Nagle's algorithm</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc629060302364-8">  <span class="crayon-h"> </span> <span class="crayon-v">sock</span><span class="crayon-o">:</span><span class="crayon-e">send</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"we are connected\n"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc629060302364-9">  <span class="crayon-h"> </span> <span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sock</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc629060302364-10"><span class="crayon-st">end</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0021 seconds] -->
<p>To elaborate on this slightly:</p>
<ul>
<li><code>socket.connect</code> is pretty self explanatory: attempt to connect to the server at that address.</li>
<li><code>settimeout( 0 )</code> again lets the socket know that you want it to just check the socket and move on if there&#8217;s no incoming message.</li>
<li>Nagle&#8217;s algorithm is a standard function that causes the socket to aggregate data until the data is of a certain size, then send it. If you are just going to send &#8220;UP&#8221; and you want it sent right away, you&#8217;ll want this off.</li>
</ul>
<p>What&#8217;s not included in this example is a method to determine if the client is connecting for the first time or reconnecting (return session). This is outside the scope of this tutorial, but one option is to use a session ID which the client gets the first time it connects to the server. In this case, both the client and the server save the ID. Then, if the client loses the connection, this ID is sent upon reconnection and the server can update the client&#8217;s data with the new client socket.</p>
<h3>Client loop</h3>
<p>The final piece of the puzzle is the client loop. This will look very much like the server loop, but it never tries to accept connections.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df512cc633961902953" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
local function createClientLoop( sock, ip, port )

    local buffer = {}
    local clientPulse

    local function cPulse()
        local allData = {}
        local data, err

        repeat
            data, err = sock:receive()
            if data then
                allData[#allData+1] = data
            end
            if ( err == "closed" and clientPulse ) then  --try again if connection closed
                connectToServer( ip, port )
                data, err = sock:receive()
                if data then
                    allData[#allData+1] = data
                end
            end
        until not data

        if ( #allData &gt; 0 ) then
            for i, thisData in ipairs( allData ) do
                print( "thisData: ", thisData )
                --react to incoming data 
            end
        end

        for i, msg in pairs( buffer ) do
            local data, err = sock:send(msg)
            if ( err == "closed" and clientPulse ) then  --try to reconnect and resend
                connectToServer( ip, port )
                data, err = sock:send( msg )
            end
        end
    end

    --pulse 10 times per second
    clientPulse = timer.performWithDelay( 100, cPulse, 0 )

    local function stopClient()
        timer.cancel( clientPulse )  --cancel timer
        clientPulse = nil
        sock:close()
    end
    return stopClient
end</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-2">2</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-4">4</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-6">6</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-8">8</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-10">10</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-12">12</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-14">14</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-16">16</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-18">18</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-20">20</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-22">22</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-24">24</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-26">26</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-28">28</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-30">30</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-32">32</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-34">34</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-36">36</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-38">38</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-40">40</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-42">42</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-44">44</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-46">46</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df512cc633961902953-48">48</div><div class="crayon-num" data-line="crayon-5f8df512cc633961902953-49">49</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df512cc633961902953-1"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">createClientLoop</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">sock</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">port</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-2">&nbsp;</div><div class="crayon-line" id="crayon-5f8df512cc633961902953-3">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">buffer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-4">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-i">clientPulse</span></div><div class="crayon-line" id="crayon-5f8df512cc633961902953-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-6">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">cPulse</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc633961902953-7"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">allData</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-8"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">err</span></div><div class="crayon-line" id="crayon-5f8df512cc633961902953-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-10"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">repeat</span></div><div class="crayon-line" id="crayon-5f8df512cc633961902953-11">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">err</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sock</span><span class="crayon-o">:</span><span class="crayon-e">receive</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-12">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">data </span><span class="crayon-st">then</span></div><div class="crayon-line" id="crayon-5f8df512cc633961902953-13"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">allData</span><span class="crayon-sy">[</span><span class="crayon-o">#</span><span class="crayon-v">allData</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-14">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df512cc633961902953-15">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">err</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"closed"</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-i">clientPulse</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">then</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--try again if connection closed</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-16"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">connectToServer</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">ip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">port</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc633961902953-17"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">err</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sock</span><span class="crayon-o">:</span><span class="crayon-e">receive</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-18"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">data </span><span class="crayon-st">then</span></div><div class="crayon-line" id="crayon-5f8df512cc633961902953-19">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">allData</span><span class="crayon-sy">[</span><span class="crayon-o">#</span><span class="crayon-v">allData</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-20"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df512cc633961902953-21">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-22"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">until</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-i">data</span></div><div class="crayon-line" id="crayon-5f8df512cc633961902953-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-24"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-o">#</span><span class="crayon-v">allData</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line" id="crayon-5f8df512cc633961902953-25">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">thisData </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">ipairs</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">allData</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">do</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-26"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"thisData: "</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">thisData</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc633961902953-27"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-c">--react to incoming data </span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-28">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df512cc633961902953-29"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-30">&nbsp;</div><div class="crayon-line" id="crayon-5f8df512cc633961902953-31"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">msg </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">pairs</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">buffer</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">do</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-32">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">err</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sock</span><span class="crayon-o">:</span><span class="crayon-e">send</span><span class="crayon-sy">(</span><span class="crayon-v">msg</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc633961902953-33">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">err</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"closed"</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-i">clientPulse</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">then</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--try to reconnect and resend</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-34"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">connectToServer</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">ip</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">port</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc633961902953-35"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">err</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sock</span><span class="crayon-o">:</span><span class="crayon-e">send</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">msg</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-36">  <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df512cc633961902953-37"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-38">  <span class="crayon-h"> </span> <span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df512cc633961902953-39">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">--pulse 10 times per second</span></div><div class="crayon-line" id="crayon-5f8df512cc633961902953-41">  <span class="crayon-h"> </span> <span class="crayon-v">clientPulse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">timer</span><span class="crayon-sy">.</span><span class="crayon-e">performWithDelay</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cPulse</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-42">&nbsp;</div><div class="crayon-line" id="crayon-5f8df512cc633961902953-43">  <span class="crayon-h"> </span> <span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">stopClient</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-44"> <span class="crayon-h"> </span> <span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">timer</span><span class="crayon-sy">.</span><span class="crayon-e">cancel</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">clientPulse</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">--cancel timer</span></div><div class="crayon-line" id="crayon-5f8df512cc633961902953-45"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">clientPulse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">nil</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-46"> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span> <span class="crayon-h"> </span><span class="crayon-v">sock</span><span class="crayon-o">:</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df512cc633961902953-47">  <span class="crayon-h"> </span> <span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df512cc633961902953-48">  <span class="crayon-h"> </span> <span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">stopClient</span></div><div class="crayon-line" id="crayon-5f8df512cc633961902953-49"><span class="crayon-st">end</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0110 seconds] -->
<p>Note that the client is always responsible for making the connection to the server. The server never tries to reach the client — it has enough to handle already. Beyond that, there isn&#8217;t anything clarify that wasn&#8217;t already covered in the server loop section.</p>
<h3>Conclusion</h3>
<p>I hope this tutorial helps you achieve your multiplayer dreams! While it&#8217;s not intended to be a comprehensive tutorial on networking, what I accomplished should help you get two devices talking with each other using TCP.</p>
<p>Thank you for reading and remember to check out <a href=http://www.legendofus.net/ target="_blank">Legend of Us Roleplaying Game</a> which inspired me to figure all of this out.</p>
<hr />
					</div>
				</div>
			</div>
		
			<div class="single_tags clearfix">
            <div class="tags_text">
				<h5>Tags:</h5>
				<a href="/blog/tags/lan/" rel="tag">LAN</a>, <a href="/blog/tags/network/" rel="tag">network</a>, <a href="/blog/tags/peer-to-peer/" rel="tag">peer-to-peer</a>, <a href="/blog/tags/tutorial/" rel="tag">tutorial</a>			</div>
		</div>
	    		<div class="author_description">
		<div class="author_description_inner">
			<div class="image">
				<img alt="" src='/wordpress/wp-content/uploads/gravatar/5fe5451355e7a006bc1dc1176ef23933-s75.jpg' class="avatar avatar-75" width="75" height="75" />			</div>
			<div class="author_text_holder">
				<h5 class="author_name vcard author">
				<span class="fu">
				Rob Miracle			    </span>
				</h5>
				<span class="author_email">rob@coronalabs.com</span>
									<div class="author_text">
						<p>Rob is the Developer Relations Manager for Corona Labs. Besides being passionate about helping other developers make great games using Corona, he is also enjoys making games in his spare time.

Rob has been coding games since 1979 from personal computers to mainframes. He has over 16 years professional experience in the gaming industry.</p>
					</div>
							</div>
		</div>
	</div>
</article>										</div>
										
										<div class="comment_holder clearfix" id="comments">
<div class="comment_number"><div class="comment_number_inner"><h5>25 Comments</h5></div></div>
<div class="comments">

	<ul class="comment-list">
		
<li id="comment-3725">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/575132740fc8fb33379843767d523521-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name"><a href='http://spiralcodestudio/' rel='external nofollow' class='url'>Lerg</a></h5>
			<span class="comment_date">Posted at 16:41h, 23 September</span>
						<div class="text_holder" id="comment-3725">
				<p>Wow. Great topic!</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->

<li id="comment-3726">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/00f78870628f52fd561f0e073fd7a9fb-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name">egruttner</h5>
			<span class="comment_date">Posted at 19:01h, 23 September</span>
						<div class="text_holder" id="comment-3726">
				<p>A-M-A-Z-I-N-G !!!<br />
Thank you Rob!</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->

<li id="comment-3727">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/bba05958690b6a9c7ce4822b1a043f9e-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name"><a href='http://17studio.tumblr.com/' rel='external nofollow' class='url'>Anton</a></h5>
			<span class="comment_date">Posted at 05:05h, 24 September</span>
						<div class="text_holder" id="comment-3727">
				<p>It would be great to see working example</p>
			</div>
		</div>
	</div>                          
                
<ul class="children">

<li id="comment-3731">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/d71a181063923534a03c4d091130c82e-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name"><a href='http://itsnot.in/' rel='external nofollow' class='url'>simpleex</a></h5>
			<span class="comment_date">Posted at 01:01h, 26 September</span>
						<div class="text_holder" id="comment-3731">
				<p>+1</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

<li id="comment-3728">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/c91f4d3c1fd1e8fd626cae1aed93ebf5-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name">Bob</h5>
			<span class="comment_date">Posted at 05:39h, 25 September</span>
						<div class="text_holder" id="comment-3728">
				<p>Mark,</p>
<p>Thanks for sharing your knowledge and experience. This should be helpful to many developers.</p>
<p>Bob</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->

<li id="comment-3729">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/28fc11db70615236bf4afcd20430e121-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name"><a href='http://google.com/' rel='external nofollow' class='url'>CK</a></h5>
			<span class="comment_date">Posted at 09:14h, 25 September</span>
						<div class="text_holder" id="comment-3729">
				<p>Thank you for the tutorial.<br />
Does this also work with 2 devices connected via bluetooth?</p>
			</div>
		</div>
	</div>                          
                
<ul class="children">

<li id="comment-3732">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/99bdcbaff7ff2719a219538dcd70bc5b-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name"><a href='http://www.legendofus.net/' rel='external nofollow' class='url'>Mark Steelman</a></h5>
			<span class="comment_date">Posted at 18:21h, 26 September</span>
						<div class="text_holder" id="comment-3732">
				<p>Bluetooth is a different protocol, it&#8217;s like TCP or UDP except it doesn&#8217;t need a LAN.  As of right now, I don&#8217;t know how to get that to work with Corona but I&#8217;ll let you know if I figure it out.</p>
<p>As for demonstrating this code, just take all the code above and put it in a &#8220;main.lua&#8221; file.  Then make two buttons, one to call the function to advertise the server and one to call the function to look for the server.  Set up the server loop to kick off when you start the app.  Now load the app on a device and run it.  Also run it in the emulator.  Push the server button in the emulator and the client button on the device (or vis versa) and you will see print messages in the console of each that will confirm it is working.  This is assuming that both the emulator and the device are on the same network.</p>
<p>I didn&#8217;t explain that in detail in the tutorial because there are other tutorials on how to make a button and this tutorial is long enough as it is.  You don&#8217;t have to use buttons of course, that is just an easy way to demonstrate the code.</p>
			</div>
		</div>
	</div>                          
                
<ul class="children">

<li id="comment-3733">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/bba05958690b6a9c7ce4822b1a043f9e-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name"><a href='http://17studio.tumblr.com/' rel='external nofollow' class='url'>Anton</a></h5>
			<span class="comment_date">Posted at 03:00h, 29 September</span>
						<div class="text_holder" id="comment-3733">
				<p>This does not work please make an example</p>
			</div>
		</div>
	</div>                          
                
<ul class="children">

<li id="comment-3734">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/99bdcbaff7ff2719a219538dcd70bc5b-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name"><a href='http://www.legendofus.net/' rel='external nofollow' class='url'>Mark Steelman</a></h5>
			<span class="comment_date">Posted at 07:30h, 29 September</span>
						<div class="text_holder" id="comment-3734">
				<p>Post what you did and I or someone else in the community will see if we can help you figure out why your code isn&#8217;t working.</p>
			</div>
		</div>
	</div>                          
                
<ul class="children">

<li id="comment-3735">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/bba05958690b6a9c7ce4822b1a043f9e-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name"><a href='http://17studio.tumblr.com/' rel='external nofollow' class='url'>Anton</a></h5>
			<span class="comment_date">Posted at 01:53h, 01 October</span>
						<div class="text_holder" id="comment-3735">
				<p><a href="http://forums.coronalabs.com/topic/51548-local-multiplayer-with-udptcp/" rel="nofollow">http://forums.coronalabs.com/topic/51548-local-multiplayer-with-udptcp/</a></p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

<li id="comment-3730">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/5fe5451355e7a006bc1dc1176ef23933-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name"><a href='/' rel='external nofollow' class='url'>Rob Miracle</a></h5>
			<span class="comment_date">Posted at 17:00h, 25 September</span>
						<div class="text_holder" id="comment-3730">
				<p>All thanks go to Mark for this!</p>
<p>CK: I doubt this will work over bluetooth unless you&#8217;re doing TCP/IP networking over Bluetooth.</p>
<p>Rob</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->

<li id="comment-3736">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/99bdcbaff7ff2719a219538dcd70bc5b-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name"><a href='http://www.legendofus.net/' rel='external nofollow' class='url'>Mark Steelman</a></h5>
			<span class="comment_date">Posted at 06:36h, 08 October</span>
						<div class="text_holder" id="comment-3736">
				<p>I looked at Anton&#8217;s example linked above and I need to make a couple of corrections to my tutorial. Rob is going to fix them inline but I will point them out here because it might help you not make the same mistake.</p>
<p>First, you need to use a different port for your server and for finding other devices. The server will block the port it is using. We are changing the port that the server uses in the tutorial to 22222 but any legal port is fine. Be sure in your code that you don&#8217;t try to start the server more than once or you are going to get a port blocked error.</p>
<p>Second, when you send a string over TCP you need to put &#8220;n&#8221; after it. The receive function in its default state reads a line. You need to tell it when the line has ended or it will keep waiting for the rest of the line before it prints.</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->

<li id="comment-3737">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/f8ce9bf7ca80e5a3f2664c1b293d510c-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name">Jv</h5>
			<span class="comment_date">Posted at 13:20h, 13 May</span>
						<div class="text_holder" id="comment-3737">
				<p>Does this work for people connecting to your server outside your LAN?</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->

<li id="comment-3738">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/e72c760538446a5c2b111480c9638fc0-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name">Anish Krishna</h5>
			<span class="comment_date">Posted at 06:17h, 22 July</span>
						<div class="text_holder" id="comment-3738">
				<p>i was making an app needing to send and receive  just data bytes instead of string&#8230;<br />
how can i do it<br />
strings are going ok on UDP in my program&#8230;</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->

<li id="comment-3739">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/e72c760538446a5c2b111480c9638fc0-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name">AK</h5>
			<span class="comment_date">Posted at 07:07h, 22 July</span>
						<div class="text_holder" id="comment-3739">
				<p>how can i send a byte value (specifically from 0-255) in UDP and decode the same<br />
I  am able to send strings successfully in UDP</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->

<li id="comment-3740">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/01cb4beda69e97def91a119b2d96be01-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name">stevon8ter</h5>
			<span class="comment_date">Posted at 12:34h, 06 August</span>
						<div class="text_holder" id="comment-3740">
				<p>I looked over this tutorial, and it turned out to be really useful.</p>
<p>I&#8217;m coding in CODEA, but this also has LuaSocket and thus most part could be reused, thanks for the great tutorial 🙂</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->

<li id="comment-3741">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/01cb4beda69e97def91a119b2d96be01-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name">stevon8ter</h5>
			<span class="comment_date">Posted at 10:19h, 10 August</span>
						<div class="text_holder" id="comment-3741">
				<p>One small thing tho, in &#8220;advertising the server&#8221;, there&#8217;s this:</p>
<p>send:sendto( msg, &#8220;228.192.1.1&#8221;, 11111 )</p>
<p>but the IP should be 226. &#8230;</p>
<p>since the client is listening to the 226. &#8230; as well 🙂</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->

<li id="comment-3742">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/a215ddaff6d6cf94a1b86061f89b7b3f-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name"><a href='http://www.tiltangames.com/' rel='external nofollow' class='url'>Adi</a></h5>
			<span class="comment_date">Posted at 00:17h, 19 September</span>
						<div class="text_holder" id="comment-3742">
				<p>Very useful. Thanks for sharing.</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->

<li id="comment-3743">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/4d93d69c619c9bbd6cf0308c3c04e5ff-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name"><a href='http://4kdevelopment.com/' rel='external nofollow' class='url'>Wesley</a></h5>
			<span class="comment_date">Posted at 14:14h, 03 November</span>
						<div class="text_holder" id="comment-3743">
				<p>I had to use the following code to get the local broadcast working.  It basically replaces the last octet of your IP address with 255.  A more correct solution would probably be to use the correct broadcast address based on the subnet mask but I was unsure of how to do this in CoronaSDK and I believe that this will work on most home networks (hopefully other networks support multicast or 255.255.255.255 broadcast).</p>
<p><code>--http://stackoverflow.com/questions/20459943/find-the-last-index-of-a-character-in-a-string<br />
function findLast(haystack, needle)<br />
    local i=haystack:match(&quot;.*&quot;..needle..&quot;()&quot;)<br />
    if i==nil then return nil else return i-1 end<br />
end</p>
<p>-- replace last octet of our ip address with '255'<br />
function get_local_broadcast_address()<br />
    local ip = getIP()<br />
    local index = findLast(ip, &quot;%.&quot;)<br />
    local substr = string.sub(ip,1,index) .. &quot;255&quot;<br />
    return substr<br />
end</code></p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->

<li id="comment-3744">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/a215ddaff6d6cf94a1b86061f89b7b3f-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name"><a href='http://www.tiltangames.com/' rel='external nofollow' class='url'>Adi</a></h5>
			<span class="comment_date">Posted at 23:31h, 05 November</span>
						<div class="text_holder" id="comment-3744">
				<p>Great tutorial. Its been very helpful in our current game.</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->

<li id="comment-3745">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/9531b6d37b0b35917da00d6db431f11f-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name">awais</h5>
			<span class="comment_date">Posted at 21:32h, 16 November</span>
						<div class="text_holder" id="comment-3745">
				<p>when i run on device Runtime error occurs ( attempt to index local &#8220;UDPBroadcast&#8221;(a nil value).)</p>
			</div>
		</div>
	</div>                          
                
<ul class="children">

<li id="comment-3747">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/53a282add093785f9a078e60c37f6e5d-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name">Mohammad Fakhreddin</h5>
			<span class="comment_date">Posted at 14:07h, 21 January</span>
						<div class="text_holder" id="comment-3747">
				<p>I checked your code change this part of your code to work correctly:<br />
Your Main.lua<br />
&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;<br />
sendbF = function(event)<br />
  &#8212; Get a session ID (&#8220;sock&#8221;) from server<br />
	if(server_ip~=0) then<br />
	  local sock = connectToServer(server_ip,1235)<br />
	  createClientLoop(sock,server_ip,1235)<br />
	else<br />
		findServer(sendbF)<br />
	end<br />
end</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

<li id="comment-3746">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/53a282add093785f9a078e60c37f6e5d-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name">Mohammad Fakhreddin</h5>
			<span class="comment_date">Posted at 14:05h, 21 January</span>
						<div class="text_holder" id="comment-3746">
				<p>Thanks for your tutorial<br />
I have to say it needs a few changes for working correctly on android devices :<br />
I changed your client listener to 0.0.0.0<br />
&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;<br />
Client:<br />
&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;<br />
     listen = socket.udp()  &#8211;make a new socket<br />
      listen:setsockname( &#8220;0.0.0.0&#8221;, 1119 )  &#8211;set the socket name to the real IP address<br />
  &#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;<br />
Server<br />
&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-<br />
 print(&#8220;Advertise server&#8221;)<br />
        assert(send:setoption( &#8220;broadcast&#8221;, true )) &#8211;turn on broadcast<br />
        assert(send:sendto( msg, &#8220;255.255.255.255&#8221;, 1119 ))<br />
         assert(send:setoption( &#8220;broadcast&#8221;, false )) &#8211;turn off broadcast</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->

<li id="comment-3748">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/09ded639d8b4fb0e5f7c129af661e56d-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name">Tapas</h5>
			<span class="comment_date">Posted at 11:21h, 22 February</span>
						<div class="text_holder" id="comment-3748">
				<p>Its a great help. But in my case in the following code in createServer method<br />
local ready, writeReady, err = socket.select( clientList, clientList, 0 )<br />
Table ready is empty and writeReady contains the client data. Can you let me why is that.</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->

<li id="comment-3749">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/a215ddaff6d6cf94a1b86061f89b7b3f-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name"><a href='http://www.tiltangames.com/' rel='external nofollow' class='url'>Adi</a></h5>
			<span class="comment_date">Posted at 22:59h, 26 June</span>
						<div class="text_holder" id="comment-3749">
				<p>Seems this code is no longer working in latest build 2016.2907. Perhaps it is due to the update of LuaSocket lib in build 2016.2883. Appreciate any advise on how to fix it.</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->
	</ul>



 </div></div>
 <div class="comment_pager">
	<p></p>
 </div>
 <div class="comment_form">
	</div>
						
								
							


 
									</div>
								</div>	
								<div class="column2"> 
										<div class="column_inner">
		<aside class="sidebar">
							
			<div id="search-2" class="widget widget_search posts_holder"><h5>Search</h5><form role="search" method="get" id="searchform" action="/">
    <div><label class="screen-reader-text" for="s">Search for:</label>
        <input type="text" value="" placeholder="Search Here" name="s" id="s" />
        <input type="submit" id="searchsubmit" value="&#xf002" />
    </div>
</form></div>		<div id="recent-posts-9" class="widget widget_recent_entries posts_holder">		<h5>Recent Posts</h5>		<ul>
											<li>
					<a href="/blog/2020/04/30/future-of-corona/">Future of Corona</a>
									</li>
											<li>
					<a href="/blog/2020/04/30/the-forums-are-moving/">The Forums are moving&#8230;</a>
									</li>
											<li>
					<a href="/blog/2020/04/22/corona-labs-transition-update-22-april-2020/">Corona Labs transition update 22-April-2020</a>
									</li>
											<li>
					<a href="/blog/2020/04/16/google-64-bit-deadline-coming-august-1-2020/">Google 64-bit deadline coming August 1, 2020</a>
									</li>
											<li>
					<a href="/blog/2020/03/24/keep-calm-and-corona-the-game-engine-no-relation-on/">Keep Calm and Corona (the game engine, no relation) On!</a>
									</li>
					</ul>
		</div><div id="categories-8" class="widget widget_categories posts_holder"><h5>Categories</h5><form action="/" method="get"><label class="screen-reader-text" for="cat">Categories</label><select  name='cat' id='cat' class='postform' >
	<option value='-1'>Select Category</option>
	<option class="level-0" value="68">Amazon Kindle&nbsp;&nbsp;(3)</option>
	<option class="level-0" value="45">Android&nbsp;&nbsp;(21)</option>
	<option class="level-0" value="887">Art&nbsp;&nbsp;(5)</option>
	<option class="level-0" value="889">Business&nbsp;&nbsp;(2)</option>
	<option class="level-0" value="599">Business of Apps&nbsp;&nbsp;(10)</option>
	<option class="level-0" value="419">Case Study&nbsp;&nbsp;(12)</option>
	<option class="level-0" value="420">Case Study &#8211; Education&nbsp;&nbsp;(3)</option>
	<option class="level-0" value="435">Case Study &#8211; Game Studios&nbsp;&nbsp;(6)</option>
	<option class="level-0" value="37">Composer&nbsp;&nbsp;(3)</option>
	<option class="level-0" value="617">Corona Ads&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="266">Corona Editor&nbsp;&nbsp;(5)</option>
	<option class="level-0" value="54">Corona Geek&nbsp;&nbsp;(320)</option>
	<option class="level-0" value="858">Corona Geek Developer Interviews&nbsp;&nbsp;(2)</option>
	<option class="level-0" value="624">Corona Marketplace&nbsp;&nbsp;(5)</option>
	<option class="level-0" value="136">Corona native builds&nbsp;&nbsp;(21)</option>
	<option class="level-0" value="257">Corona Professional Services&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="13">Corona SDK&nbsp;&nbsp;(175)</option>
	<option class="level-0" value="284">CoronaCards&nbsp;&nbsp;(12)</option>
	<option class="level-0" value="39">Daily Build&nbsp;&nbsp;(38)</option>
	<option class="level-0" value="890">Design&nbsp;&nbsp;(9)</option>
	<option class="level-0" value="591">eBooks&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="421">Education&nbsp;&nbsp;(4)</option>
	<option class="level-0" value="63">FAQ&nbsp;&nbsp;(13)</option>
	<option class="level-0" value="458">Featured App&nbsp;&nbsp;(51)</option>
	<option class="level-0" value="67">Friday Night Forum&nbsp;&nbsp;(5)</option>
	<option class="level-0" value="268">From the Forum&nbsp;&nbsp;(179)</option>
	<option class="level-0" value="383">From the Store&nbsp;&nbsp;(34)</option>
	<option class="level-0" value="468">Fuse Powered&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="14">Game Development&nbsp;&nbsp;(60)</option>
	<option class="level-0" value="641">Google+ Hangouts&nbsp;&nbsp;(293)</option>
	<option class="level-0" value="15">Guest Bloggers&nbsp;&nbsp;(77)</option>
	<option class="level-0" value="316">iOS&nbsp;&nbsp;(15)</option>
	<option class="level-0" value="56">iPad&nbsp;&nbsp;(9)</option>
	<option class="level-0" value="58">iPhone&nbsp;&nbsp;(10)</option>
	<option class="level-0" value="43">Lua&nbsp;&nbsp;(5)</option>
	<option class="level-0" value="57">Mobile App of the Week&nbsp;&nbsp;(51)</option>
	<option class="level-0" value="451">Monetization&nbsp;&nbsp;(43)</option>
	<option class="level-0" value="892">Music&nbsp;&nbsp;(3)</option>
	<option class="level-0" value="17">News &amp; Announcements&nbsp;&nbsp;(248)</option>
	<option class="level-0" value="69">NOOK&nbsp;&nbsp;(2)</option>
	<option class="level-0" value="413">OS-X&nbsp;&nbsp;(5)</option>
	<option class="level-0" value="98">Partners&nbsp;&nbsp;(6)</option>
	<option class="level-0" value="895">Photography&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="50">Plugins&nbsp;&nbsp;(88)</option>
	<option class="level-0" value="897">Sport&nbsp;&nbsp;(2)</option>
	<option class="level-0" value="112">Tech&nbsp;&nbsp;(2)</option>
	<option class="level-0" value="515">Third-Party Tools&nbsp;&nbsp;(3)</option>
	<option class="level-0" value="379">Tutorial Treasury&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="7">Tutorials, Tips and Demos&nbsp;&nbsp;(42)</option>
	<option class="level-0" value="411">tvOS&nbsp;&nbsp;(5)</option>
	<option class="level-0" value="1">Uncategorized&nbsp;&nbsp;(24)</option>
	<option class="level-0" value="195">Videos&nbsp;&nbsp;(2)</option>
	<option class="level-0" value="443">Win32&nbsp;&nbsp;(3)</option>
	<option class="level-0" value="289">Windows Phone&nbsp;&nbsp;(2)</option>
</select>
</form>
<script type='text/javascript'>
/* <![CDATA[ */
(function() {
	var dropdown = document.getElementById( "cat" );
	function onCatChange() {
		if ( dropdown.options[ dropdown.selectedIndex ].value > 0 ) {
			dropdown.parentNode.submit();
		}
	}
	dropdown.onchange = onCatChange;
})();
/* ]]> */
</script>

</div><div id="custom_html-4" class="widget_text widget widget_custom_html posts_holder"><div class="textwidget custom-html-widget"><a class="sidebar_viewall" href="/blog/topics/">View all</a></div></div><div id="tag_cloud-8" class="widget widget_tag_cloud posts_holder"><h5>Tags</h5><div class="tagcloud"><a href="/blog/tags/ads/" class="tag-cloud-link tag-link-428 tag-link-position-1" aria-label="ads (9 items)">ads</a>
<a href="/blog/tags/analytics/" class="tag-cloud-link tag-link-120 tag-link-position-2" aria-label="Analytics (6 items)">Analytics</a>
<a href="/blog/tags/android-2/" class="tag-cloud-link tag-link-51 tag-link-position-3" aria-label="android (27 items)">android</a>
<a href="/blog/tags/app-development/" class="tag-cloud-link tag-link-162 tag-link-position-4" aria-label="app development (13 items)">app development</a>
<a href="/blog/tags/app-marketing/" class="tag-cloud-link tag-link-598 tag-link-position-5" aria-label="App Marketing (11 items)">App Marketing</a>
<a href="/blog/tags/app-monetization/" class="tag-cloud-link tag-link-135 tag-link-position-6" aria-label="App Monetization (11 items)">App Monetization</a>
<a href="/blog/tags/art/" class="tag-cloud-link tag-link-574 tag-link-position-7" aria-label="art (7 items)">art</a>
<a href="/blog/tags/articles/" class="tag-cloud-link tag-link-902 tag-link-position-8" aria-label="Articles (9 items)">Articles</a>
<a href="/blog/tags/business-2/" class="tag-cloud-link tag-link-74 tag-link-position-9" aria-label="business (11 items)">business</a>
<a href="/blog/tags/cloud/" class="tag-cloud-link tag-link-415 tag-link-position-10" aria-label="cloud (8 items)">cloud</a>
<a href="/blog/tags/code-samples/" class="tag-cloud-link tag-link-471 tag-link-position-11" aria-label="Code Samples (13 items)">Code Samples</a>
<a href="/blog/tags/collision-detection/" class="tag-cloud-link tag-link-178 tag-link-position-12" aria-label="collision detection (7 items)">collision detection</a>
<a href="/blog/tags/composer/" class="tag-cloud-link tag-link-36 tag-link-position-13" aria-label="composer (11 items)">composer</a>
<a href="/blog/tags/corona/" class="tag-cloud-link tag-link-75 tag-link-position-14" aria-label="corona (16 items)">corona</a>
<a href="/blog/tags/corona-plug-ins/" class="tag-cloud-link tag-link-139 tag-link-position-15" aria-label="Corona Plug-ins (7 items)">Corona Plug-ins</a>
<a href="/blog/tags/corona-sdk/" class="tag-cloud-link tag-link-80 tag-link-position-16" aria-label="Corona SDK (14 items)">Corona SDK</a>
<a href="/blog/tags/coronasdk/" class="tag-cloud-link tag-link-61 tag-link-position-17" aria-label="CoronaSDK (10 items)">CoronaSDK</a>
<a href="/blog/tags/coronium/" class="tag-cloud-link tag-link-475 tag-link-position-18" aria-label="Coronium (11 items)">Coronium</a>
<a href="/blog/tags/desktop-game-development/" class="tag-cloud-link tag-link-841 tag-link-position-19" aria-label="desktop game development (20 items)">desktop game development</a>
<a href="/blog/tags/facebook/" class="tag-cloud-link tag-link-22 tag-link-position-20" aria-label="Facebook (9 items)">Facebook</a>
<a href="/blog/tags/faq/" class="tag-cloud-link tag-link-64 tag-link-position-21" aria-label="FAQ (6 items)">FAQ</a>
<a href="/blog/tags/game/" class="tag-cloud-link tag-link-82 tag-link-position-22" aria-label="game (22 items)">game</a>
<a href="/blog/tags/game-design/" class="tag-cloud-link tag-link-473 tag-link-position-23" aria-label="Game Design (23 items)">Game Design</a>
<a href="/blog/tags/game-development-2/" class="tag-cloud-link tag-link-587 tag-link-position-24" aria-label="game development (28 items)">game development</a>
<a href="/blog/tags/game-development/" class="tag-cloud-link tag-link-211 tag-link-position-25" aria-label="Game Development (33 items)">Game Development</a>
<a href="/blog/tags/gpgs/" class="tag-cloud-link tag-link-49 tag-link-position-26" aria-label="GPGS (7 items)">GPGS</a>
<a href="/blog/tags/graphics-2/" class="tag-cloud-link tag-link-103 tag-link-position-27" aria-label="graphics (8 items)">graphics</a>
<a href="/blog/tags/graphics-2-0/" class="tag-cloud-link tag-link-31 tag-link-position-28" aria-label="Graphics 2.0 (11 items)">Graphics 2.0</a>
<a href="/blog/tags/hackathon/" class="tag-cloud-link tag-link-109 tag-link-position-29" aria-label="hackathon (6 items)">hackathon</a>
<a href="/blog/tags/indie/" class="tag-cloud-link tag-link-83 tag-link-position-30" aria-label="indie (10 items)">indie</a>
<a href="/blog/tags/ios/" class="tag-cloud-link tag-link-52 tag-link-position-31" aria-label="iOS (36 items)">iOS</a>
<a href="/blog/tags/ipad-2/" class="tag-cloud-link tag-link-76 tag-link-position-32" aria-label="ipad (11 items)">ipad</a>
<a href="/blog/tags/iphone-2/" class="tag-cloud-link tag-link-77 tag-link-position-33" aria-label="iphone (10 items)">iphone</a>
<a href="/blog/tags/level-design/" class="tag-cloud-link tag-link-822 tag-link-position-34" aria-label="level design (7 items)">level design</a>
<a href="/blog/tags/lua-2/" class="tag-cloud-link tag-link-44 tag-link-position-35" aria-label="lua (7 items)">lua</a>
<a href="/blog/tags/marketplace/" class="tag-cloud-link tag-link-596 tag-link-position-36" aria-label="marketplace (29 items)">marketplace</a>
<a href="/blog/tags/monetization-2/" class="tag-cloud-link tag-link-151 tag-link-position-37" aria-label="monetization (24 items)">monetization</a>
<a href="/blog/tags/physics/" class="tag-cloud-link tag-link-55 tag-link-position-38" aria-label="physics (14 items)">physics</a>
<a href="/blog/tags/physics-examples/" class="tag-cloud-link tag-link-809 tag-link-position-39" aria-label="Physics Examples (11 items)">Physics Examples</a>
<a href="/blog/tags/plugin/" class="tag-cloud-link tag-link-140 tag-link-position-40" aria-label="plugin (16 items)">plugin</a>
<a href="/blog/tags/plugins/" class="tag-cloud-link tag-link-104 tag-link-position-41" aria-label="plugins (26 items)">plugins</a>
<a href="/blog/tags/sample-code/" class="tag-cloud-link tag-link-363 tag-link-position-42" aria-label="Sample Code (8 items)">Sample Code</a>
<a href="/blog/tags/tutorial/" class="tag-cloud-link tag-link-6 tag-link-position-43" aria-label="tutorial (32 items)">tutorial</a>
<a href="/blog/tags/utility-2/" class="tag-cloud-link tag-link-78 tag-link-position-44" aria-label="utility (6 items)">utility</a>
<a href="/blog/tags/widget-2/" class="tag-cloud-link tag-link-35 tag-link-position-45" aria-label="widget (7 items)">widget</a></div>
</div><div id="custom_html-5" class="widget_text widget widget_custom_html posts_holder"><div class="textwidget custom-html-widget"><a class="sidebar_viewall" href="/blog/tags/">View all</a></div></div>		</aside>
	</div>
								</div>
							</div>
											</div>
                                 </div>
	


		
	</div>
</div>



	<footer >
		<div class="footer_inner clearfix">
				<div class="footer_top_holder">
                            <div style="background-color: #ededed;height: 1px" class="footer_top_border"></div>
            			<div class="footer_top">
								<div class="container">
					<div class="container_inner">
																	<div class="four_columns clearfix">
								<div class="column1 footer_col1">
									<div class="column_inner">
										<div id="text_icl-3" class="widget widget_text_icl"><h5>About</h5>		<div class="textwidget"><hr class="footer_hr_list" />

<ul class="footer_nav">
<li><a title="" href="/product/">Product</a></li>
<li><a title="FAQ" href="/faq/">FAQ</a></li>
<li><a href="/roadmap/">Roadmap</a></li>
<li><a href="/contact/">Contact</a></li>
<li><a href="/presskit.pdf" target="_blank" rel="noopener">Press Kit</a></li>
</ul></div>
		</div>									</div>
								</div>
								<div class="column2 footer_col2">
									<div class="column_inner">
										<div id="text-15" class="widget widget_text"><h5>Learn</h5>			<div class="textwidget"><hr class="footer_hr_list" />
<ul class="footer_nav">
<li>
    <a href="https://docs.coronalabs.com/guide/programming/index.html" target="_blank" rel="noopener">Getting started</a>
  </li>
<li>
    <a href="https://docs.coronalabs.com/guide/index.html" target="_blank" rel="noopener">Developer guides</a>
  </li>
<li>
    <a href="https://docs.coronalabs.com/" target="_blank" rel="noopener">Documentation</a>
  </li>
<li>
    <a href="https://docs.coronalabs.com/tutorial/" target="_blank" rel="noopener">Tutorials</a>
  </li>
<li>
    <a href="https://docs.coronalabs.com/guide/start/introLua/index.html" target="_blank" rel="noopener">Learn Lua</a>
  </li>
</ul>
</div>
		</div>									</div>
								</div>
								<div class="column3 footer_col3">
									<div class="column_inner">
										<div id="text-6" class="widget widget_text"><h5>Community</h5>			<div class="textwidget"><hr class="footer_hr_list" />

<ul class="footer_nav">
 	<li><a href="https://forums.solar2d.com/" target="_blank" rel="noopener">Forum</a></li>
 	<li><a href="https://marketplace.coronalabs.com/" target="_blank" rel="noopener">Marketplace</a></li>
 	<li><a href="/blog/">Blog</a></li>
 	<li><a href="/support/">Support</a></li>
</ul></div>
		</div>									</div>
								</div>
								<div class="column4 footer_col4">
									<div class="column_inner">
										<div id="text-2" class="widget widget_text">			<div class="textwidget"><p><span class='q_social_icon_holder normal_social' ><a itemprop='url' href='https://www.facebook.com/CoronaLabs' target='_blank'><i class="qode_icon_font_awesome fa fa-facebook fa-lg simple_social" style="font-size: 15px;" ></i></a></span> <span class='q_social_icon_holder normal_social' ><a itemprop='url' href='https://twitter.com/coronalabs' target='_blank'><i class="qode_icon_font_awesome fa fa-twitter fa-lg simple_social" style="font-size: 15px;" ></i></a></span> <span class='q_social_icon_holder normal_social' ><a itemprop='url' href='https://vk.com/corona_pub' target='_blank'><i class="qode_icon_font_awesome fa fa-vk fa-lg simple_social" style="font-size: 15px;" ></i></a></span> <span class='q_social_icon_holder normal_social' ><a itemprop='url' href='https://t.me/CoronaRu' target='_blank'><i class="qode_icon_font_awesome fa fa-telegram fa-lg simple_social" style="font-size: 15px;" ></i></a></span> <span class='q_social_icon_holder normal_social' ><a itemprop='url' href='https://www.linkedin.com/company/corona-labs' target='_blank'><i class="qode_icon_font_awesome fa fa-linkedin fa-lg simple_social" style="font-size: 15px;" ></i></a></span> <span class='q_social_icon_holder normal_social' ><a itemprop='url' href='https://www.youtube.com/user/CoronaLabs' target='_blank'><i class="qode_icon_font_awesome fa fa-youtube fa-lg simple_social" style="font-size: 15px;" ></i></a></span> <span class='q_social_icon_holder normal_social' ><a itemprop='url' href='https://github.com/coronalabs' target='_blank'><i class="qode_icon_font_awesome fa fa-github fa-lg simple_social" style="font-size: 15px;" ></i></a></span> <span class='q_social_icon_holder normal_social' ><a itemprop='url' href='/slack/' target='_self'><i class="qode_icon_font_awesome fa fa-slack fa-lg simple_social" style="font-size: 15px;" ></i></a></span></p>
<hr class="footer_hr_list" />
<div class="separator  transparent center" style="margin-top: 1px;margin-bottom: 1px;"></div>

<p><img class="footer_logo" style="width: 50%;" src="/wordpress/wp-content/uploads/2017/06/corona_logo_footer2906.png" alt="logo" /></p>
<div class="separator  transparent center" style="margin-top: 1px;margin-bottom: 1px;"></div>

<p style="font-size: 15px; line-height: 22px;">Our mission is to enable anyone to create great mobile apps. Our flagship product, Corona, is the world’s most advanced 2D mobile development platform.</p>
</div>
		</div>									</div>
								</div>
							</div>
															</div>
				</div>
							</div>
					</div>
							<div class="footer_bottom_holder">
                									<div class="footer_bottom">
						<div class="textwidget">© 2018 Corona Labs Inc. <a style="text-decoration: underline; color: #707a89;" href="/terms-and-conditions/"> Terms of service</a> &amp; <a style="text-decoration: underline; color: #707a89;" href="/privacy-policy/">Privacy policy</a></div>
					</div>
								</div>
				</div>
	</footer>
		
</div>
</div>
<div class="wppopups-whole" style="display: none"><div class="spu-bg" id="spu-bg-76435"></div><div class="spu-box spu-animation-fade spu-theme-elegant spu-position-centered" id="spu-76435" data-id="76435" data-parent="0" data-settings="{&quot;position&quot;:{&quot;position&quot;:&quot;centered&quot;},&quot;animation&quot;:{&quot;animation&quot;:&quot;fade&quot;},&quot;colors&quot;:{&quot;show_overlay&quot;:&quot;yes-color&quot;,&quot;overlay_color&quot;:&quot;rgba(117, 169, 177, 0.33)&quot;,&quot;overlay_blur&quot;:&quot;2&quot;,&quot;bg_color&quot;:&quot;rgb(246, 246, 240)&quot;,&quot;bg_img&quot;:&quot;&quot;,&quot;bg_img_repeat&quot;:&quot;no-repeat&quot;,&quot;bg_img_size&quot;:&quot;cover&quot;},&quot;close&quot;:{&quot;close_color&quot;:&quot;rgb(255, 255, 255)&quot;,&quot;close_hover_color&quot;:&quot;#000&quot;,&quot;close_shadow_color&quot;:&quot;#000&quot;,&quot;close_size&quot;:&quot;40&quot;,&quot;close_position&quot;:&quot;top_right&quot;},&quot;popup_box&quot;:{&quot;width&quot;:&quot;750px&quot;,&quot;padding&quot;:&quot;50&quot;,&quot;auto_height&quot;:&quot;yes&quot;,&quot;height&quot;:&quot;430px&quot;},&quot;border&quot;:{&quot;border_type&quot;:&quot;solid&quot;,&quot;border_color&quot;:&quot;rgb(6, 94, 79)&quot;,&quot;border_width&quot;:&quot;5&quot;,&quot;border_radius&quot;:&quot;0&quot;,&quot;border_margin&quot;:&quot;14&quot;},&quot;shadow&quot;:{&quot;shadow_color&quot;:&quot;#ccc&quot;,&quot;shadow_type&quot;:&quot;outset&quot;,&quot;shadow_x_offset&quot;:&quot;5&quot;,&quot;shadow_y_offset&quot;:&quot;5&quot;,&quot;shadow_blur&quot;:&quot;5&quot;,&quot;shadow_spread&quot;:&quot;0&quot;},&quot;css&quot;:{&quot;custom_css&quot;:&quot;&quot;},&quot;id&quot;:&quot;76435&quot;,&quot;rules&quot;:{&quot;group_0&quot;:{&quot;rule_0&quot;:{&quot;rule&quot;:&quot;page_type&quot;,&quot;operator&quot;:&quot;==&quot;,&quot;value&quot;:&quot;all_pages&quot;}}},&quot;settings&quot;:{&quot;popup_title&quot;:&quot;Corona SDK is now Solar2D&quot;,&quot;popup_desc&quot;:&quot;&quot;,&quot;test_mode&quot;:&quot;0&quot;,&quot;powered_link&quot;:&quot;0&quot;,&quot;popup_class&quot;:&quot;&quot;,&quot;popup_hidden_class&quot;:&quot;spu-theme-elegant&quot;,&quot;close_on_conversion&quot;:&quot;0&quot;,&quot;conversion_cookie_name&quot;:&quot;now_solar2d&quot;,&quot;conversion_cookie_duration&quot;:&quot;1&quot;,&quot;conversion_cookie_type&quot;:&quot;h&quot;,&quot;closing_cookie_name&quot;:&quot;now_solar2d_close&quot;,&quot;closing_cookie_duration&quot;:&quot;1&quot;,&quot;closing_cookie_type&quot;:&quot;h&quot;},&quot;triggers&quot;:{&quot;trigger_0&quot;:{&quot;trigger&quot;:&quot;seconds&quot;,&quot;value&quot;:&quot;1&quot;}}}"><div class="spu-container"><div class="spu-content"><div style="text-align: center; font-family: 'Lato',Open Sans;">
<h5 style="text-align: center; color: #646464;">The website is no longer being updated, and is for archival purposes only.</h5>
<p>&nbsp;</p>
<h3>Corona SDK is now Solar2D</h3>
<p><a href="https://Solar2D.com/"><img class="alignnone size-medium wp-image-76413" style="font-size: 16px;" src="/wordpress/wp-content/uploads/2020/04/finalpost-art-300x124.png" alt="" width="300" height="124" srcset="/wordpress/wp-content/uploads/2020/04/finalpost-art-300x124.png 300w, /wordpress/wp-content/uploads/2020/04/finalpost-art-768x317.png 768w, /wordpress/wp-content/uploads/2020/04/finalpost-art-1024x423.png 1024w, /wordpress/wp-content/uploads/2020/04/finalpost-art-700x289.png 700w, /wordpress/wp-content/uploads/2020/04/finalpost-art-125x52.png 125w, /wordpress/wp-content/uploads/2020/04/finalpost-art.png 1240w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3><a href="https://Solar2D.com/">https://Solar2D.com/</a></h3>
</div>
</div><a href="#" class="spu-close spu-close-popup spu-close-top_right">&times;</a><span class="spu-timer"></span></div></div><!--spu-box--></div><script type='text/javascript'>
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"cached":"1"};
/* ]]> */
</script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/plugins/contact-form-7/includes/js/scripts-44ab35495eb13b448ea9307a96f479f3.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wppopups_vars = {"is_admin":"","ajax_url":"\/wordpress\/wp-admin\/admin-ajax.php?lang=en","pid":"59630","is_front_page":"","is_blog_page":"","is_category":"","site_url":"\/wordpress","is_archive":"","is_search":"","is_singular":"1","is_preview":"","facebook":"","twitter":"","nonce":"b47d1a0f1c"};
/* ]]> */
</script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/plugins/wp-popups-lite/src/assets/js/wppopups-933b528a2d57748fe8c83f115a193bac.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var qodeLike = {"ajaxurl":"\/wordpress\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='/wordpress/wp-content/themes/bridge/js/qode-like.min.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/core.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/widget.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/accordion.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/position.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/menu.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-includes/js/wp-a11y.min.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var uiAutocompleteL10n = {"noResults":"No results found.","oneResult":"1 result found. Use up and down arrow keys to navigate.","manyResults":"%d results found. Use up and down arrow keys to navigate.","itemSelected":"Item selected."};
/* ]]> */
</script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/autocomplete.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/button.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/datepicker.min-1.11.4.js'></script>
<script type='text/javascript'>
jQuery(document).ready(function(jQuery){jQuery.datepicker.setDefaults({"closeText":"Close","currentText":"Today","monthNames":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthNamesShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"nextText":"Next","prevText":"Previous","dayNames":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"dayNamesShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"dayNamesMin":["S","M","T","W","T","F","S"],"dateFormat":"MM d, yy","firstDay":1,"isRTL":false});});
</script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/mouse.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/resizable.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/draggable.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/dialog.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/droppable.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/progressbar.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/selectable.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/sortable.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/slider.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/spinner.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/tooltip.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/tabs.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-blind.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-bounce.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-clip.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-drop.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-explode.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-fade.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-fold.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-highlight.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-pulsate.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-size.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-scale.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-shake.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-slide.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-transfer.min-1.11.4.js'></script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/themes/bridge/js/plugins-301fe8920786443d62854aa56f62d416.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/themes/bridge/js/jquery.carouFredSel-6.2.1.min.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/themes/bridge/js/lemmon-slider.min.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/themes/bridge/js/jquery.fullPage.min.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/themes/bridge/js/jquery.mousewheel.min.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/themes/bridge/js/jquery.touchSwipe.min.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-content/plugins/js_composer/assets/lib/bower/isotope/dist/isotope.pkgd.min-5.5.5.js'></script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/themes/bridge/js/jquery.stretch-589214c34f008189ea441c146f569db3.js'></script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/themes/bridge/js/default_dynamic-7509df77330fcb9cc352a1e134790124.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var QodeAdminAjax = {"ajaxurl":"\/wordpress\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='/wordpress/wp-content/themes/bridge/js/default.min.js'></script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/themes/bridge/js/custom_js-46e09ba307b0b6c4b86ea442fd0f8392.js'></script>
<script type='text/javascript' src='/wordpress/wp-includes/js/comment-reply.min.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-content/plugins/js_composer/assets/js/dist/js_composer_front.min-5.5.5.js'></script>
<script type="text/javascript">
                WebFontConfig = {
                    google: { families: [ 'Lato:100,200,300,400,500,600,700,800,900,300italic,400italic:latin,latin-ext', 'Exo 2:100,200,300,400,500,600,700,800,900,300italic,400italic:latin,latin-ext', 'Exo:100,200,300,400,500,600,700,800,900,300italic,400italic:latin,latin-ext', 'Open Sans:400,300:latin' ] }
        };
        (function() {
            var wf = document.createElement('script');
            wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
                '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
            wf.type = 'text/javascript';
            wf.async = 'true';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(wf, s);
        })(); </script>
<script>
jQuery( document ).ready(function() {
jQuery('a[title="Forum"]').click(function(e) {trackOutboundLink('https://forums.coronalabs.com/', "outboundForum"); console.log("Forum clicked");});
jQuery('a[title="Marketplace"]').click(function(e) {trackOutboundLink('https://marketplace.coronalabs.com/', "outboundMarketplace"); console.log("Marketplace clicked");});
});
</script>


</body>
</html>	
<!-- This website is like a Rocket, isn't it? Performance optimized by WP Rocket. Learn more: https://wp-rocket.me -->