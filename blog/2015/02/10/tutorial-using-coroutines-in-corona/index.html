<!DOCTYPE html>
<html lang="en-US"
	prefix="og: http://ogp.me/ns#" >
<head>
	
	<meta charset="UTF-8" />
	
	<title>Tutorial: Using Coroutines in Corona | Corona Labs</title><link rel="stylesheet" href="/wordpress/wp-content/cache/min/1/00d0de513e0511587eebe2100ad2cfec.css" data-minify="1" />

	
	<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=yes">
	
	<link rel="profile" href="https://gmpg.org/xfn/11" />
	<link rel="pingback" href="/wordpress/xmlrpc.php" />
	
	<link rel="shortcut icon" href="/favicon.ico">
	<link rel="apple-touch-icon" sizes="180x180" href="/fav/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/fav/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/fav/favicon-16x16.png">
	<link rel="manifest" href="/fav/site.webmanifest">
	<link rel="mask-icon" href="/fav/safari-pinned-tab.svg" color="#f96f29">
	<meta name="msapplication-TileColor" content="#f96f29">
	<meta name="msapplication-config" content="/fav/browserconfig.xml">
	<meta name="theme-color" content="#ffffff">
	
	<script type="application/javascript">var QodeAjaxUrl = "/wordpress/wp-admin/admin-ajax.php"</script><link rel="alternate" hreflang="en" href="/blog/2015/02/10/tutorial-using-coroutines-in-corona/" />

<!-- All in One SEO Pack 2.11 by Michael Torbert of Semper Fi Web Designob_start_detected [-1,-1] -->
<link rel="author" href="https://plus.google.com/106405667962965815359/" />
<meta name="description"  content="Coroutines, one of Lua&#039;s key features, are quite powerful and give you the ability to start and stop blocks of code as needed. From advanced timer manipulation to creating state machines, coroutines give you greater control over when parts of your code execute. This tutorial touches on just a few of their many uses, in particular those which play to Corona&#039;s own strengths." />

<meta name="keywords"  content="coroutine,tutorial,guest bloggers,tutorials, tips and demos" />

<link rel="canonical" href="/blog/2015/02/10/tutorial-using-coroutines-in-corona/" />
<meta property="og:title" content="Tutorial: Using Coroutines in Corona | Corona Labs" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/blog/2015/02/10/tutorial-using-coroutines-in-corona/" />
<meta property="og:image" content="/wordpress/wp-content/uploads/2012/06/lua.gif" />
<meta property="og:site_name" content="Corona Labs" />
<meta property="fb:app_id" content="1891032014500066" />
<meta property="og:description" content="Today&#039;s guest tutorial comes to you courtesy of Steven Johnson, the Technical Director and head of R&amp;D at Xibalba Studios. Steven has been using Lua since 2003 and he has worked with custom engines, Vision SDK, LÖVE, HTML5 emulation, and projects with SDL bindings in C++ and LuaJIT. When he&#039;s not working on his own hobby projects, he likes to research math and graphics concepts. Coroutines, introduced in Lua 5.0, are one of the language&#039;s key features, but despite having been available in Corona from the beginning, they seem to receive very little attention. This is unfortunate, as coroutines are quite powerful, giving you the ability to start and stop blocks of code as needed. Whether you want to do advanced timer manipulation or create state machines, coroutines give you greater control over when the parts of your code execute. This tutorial will touch on just a few of their many uses, in particular those which play to Corona&#039;s own strengths. The Basics Let&#039;s begin with a quick" />
<meta property="article:published_time" content="2015-02-10T22:23:48Z" />
<meta property="article:modified_time" content="2015-02-10T22:23:48Z" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@coronalabs" />
<meta name="twitter:title" content="Tutorial: Using Coroutines in Corona | Corona Labs" />
<meta name="twitter:description" content="Today&#039;s guest tutorial comes to you courtesy of Steven Johnson, the Technical Director and head of R&amp;D at Xibalba Studios. Steven has been using Lua since 2003 and he has worked with custom engines, Vision SDK, LÖVE, HTML5 emulation, and projects with SDL bindings in C++ and LuaJIT. When he&#039;s not working on his own hobby projects, he likes to research math and graphics concepts. Coroutines, introduced in Lua 5.0, are one of the language&#039;s key features, but despite having been available in Corona from the beginning, they seem to receive very little attention. This is unfortunate, as coroutines are quite powerful, giving you the ability to start and stop blocks of code as needed. Whether you want to do advanced timer manipulation or create state machines, coroutines give you greater control over when the parts of your code execute. This tutorial will touch on just a few of their many uses, in particular those which play to Corona&#039;s own strengths. The Basics Let&#039;s begin with a quick" />
<meta name="twitter:image" content="/wordpress/wp-content/uploads/2012/06/lua.gif" />
<meta itemprop="image" content="/wordpress/wp-content/uploads/2012/06/lua.gif" />
			<script type="text/javascript" >
				window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
				ga('create', 'UA-9574984-6', 'auto', { 'allowLinker': true } );
				// Plugins
				ga('require', 'linkid', 'linkid.js');ga('require', 'outboundLinkTracker');
				ga('send', 'pageview');
			</script>
			<script async src="https://www.google-analytics.com/analytics.js"></script>
			<script data-minify="1" async src="/wordpress/wp-content/cache/min/1/wordpress/wp-content/plugins/all-in-one-seo-pack/public/js/vendor/autotrack-b66c534ea2d32d9123d9ba2034031f08.js"></script>
<!-- /all in one seo pack -->
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="Corona Labs &raquo; Feed" href="/feed/" />
<link rel="alternate" type="application/rss+xml" title="Corona Labs &raquo; Comments Feed" href="/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Corona Labs &raquo; Tutorial: Using Coroutines in Corona Comments Feed" href="/blog/2015/02/10/tutorial-using-coroutines-in-corona/feed/" />





<style id='contact-form-7-inline-css' type='text/css'>
.wpcf7 .wpcf7-recaptcha iframe {margin-bottom: 0;}
</style>

<link rel='stylesheet' id='tp-open-sans-css'  href='https://fonts.googleapis.com/css?family=Open+Sans%3A300%2C400%2C600%2C700%2C800&#038;ver=4.9.8' type='text/css' media='all' />
<link rel='stylesheet' id='tp-raleway-css'  href='https://fonts.googleapis.com/css?family=Raleway%3A100%2C200%2C300%2C400%2C500%2C600%2C700%2C800%2C900&#038;ver=4.9.8' type='text/css' media='all' />
<link rel='stylesheet' id='tp-exo2-css'  href='https://fonts.googleapis.com/css?family=Exo+2%3A600&#038;subset=cyrillic&#038;ver=4.9.8' type='text/css' media='all' />
<link rel='stylesheet' id='tp-lato-css'  href='https://fonts.googleapis.com/css?family=Lato&#038;ver=4.9.8' type='text/css' media='all' />

<style id='rs-plugin-settings-inline-css' type='text/css'>
#rs-demo-id {}
</style>














<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/jquery-1.12.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/jquery-migrate.min-1.4.1.js'></script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/plugins/nix-gravatar-cache-master/js/main-b8674cbf705f6800e4c39626ea12a541.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"\/wordpress\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min-_2.7.2_beta.js'></script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/plugins/handl-utm-grabber/js/js.cookie-1a19bb4009b00727ae545e834c88ec1f.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var handl_utm = [];
/* ]]> */
</script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/plugins/handl-utm-grabber/js/handl-utm-grabber-88312d6ccff4a3570b3db197b12cb532.js'></script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/plugins/essential-grid/public/assets/js/lightbox-698aa832940bd67decd795f1bd23433b.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-content/plugins/essential-grid/public/assets/js/jquery.themepunch.tools.min-2.1.0.2.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-content/plugins/revslider/public/assets/js/jquery.themepunch.revolution.min-5.4.7.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-content/plugins/wp-popups-lite/src/assets/js/hooks.min-2.0.3.7.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_browser_redirect_params = {"pageLanguage":"en","languageUrls":{"en_US":"\/blog\/2015\/02\/10\/tutorial-using-coroutines-in-corona\/","en":"\/blog\/2015\/02\/10\/tutorial-using-coroutines-in-corona\/","US":"\/blog\/2015\/02\/10\/tutorial-using-coroutines-in-corona\/"},"cookie":{"name":"_icl_visitor_lang_js","domain":"coronalabs.com","path":"\/","expiration":24}};
/* ]]> */
</script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/plugins/sitepress-multilingual-cms/dist/js/browser-redirect/app-824426e66e79e692e26c5e5b63cb6452.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"\/wordpress\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data-3d7bf654e9e30cc40e584574182b2763.js'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/wordpress/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wordpress/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Guest post: 3 ways to more effectively re-engage your players' href='/blog/2015/02/09/guest-post-3-ways-to-more-effectively-re-engage-your-players/' />
<link rel='next' title='From the Forum &#8212; Issue #59' href='/blog/2015/02/13/from-the-forum-issue-59/' />
<meta name="generator" content="WordPress 4.9.8" />
<link rel='shortlink' href='/?p=61368' />
<meta name="generator" content="WPML ver:4.1.1 stt:1,46;" />
<link rel="alternate" type="application/json" title="Corona Labs &raquo; JSON Feed" href="/feed/json/" />		<script type="text/javascript">
			var ajaxRevslider;
			
			jQuery(document).ready(function() {
				// CUSTOM AJAX CONTENT LOADING FUNCTION
				ajaxRevslider = function(obj) {
				
					// obj.type : Post Type
					// obj.id : ID of Content to Load
					// obj.aspectratio : The Aspect Ratio of the Container / Media
					// obj.selector : The Container Selector where the Content of Ajax will be injected. It is done via the Essential Grid on Return of Content
					
					var content = "";

					data = {};
					
					data.action = 'revslider_ajax_call_front';
					data.client_action = 'get_slider_html';
					data.token = 'a5acf8e1ab';
					data.type = obj.type;
					data.id = obj.id;
					data.aspectratio = obj.aspectratio;
					
					// SYNC AJAX REQUEST
					jQuery.ajax({
						type:"post",
						url:"/wordpress/wp-admin/admin-ajax.php",
						dataType: 'json',
						data:data,
						async:false,
						success: function(ret, textStatus, XMLHttpRequest) {
							if(ret.success == true)
								content = ret.data;								
						},
						error: function(e) {
							console.log(e);
						}
					});
					
					 // FIRST RETURN THE CONTENT WHEN IT IS LOADED !!
					 return content;						 
				};
				
				// CUSTOM AJAX FUNCTION TO REMOVE THE SLIDER
				var ajaxRemoveRevslider = function(obj) {
					return jQuery(obj.selector+" .rev_slider").revkill();
				};

				// EXTEND THE AJAX CONTENT LOADING TYPES WITH TYPE AND FUNCTION
				var extendessential = setInterval(function() {
					if (jQuery.fn.tpessential != undefined) {
						clearInterval(extendessential);
						if(typeof(jQuery.fn.tpessential.defaults) !== 'undefined') {
							jQuery.fn.tpessential.defaults.ajaxTypes.push({type:"revslider",func:ajaxRevslider,killfunc:ajaxRemoveRevslider,openAnimationSpeed:0.3});   
							// type:  Name of the Post to load via Ajax into the Essential Grid Ajax Container
							// func: the Function Name which is Called once the Item with the Post Type has been clicked
							// killfunc: function to kill in case the Ajax Window going to be removed (before Remove function !
							// openAnimationSpeed: how quick the Ajax Content window should be animated (default is 0.3)
						}
					}
				},30);
			});
		</script>
		<meta name="generator" content="Powered by WPBakery Page Builder - drag and drop page builder for WordPress."/>
<!--[if lte IE 9]><link rel="stylesheet" type="text/css" href="/wordpress/wp-content/plugins/js_composer/assets/css/vc_lte_ie9.min.css" media="screen"><![endif]--><style type="text/css" id="spu-css-76435" class="spu-css">		#spu-bg-76435 {
			background-color: rgba(117, 169, 177, 0.33);
		}

		#spu-76435 .spu-close {
			font-size: 40px;
			color: rgb(255, 255, 255);
			text-shadow: 0 1px 0#000;
		}

		#spu-76435 .spu-close:hover {
			color: #000;
		}

		#spu-76435 {
			background-color: rgb(246, 246, 240);
			max-width: 750px;
			
					height: auto;
					box-shadow:  5px 5px 5px 0px #ccc;
				}

		#spu-76435 .spu-container {
					border: 5px solid;
			border-color: rgb(6, 94, 79);
			border-radius: 0px;
			margin: 14px;
					padding: 50px;
			height: calc(100% - 28px);
		}
								</style>
		<script type="text/javascript">function setREVStartSize(e){									
						try{ e.c=jQuery(e.c);var i=jQuery(window).width(),t=9999,r=0,n=0,l=0,f=0,s=0,h=0;
							if(e.responsiveLevels&&(jQuery.each(e.responsiveLevels,function(e,f){f>i&&(t=r=f,l=e),i>f&&f>r&&(r=f,n=e)}),t>r&&(l=n)),f=e.gridheight[l]||e.gridheight[0]||e.gridheight,s=e.gridwidth[l]||e.gridwidth[0]||e.gridwidth,h=i/s,h=h>1?1:h,f=Math.round(h*f),"fullscreen"==e.sliderLayout){var u=(e.c.width(),jQuery(window).height());if(void 0!=e.fullScreenOffsetContainer){var c=e.fullScreenOffsetContainer.split(",");if (c) jQuery.each(c,function(e,i){u=jQuery(i).length>0?u-jQuery(i).outerHeight(!0):u}),e.fullScreenOffset.split("%").length>1&&void 0!=e.fullScreenOffset&&e.fullScreenOffset.length>0?u-=jQuery(window).height()*parseInt(e.fullScreenOffset,0)/100:void 0!=e.fullScreenOffset&&e.fullScreenOffset.length>0&&(u-=parseInt(e.fullScreenOffset,0))}f=u}else void 0!=e.minHeight&&f<e.minHeight&&(f=e.minHeight);e.c.closest(".rev_slider_wrapper").css({height:f})					
						}catch(d){console.log("Failure at Presize of Slider:"+d)}						
					};</script>
<noscript><style type="text/css"> .wpb_animate_when_almost_visible { opacity: 1; }</style></noscript>	
<script>
var trackOutboundLink = function(url, name) {
ga('send', 'event', name, 'click', url, {
'transport': 'beacon'
});
}
</script>

<!-- Counters go here --></head>

<body data-rsssl=1 class="post-template-default single single-post postid-61368 single-format-standard  qode-child-theme-ver-1.0.0 qode-theme-ver-11.0 qode-theme-bridge wpb-js-composer js-comp-ver-5.5.5 vc_responsive" itemscope itemtype="http://schema.org/WebPage">

						<div class="wrapper">
	<div class="wrapper_inner">
	<!-- Google Analytics start -->
	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-9574984-6', 'auto');
  ga('send', 'pageview');

</script>
	<!-- Google Analytics end -->

	


<header class="scroll_header_top_area  stick transparent scrolled_not_transparent page_header">
    <div class="header_inner clearfix">

		<div class="header_top_bottom_holder">
		<div class="header_bottom clearfix" style=' background-color:rgba(255, 255, 255, 0);' >
		                    					<div class="header_inner_left">
                        													<div class="mobile_menu_button">
                                <span>
                                    <i class="qode_icon_font_awesome fa fa-bars" ></i>                                </span>
                            </div>
												<div class="logo_wrapper">
                            							<div class="q_logo">
								<a itemprop="url" href="/">
									<img itemprop="image" class="normal" src="/wordpress/wp-content/uploads/2017/12/logo_s.svg" alt="Logo"/>
									<img itemprop="image" class="light" src="/wordpress/wp-content/uploads/2017/12/logo_s.svg" alt="Logo"/>
									<img itemprop="image" class="dark" src="/wordpress/wp-content/uploads/2017/12/logo_s.svg" alt="Logo"/>
									<img itemprop="image" class="sticky" src="/wordpress/wp-content/uploads/2017/12/logo_w.svg" alt="Logo"/>
									<img itemprop="image" class="mobile" src="/wordpress/wp-content/uploads/2017/12/logo_w.svg" alt="Logo"/>
																	</a>
							</div>
                            						</div>
                                                					</div>
                    					                                                							<div class="header_inner_right">
                                <div class="side_menu_button_wrapper right">
																		                                    <div class="side_menu_button">
									
										                                                                                                                    </div>
                                </div>
							</div>
												
						
						<nav class="main_menu drop_down right">
						<ul id="menu-top-menu-corona" class=""><li id="nav-menu-item-71022" class="menu-item menu-item-type-custom menu-item-object-custom  narrow"><a title="Product" href="/product/" class=""><i class="menu_icon blank fa"></i><span>PRODUCT</span><span class="plus"></span></a></li>
<li id="nav-menu-item-71023" class="menu-item menu-item-type-custom menu-item-object-custom  narrow"><a title="Learn" href="/learn/" class=""><i class="menu_icon blank fa"></i><span>LEARN</span><span class="plus"></span></a></li>
<li id="nav-menu-item-71024" class="menu-item menu-item-type-custom menu-item-object-custom  narrow"><a title="Stories" href="/stories/" class=""><i class="menu_icon blank fa"></i><span>STORIES</span><span class="plus"></span></a></li>
<li id="nav-menu-item-76070" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent  narrow"><a href="/blog/" class=""><i class="menu_icon blank fa"></i><span>BLOG</span><span class="plus"></span></a></li>
<li id="nav-menu-item-71112" class="menu-item menu-item-type-custom menu-item-object-custom  narrow"><a title="Forum" target="_blank" href="https://forums.solar2d.com/" class=""><i class="menu_icon blank fa"></i><span>FORUM</span><span class="plus"></span></a></li>
<li id="nav-menu-item-72910" class="menu-item menu-item-type-custom menu-item-object-custom  narrow"><a title="Marketplace" target="_blank" href="https://marketplace.coronalabs.com/" class=""><i class="menu_icon blank fa"></i><span>MARKET</span><span class="plus"></span></a></li>
<li id="nav-menu-item-71027" class="menu-item menu-item-type-custom menu-item-object-custom  narrow"><a title="Login" target="_blank" href="https://github.com/coronalabs/corona" class=""><i class="menu_icon blank fa"></i><span>LOG IN</span><span class="plus"></span></a></li>
<li id="nav-menu-item-71028" class="menu-item menu-item-type-custom menu-item-object-custom  narrow"><a title="Download" target="_blank" href="https://github.com/coronalabs/corona/releases/latest" class="js_download_button"><i class="menu_icon blank fa"></i><span>DOWNLOAD</span><span class="plus"></span></a></li>
<li id="nav-menu-item-wpml-ls-1014-en" class="menu-item wpml-ls-slot-1014 wpml-ls-item wpml-ls-item-en wpml-ls-current-language wpml-ls-menu-item wpml-ls-first-item wpml-ls-last-item menu-item-type-wpml_ls_menu_item menu-item-object-wpml_ls_menu_item  narrow"><a title="EN" href="/blog/2015/02/10/tutorial-using-coroutines-in-corona/" class=""><i class="menu_icon blank fa"></i><span><span class="wpml-ls-native">EN</span></span><span class="plus"></span></a></li>
</ul>						</nav>
						                        										<nav class="mobile_menu">
                        <ul id="menu-top-menu-corona-1" class=""><li id="mobile-menu-item-71022" class="menu-item menu-item-type-custom menu-item-object-custom"><a title="Product" href="/product/" class=""><span>PRODUCT</span></a><span class="mobile_arrow"><i class="fa fa-angle-right"></i><i class="fa fa-angle-down"></i></span></li>
<li id="mobile-menu-item-71023" class="menu-item menu-item-type-custom menu-item-object-custom"><a title="Learn" href="/learn/" class=""><span>LEARN</span></a><span class="mobile_arrow"><i class="fa fa-angle-right"></i><i class="fa fa-angle-down"></i></span></li>
<li id="mobile-menu-item-71024" class="menu-item menu-item-type-custom menu-item-object-custom"><a title="Stories" href="/stories/" class=""><span>STORIES</span></a><span class="mobile_arrow"><i class="fa fa-angle-right"></i><i class="fa fa-angle-down"></i></span></li>
<li id="mobile-menu-item-76070" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent"><a href="/blog/" class=""><span>BLOG</span></a><span class="mobile_arrow"><i class="fa fa-angle-right"></i><i class="fa fa-angle-down"></i></span></li>
<li id="mobile-menu-item-71112" class="menu-item menu-item-type-custom menu-item-object-custom"><a title="Forum" target="_blank" href="https://forums.solar2d.com/" class=""><span>FORUM</span></a><span class="mobile_arrow"><i class="fa fa-angle-right"></i><i class="fa fa-angle-down"></i></span></li>
<li id="mobile-menu-item-72910" class="menu-item menu-item-type-custom menu-item-object-custom"><a title="Marketplace" target="_blank" href="https://marketplace.coronalabs.com/" class=""><span>MARKET</span></a><span class="mobile_arrow"><i class="fa fa-angle-right"></i><i class="fa fa-angle-down"></i></span></li>
<li id="mobile-menu-item-71027" class="menu-item menu-item-type-custom menu-item-object-custom"><a title="Login" target="_blank" href="https://github.com/coronalabs/corona" class=""><span>LOG IN</span></a><span class="mobile_arrow"><i class="fa fa-angle-right"></i><i class="fa fa-angle-down"></i></span></li>
<li id="mobile-menu-item-71028" class="menu-item menu-item-type-custom menu-item-object-custom"><a title="Download" target="_blank" href="https://github.com/coronalabs/corona/releases/latest" class="js_download_button"><span>DOWNLOAD</span></a><span class="mobile_arrow"><i class="fa fa-angle-right"></i><i class="fa fa-angle-down"></i></span></li>
<li id="mobile-menu-item-wpml-ls-1014-en" class="menu-item wpml-ls-slot-1014 wpml-ls-item wpml-ls-item-en wpml-ls-current-language wpml-ls-menu-item wpml-ls-first-item wpml-ls-last-item menu-item-type-wpml_ls_menu_item menu-item-object-wpml_ls_menu_item"><a title="EN" href="/blog/2015/02/10/tutorial-using-coroutines-in-corona/" class=""><span><span class="wpml-ls-native">EN</span></span></a><span class="mobile_arrow"><i class="fa fa-angle-right"></i><i class="fa fa-angle-down"></i></span></li>
</ul>					</nav>
				</div>
	</div>
	</div>

</header>
		

    		<a id='back_to_top' href='#'>
			<span class="fa-stack">
				<i class="fa fa-arrow-up" style=""></i>
			</span>
		</a>
	    	
    
		
	
    
<div class="content">
						<div class="content_inner">
						<div class="title_outer title_without_animation"    data-height="364">
		<div class="title title_size_large  position_center  has_background" style="background-size:1920px auto;background-image:url(/wordpress/wp-content/uploads/2017/06/bg_short_header.jpg);height:364px;">
			<div class="image not_responsive"><img itemprop="image" src="/wordpress/wp-content/uploads/2017/06/bg_short_header.jpg" alt="&nbsp;" /> </div>
										<div class="title_holder"  style="padding-top:42px;height:322px;">
					<div class="container">
						<div class="container_inner clearfix">
								<div class="title_subtitle_holder" >
                                                                									<div class="title_subtitle_holder_inner">
																										<h1 ><span>Tutorial: Using Coroutines in Corona</span></h1>
																	
																																			</div>
								                                                            </div>
						</div>
					</div>
				</div>
								</div>
			</div>
										<div class="container">
														<div class="container_inner default_template_holder" >
																
							<div class="two_columns_75_25 background_color_sidebar grid2 clearfix">
								<div class="column1">
											
									<div class="column_inner">
										<div class="blog_single blog_holder">
													<article id="post-61368" class="post-61368 post type-post status-publish format-standard has-post-thumbnail hentry category-guest-bloggers category-tutorials-tips-demos tag-coroutine tag-tutorial">
			<div class="post_content_holder">
								<div class="post_text">
					<div class="post_text_inner">
<p><span itemprop="dateCreated" class="date entry_date updated">10 February 2015<meta itemprop="interactionCount" content="UserComments: 14"/></span></p>
						<h2 itemprop="name" class="entry_title">Tutorial: Using Coroutines in Corona</h2>

						<div class="post_info">

<i class="fa fa-user" aria-hidden="true"></i> <span class="post_author" itemprop="author" itemscope itemtype="http://schema.org/Person"> <a itemprop="name" class="post_author_link" href="/blog/author/brent/">Brent Sorrentino</a>
							</span>

							<br><i class="fa fa-hashtag" aria-hidden="true"></i> <span class="time"><a href="/blog/topics/guest-bloggers/" rel="category tag">Guest Bloggers</a>, <a href="/blog/topics/tutorials-tips-demos/" rel="category tag">Tutorials, Tips and Demos</a></span>
							
							
							
                                            <span class="dots"><i class="fa fa-square"></i></span><div class="blog_share qode_share"><div class="social_share_holder"><a href="javascript:void(0)" target="_self"><span class="social_share_title">Share</span></a><div class="social_share_dropdown"><div class="inner_arrow"></div><ul><li class="facebook_share"><a href="javascript:void(0)" onclick="window.open('http://www.facebook.com/sharer.php?s=100&amp;p[title]=Tutorial%3A+Using+Coroutines+in+Corona&amp;p[url]=%2Fblog%2F2015%2F02%2F10%2Ftutorial-using-coroutines-in-corona%2F&amp;p[images][0]=/wordpress/wp-content/uploads/2012/06/lua.gif&amp;p[summary]=Coroutines%2C+one+of+Lua%5C%27s+key+features%2C+are+quite+powerful+and+give+you+the+ability+to+start+and+stop+blocks+of+code+as+needed.+From+advanced+timer+manipulation+to+creating+state+machines%2C+coroutines+give+you+greater+control+over+when+parts+of+your+code+execute.+This+tutorial+touches+on+just+a+few+of+their+many+uses%2C+in+particular+those+which+play+to+Corona%5C%27s+own+strengths.', 'sharer', 'toolbar=0,status=0,width=620,height=280');"><i class="fa fa-facebook"></i></a></li><li class="twitter_share"><a href="#" onclick="popUp=window.open('http://twitter.com/home?status=Coroutines%2C+one+of+Lua%27s+key+features%2C+are+quite+powerful+and+give+you+the+ability+to+start+and+stop+blocks+of+code+/blog/2015/02/10/tutorial-using-coroutines-in-corona/', 'popupwindow', 'scrollbars=yes,width=800,height=400');popUp.focus();return false;"><i class="fa fa-twitter"></i></a></li><li  class="vk_share"><a href="#" onclick="popUp=window.open('http://vkontakte.ru/share.php?url=%2Fblog%2F2015%2F02%2F10%2Ftutorial-using-coroutines-in-corona%2F&amp;title=Tutorial%3A+Using+Coroutines+in+Corona&amp;description=Coroutines%2C+one+of+Lua%27s+key+features%2C+are+quite+powerful+and+give+you+the+ability+to+start+and+stop+blocks+of+code+as+needed.+From+advanced+timer+manipulation+to+creating+state+machines%2C+coroutines+give+you+greater+control+over+when+parts+of+your+code+execute.+This+tutorial+touches+on+just+a+few+of+their+many+uses%2C+in+particular+those+which+play+to+Corona%27s+own+strengths.&amp;image=%2Fwordpress%2Fwp-content%2Fuploads%2F2012%2F06%2Flua.gif', 'popupwindow', 'scrollbars=yes,width=800,height=400');popUp.focus();return false"><i class="fa fa-vk"></i></a></li></ul></div></div></div>    						</div>
						<p><em>Today&#8217;s guest tutorial comes to you courtesy of Steven Johnson, the Technical Director and head of R&amp;D at Xibalba Studios. Steven has been using Lua since 2003 and he has worked with custom engines, Vision SDK, LÖVE, HTML5 emulation, and projects with SDL bindings in C++ and LuaJIT. When he&#8217;s not working on his own hobby projects, he likes to research math and graphics concepts.</em></p>
<hr />
<p>Coroutines, <a href=http://www.jucs.org/jucs_10_7/coroutines_in_lua/de_Moura_A_L.html target="_blank">introduced in Lua 5.0</a>, are one of the language&#8217;s key features, but despite having been available in Corona from the beginning, they seem to receive very little attention. This is unfortunate, as coroutines are quite powerful, giving you the ability to start and stop blocks of code as needed. Whether you want to do advanced timer manipulation or create state machines, coroutines give you greater control over when the parts of your code execute. This tutorial will touch on just a few of their many uses, in particular those which play to Corona&#8217;s own strengths.</p>
<h3><a name="basics"></a>The Basics</h3>
<p>Let&#8217;s begin with a quick primer on the API. All functions are found in the <b>coroutine</b> table. As of this writing, these have not been included in Corona&#8217;s SDK API reference, but may be found in the <a href=http://www.lua.org/manual/5.1/manual.html?#5.2 target="_blank">Lua manual</a>.</p>
<p>Creating a coroutine is simple enough:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e34d617584839" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
-- This is the "routine" part of the coroutine, the code that gets run...
local function Body()
    print( "In the coroutine!" )
end

-- ...and this is the object we need to run it.
local co = coroutine.create( Body )
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e34d617584839-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e34d617584839-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e34d617584839-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e34d617584839-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e34d617584839-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e34d617584839-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e34d617584839-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e34d617584839-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e34d617584839-1"><span class="crayon-c">-- This is the "routine" part of the coroutine, the code that gets run...</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e34d617584839-2"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">Body</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e34d617584839-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"In the coroutine!"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e34d617584839-4"><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df2513e34d617584839-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e34d617584839-6"><span class="crayon-c">-- ...and this is the object we need to run it.</span></div><div class="crayon-line" id="crayon-5f8df2513e34d617584839-7"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">co</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">create</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">Body</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e34d617584839-8">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0025 seconds] -->
<p>This gives us a reference, <code>co</code>, to the coroutine.</p>
<p>We can inspect its type:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e359675879094" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
print( type( co ) )  -- prints "thread"
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e359675879094-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e359675879094-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e359675879094-1"><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-r">type</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">co</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- prints "thread"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e359675879094-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>What we find is that <code>co</code> is a distinct kind of object, rather than a table or userdata as we might expect. Don&#8217;t worry too much about the term &#8220;thread&#8221;; in Lua, it and &#8220;coroutine&#8221; are mostly interchangeable<a name="from_note1"></a><a href="#note1">[1]</a>. Also, these are <b>not </b>operating system threads, which preempt running code to switch tasks. Rather, coroutines are collaborative; the coroutine itself decides when to give up control.</p>
<p>We can also ask about the coroutine&#8217;s status:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e35f140651692" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
print( coroutine.status( co ) )  -- prints "suspended"
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e35f140651692-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e35f140651692-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e35f140651692-1"><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">status</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">co</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- prints "suspended"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e35f140651692-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>As we can see, simply creating the coroutine doesn&#8217;t run it. This shouldn&#8217;t be too surprising. Creating a function, for instance, is distinct from calling it. To run the coroutine, we must do this:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e363406118251" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
coroutine.resume( co )  -- prints "In the coroutine!"
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e363406118251-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e363406118251-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e363406118251-1"><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">resume</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">co</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- prints "In the coroutine!"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e363406118251-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>The body executes, and the message inside gets printed, as expected.</p>
<p>What is the coroutine&#8217;s status now? Let&#8217;s check:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e368410452596" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
print( coroutine.status( co ) )  -- prints "dead"
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e368410452596-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e368410452596-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e368410452596-1"><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">status</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">co</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- prints "dead"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e368410452596-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>The body has run its course, so nothing remains for the coroutine to do, and it goes dead.</p>
<p>Once a coroutine is dead, all we can do with it is ask its status, which will always be <code>"dead"</code>. If we try to resume it once more, nothing happens. Or rather, as we&#8217;ll see shortly, it fails silently.</p>
<p>At this point, coroutines seem like nothing more than a complicated way to call a function once, and only once!</p>
<p>The missing piece of the puzzle is the ability to yield:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e36c497123762" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
local function Body()
    print( "First resume" )

    coroutine.yield()

    print( "Second resume" )

    coroutine.yield()

    print( "Final resume" )
end

local co = coroutine.create( Body )

coroutine.resume( co )  -- prints "First resume"

print( "After first yield" )

coroutine.resume( co )  -- prints "Second resume"

print( "After second yield" )

coroutine.resume( co )  -- prints "Final resume"
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e36c497123762-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e36c497123762-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e36c497123762-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e36c497123762-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e36c497123762-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e36c497123762-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e36c497123762-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e36c497123762-8">8</div><div class="crayon-num" data-line="crayon-5f8df2513e36c497123762-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e36c497123762-10">10</div><div class="crayon-num" data-line="crayon-5f8df2513e36c497123762-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e36c497123762-12">12</div><div class="crayon-num" data-line="crayon-5f8df2513e36c497123762-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e36c497123762-14">14</div><div class="crayon-num" data-line="crayon-5f8df2513e36c497123762-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e36c497123762-16">16</div><div class="crayon-num" data-line="crayon-5f8df2513e36c497123762-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e36c497123762-18">18</div><div class="crayon-num" data-line="crayon-5f8df2513e36c497123762-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e36c497123762-20">20</div><div class="crayon-num" data-line="crayon-5f8df2513e36c497123762-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e36c497123762-22">22</div><div class="crayon-num" data-line="crayon-5f8df2513e36c497123762-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e36c497123762-24">24</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e36c497123762-1"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">Body</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e36c497123762-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"First resume"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e36c497123762-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e36c497123762-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">yield</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e36c497123762-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e36c497123762-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"Second resume"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e36c497123762-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e36c497123762-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">yield</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e36c497123762-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e36c497123762-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"Final resume"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e36c497123762-11"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e36c497123762-12">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e36c497123762-13"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">co</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">create</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">Body</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e36c497123762-14">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e36c497123762-15"><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">resume</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">co</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- prints "First resume"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e36c497123762-16">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e36c497123762-17"><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"After first yield"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e36c497123762-18">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e36c497123762-19"><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">resume</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">co</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- prints "Second resume"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e36c497123762-20">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e36c497123762-21"><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"After second yield"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e36c497123762-22">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e36c497123762-23"><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">resume</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">co</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- prints "Final resume"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e36c497123762-24">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0022 seconds] -->
<p>The first <code>coroutine.resume</code> kicks off the coroutine. The code at the beginning of the body executes, and a message is printed. So far, nothing new.</p>
<p>When the <code>coroutine.yield</code> fires, we suddenly hop outside of the coroutine&#8217;s body and back among the code that created it. Instead of getting the message <b>&#8220;Second resume&#8221;</b>, we see <b>&#8220;After first yield&#8221;</b>.</p>
<p>The coroutine is once again in a suspended state, just as it was after being created. It is <b>not</b> dead; there is still code left to execute. However, the coroutine won&#8217;t run again until we explicitly resume it.</p>
<p>When we do so, execution picks up where it left off, immediately after the yield, and we get the expected <b>&#8220;Second resume&#8221;</b>. Another yield and a final resume round out the snippet, giving us <b>&#8220;After second yield&#8221;</b> followed by <b>&#8220;Final resume&#8221;</b>.</p>
<p>After each of the yields, the status will be <code>"suspended"</code>. After the final resume, our coroutine is once again <code>"dead"</code>.</p>
<h3><a name="data"></a>Working With Data</h3>
<p>It&#8217;s possible to pass data to and from a coroutine. We can send values to the coroutine by passing them as arguments to <code>coroutine.resume</code>:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e372701176236" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
local function Body( a, b, c )
    DoSomething()

    local d, e = coroutine.yield()

    DoSomethingElse()

    local f, g, h = coroutine.yield()

    DoOneLastThing()
end

local co = coroutine.create( Body )

coroutine.resume( co, "one", 2 )  -- a = "one", b = 2, c = nil
coroutine.resume( co, 8, {} )  -- d = 8, e = the table
coroutine.resume( co, 42, 9 )  -- f = 42, g = 9, h = nil
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e372701176236-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e372701176236-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e372701176236-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e372701176236-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e372701176236-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e372701176236-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e372701176236-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e372701176236-8">8</div><div class="crayon-num" data-line="crayon-5f8df2513e372701176236-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e372701176236-10">10</div><div class="crayon-num" data-line="crayon-5f8df2513e372701176236-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e372701176236-12">12</div><div class="crayon-num" data-line="crayon-5f8df2513e372701176236-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e372701176236-14">14</div><div class="crayon-num" data-line="crayon-5f8df2513e372701176236-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e372701176236-16">16</div><div class="crayon-num" data-line="crayon-5f8df2513e372701176236-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e372701176236-18">18</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e372701176236-1"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">Body</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">a</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e372701176236-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">DoSomething</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e372701176236-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e372701176236-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">e</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">yield</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e372701176236-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e372701176236-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">DoSomethingElse</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e372701176236-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e372701176236-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">f</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">h</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">yield</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e372701176236-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e372701176236-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">DoOneLastThing</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e372701176236-11"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e372701176236-12">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e372701176236-13"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">co</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">create</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">Body</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e372701176236-14">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e372701176236-15"><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">resume</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">co</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"one"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- a = "one", b = 2, c = nil</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e372701176236-16"><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">resume</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">co</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- d = 8, e = the table</span></div><div class="crayon-line" id="crayon-5f8df2513e372701176236-17"><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">resume</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">co</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">42</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- f = 42, g = 9, h = nil</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e372701176236-18">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0028 seconds] -->
<p>As we see, on the very first resume (the one which kicks the coroutine off, after creation), the data winds up in the parameters. On each subsequent resume, they instead show up as return values of the most recent <code>coroutine.yield</code>.</p>
<p>Receiving isn&#8217;t too different, but we go through <code>coroutine.yield</code> instead:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e37a471503920" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
local function Body()
    DoSomething()

    coroutine.yield( 1, "3" )

    DoSomethingElse()

    coroutine.yield( { n = 6 }, 7, 4 )

    DoOneLastThing()

    return "Data", 1
end

local co = coroutine.create( Body )

print( coroutine.resume( co ) )  -- prints true, 1, "3"
print( coroutine.resume( co ) )  -- prints true, something about the table, 7, 4
print( coroutine.resume( co ) )  -- prints true, "Data", 1
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e37a471503920-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e37a471503920-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e37a471503920-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e37a471503920-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e37a471503920-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e37a471503920-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e37a471503920-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e37a471503920-8">8</div><div class="crayon-num" data-line="crayon-5f8df2513e37a471503920-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e37a471503920-10">10</div><div class="crayon-num" data-line="crayon-5f8df2513e37a471503920-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e37a471503920-12">12</div><div class="crayon-num" data-line="crayon-5f8df2513e37a471503920-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e37a471503920-14">14</div><div class="crayon-num" data-line="crayon-5f8df2513e37a471503920-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e37a471503920-16">16</div><div class="crayon-num" data-line="crayon-5f8df2513e37a471503920-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e37a471503920-18">18</div><div class="crayon-num" data-line="crayon-5f8df2513e37a471503920-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e37a471503920-20">20</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e37a471503920-1"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">Body</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e37a471503920-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">DoSomething</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e37a471503920-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e37a471503920-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">yield</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"3"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e37a471503920-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e37a471503920-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">DoSomethingElse</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e37a471503920-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e37a471503920-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">yield</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e37a471503920-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e37a471503920-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">DoOneLastThing</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e37a471503920-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e37a471503920-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">"Data"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5f8df2513e37a471503920-13"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e37a471503920-14">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e37a471503920-15"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">co</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">create</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">Body</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e37a471503920-16">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e37a471503920-17"><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">resume</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">co</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- prints true, 1, "3"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e37a471503920-18"><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">resume</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">co</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- prints true, something about the table, 7, 4</span></div><div class="crayon-line" id="crayon-5f8df2513e37a471503920-19"><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">resume</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">co</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- prints true, "Data", 1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e37a471503920-20">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0027 seconds] -->
<p>Here we see that any arguments passed to <code>coroutine.yield</code> end up as return values of the most recent <code>coroutine.resume</code>, as do any values returned from the coroutine body.</p>
<p>(<b>Programming in Lua</b> contains an <a href=http://www.lua.org/pil/9.2.html target="_blank">excellent example</a> of data-passing in action.)</p>
<p>Now, there&#8217;s something peculiar about the yield snippet. In the printed results, what does that <code>true</code> mean? It indicates that the resume was successful. Had an error occurred along the way, that <code>true</code> would be a <code>false</code> instead, the only other return value being an error message. When I mentioned before how resuming a dead coroutine fails silently, this is what is happening.</p>
<p>And speaking of dead coroutines, that&#8217;s what we&#8217;re stuck with, following an error.</p>
<h3><a name="wrap"></a>Wrapping Up</h3>
<p>We&#8217;ll often only need to create, resume, and yield a coroutine. This is common enough that a convenience function, <code>coroutine.wrap</code>, is provided in order to make coroutines more friendly to use:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e380085516936" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
local function Body()
    print( "First resume" )

    coroutine.yield()

    print( "Second resume" )

    coroutine.yield()

    print( "Final resume" )
end

local wrapped = coroutine.wrap( Body )

wrapped()  -- prints "First resume"
wrapped()  -- prints "Second resume"
wrapped()  -- prints "Final resume"
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e380085516936-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e380085516936-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e380085516936-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e380085516936-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e380085516936-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e380085516936-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e380085516936-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e380085516936-8">8</div><div class="crayon-num" data-line="crayon-5f8df2513e380085516936-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e380085516936-10">10</div><div class="crayon-num" data-line="crayon-5f8df2513e380085516936-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e380085516936-12">12</div><div class="crayon-num" data-line="crayon-5f8df2513e380085516936-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e380085516936-14">14</div><div class="crayon-num" data-line="crayon-5f8df2513e380085516936-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e380085516936-16">16</div><div class="crayon-num" data-line="crayon-5f8df2513e380085516936-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e380085516936-18">18</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e380085516936-1"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">Body</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e380085516936-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"First resume"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e380085516936-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e380085516936-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">yield</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e380085516936-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e380085516936-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"Second resume"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e380085516936-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e380085516936-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">yield</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e380085516936-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e380085516936-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"Final resume"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e380085516936-11"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e380085516936-12">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e380085516936-13"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">wrapped</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">wrap</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">Body</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e380085516936-14">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e380085516936-15"><span class="crayon-e">wrapped</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- prints "First resume"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e380085516936-16"><span class="crayon-e">wrapped</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- prints "Second resume"</span></div><div class="crayon-line" id="crayon-5f8df2513e380085516936-17"><span class="crayon-e">wrapped</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- prints "Final resume"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e380085516936-18">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0017 seconds] -->
<p>This resembles our earlier examples, except resuming the coroutine seems to behave like a regular function call. In fact, the wrapper <b>is </b>just a function; <code>coroutine.resume</code> is taken care of behind the scenes, together with the coroutine reference itself.</p>
<p>Passing data around works much as before, except unlike <code>coroutine.resume</code>, the wrapper doesn&#8217;t return a success boolean. So what if it fails? For instance, in the last example, if we were to call the wrapper once more, now that the coroutine has finished?</p>
<p><a href=/wordpress/wp-content/uploads/2015/02/crash.jpg><img class="size-full wp-image-61372 aligncenter" src=/wordpress/wp-content/uploads/2015/02/crash.jpg alt="crash" width="320" height="242" /></a></p>
<p><strong>&#8220;KERBLOOEY!&#8221;</strong></p>
<p>Of course, when developing in Corona, this is generally what we&#8217;ll want. It&#8217;s an error like any other. With all of this under our belt, we&#8217;re ready to advance.</p>
<h3><a name="tagteam"></a>The Coroutine-Timer Tag Team</h3>
<p><code>coroutine.wrap</code> offers some interesting possibilities. In particular, the wrapper being just a function opens some doors for us. Many Corona APIs, the various event listeners for instance, take function arguments, and will happily accept our coroutine-in-disguise.</p>
<p>Now, presumably we would favor coroutines over regular functions because we want the yield capability. Once we yield, however, the rest of the coroutine won&#8217;t happen, unless the wrapper gets called again (remember, doing this just performs a resume, under the hood). Therefore, we&#8217;ll typically want to use coroutines in logic that we expect to trigger multiple times.<a name="from_note2"></a><a href="#note2">[2]</a></p>
<p>As it happens, we have many such mechanisms in Corona. Timers, for instance:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e387858963102" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
local function Body()
    print( "First resume" )

    coroutine.yield()

    print( "Second resume" )

    coroutine.yield()

    print( "Final resume" )
end

timer.performWithDelay( 1000, coroutine.wrap( Body ), 3 )
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e387858963102-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e387858963102-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e387858963102-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e387858963102-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e387858963102-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e387858963102-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e387858963102-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e387858963102-8">8</div><div class="crayon-num" data-line="crayon-5f8df2513e387858963102-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e387858963102-10">10</div><div class="crayon-num" data-line="crayon-5f8df2513e387858963102-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e387858963102-12">12</div><div class="crayon-num" data-line="crayon-5f8df2513e387858963102-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e387858963102-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e387858963102-1"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">Body</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e387858963102-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"First resume"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e387858963102-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e387858963102-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">yield</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e387858963102-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e387858963102-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"Second resume"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e387858963102-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e387858963102-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">yield</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e387858963102-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e387858963102-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"Final resume"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e387858963102-11"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e387858963102-12">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e387858963102-13"><span class="crayon-v">timer</span><span class="crayon-sy">.</span><span class="crayon-e">performWithDelay</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">wrap</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">Body</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e387858963102-14">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
<p>As you might imagine, this will fire every second or so, printing one of the now-familiar messages each time. This is all well and good, but notice the iteration count: <strong>three</strong> iterations. Two for the yields and one more to run the final leg. If we overestimate this count, say by specifying four iterations, we&#8217;ll end up trying to resume a dead coroutine. The code above is quite simple, so this isn&#8217;t a huge worry.</p>
<p>As our coroutine body grows larger, it becomes increasingly difficult to maintain a correct count, especially when the yields are in loops or behind function calls. Once we bring <code>if</code> statements into the mix, we can&#8217;t even depend on a fixed number, and then we&#8217;re completely out of luck.</p>
<p>We really want something that &#8220;just works&#8221;. Fortunately, <code>"timer"</code> events come packaged with a reference, <a href=http://docs.coronalabs.com/api/event/timer/source.html target="_blank">source</a>, which can be used to cancel the corresponding timer. Rather than hard-coding some number of iterations, we can simply let the timer run indefinitely, only canceling it once we&#8217;ve finished our task.</p>
<p>A first attempt might go something like this:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e390393921423" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
local function Body( event )
    DoSomething()

    coroutine.yield()

    DoSomethingElse()

    timer.cancel( event.source )
end

timer.performWithDelay( 50, coroutine.wrap( Body ), 0 )
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e390393921423-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e390393921423-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e390393921423-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e390393921423-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e390393921423-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e390393921423-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e390393921423-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e390393921423-8">8</div><div class="crayon-num" data-line="crayon-5f8df2513e390393921423-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e390393921423-10">10</div><div class="crayon-num" data-line="crayon-5f8df2513e390393921423-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e390393921423-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e390393921423-1"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">Body</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">event</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e390393921423-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">DoSomething</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e390393921423-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e390393921423-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">yield</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e390393921423-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e390393921423-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">DoSomethingElse</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e390393921423-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e390393921423-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">timer</span><span class="crayon-sy">.</span><span class="crayon-e">cancel</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">event</span><span class="crayon-sy">.</span><span class="crayon-i">source</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e390393921423-9"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e390393921423-10">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e390393921423-11"><span class="crayon-v">timer</span><span class="crayon-sy">.</span><span class="crayon-e">performWithDelay</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">wrap</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">Body</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e390393921423-12">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p>And this will work&#8230; until it doesn&#8217;t. Unfortunately, coroutines flush out a <a href=http://en.wikipedia.org/wiki/Leaky_abstraction target="_blank">leaky abstraction</a>: Corona is recycling the event tables. Presumably this is to avoid garbage collector spikes, and is a great idea. With normal functions, we would never know the difference. But we&#8217;re being naughty. By yielding, we end up holding on to that event table across multiple frames. Meanwhile, Corona has been passing the table around, swapping timer references in and out. When it comes time to deal with &#8220;our&#8221; timer, we might cancel a different one altogether!</p>
<p>We can play nice by saving the reference up front:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e395580911832" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
local function Body( event )
    local source = event.source

    DoSomething()

    coroutine.yield()

    DoSomethingElse()

    timer.cancel( source )
end

timer.performWithDelay( 50, coroutine.wrap( Body ), 0 )
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e395580911832-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e395580911832-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e395580911832-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e395580911832-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e395580911832-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e395580911832-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e395580911832-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e395580911832-8">8</div><div class="crayon-num" data-line="crayon-5f8df2513e395580911832-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e395580911832-10">10</div><div class="crayon-num" data-line="crayon-5f8df2513e395580911832-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e395580911832-12">12</div><div class="crayon-num" data-line="crayon-5f8df2513e395580911832-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e395580911832-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e395580911832-1"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">Body</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">event</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e395580911832-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">source</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">event</span><span class="crayon-sy">.</span><span class="crayon-e">source</span></div><div class="crayon-line" id="crayon-5f8df2513e395580911832-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e395580911832-4"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">DoSomething</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e395580911832-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e395580911832-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">yield</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e395580911832-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e395580911832-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">DoSomethingElse</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e395580911832-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e395580911832-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">timer</span><span class="crayon-sy">.</span><span class="crayon-e">cancel</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">source</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e395580911832-11"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e395580911832-12">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e395580911832-13"><span class="crayon-v">timer</span><span class="crayon-sy">.</span><span class="crayon-e">performWithDelay</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">wrap</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">Body</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e395580911832-14">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0016 seconds] -->
<p>This does work. However, the <code>"timer"</code> event also contains <b>count</b> and <b>time</b> fields, and similar issues crop up.</p>
<p>We can account for these too. Our code probably won&#8217;t care where the event table came from (and as we just saw, it shouldn&#8217;t), and will be none the wiser if we give it a &#8220;shadow&#8221; table.<a name="from_note3"></a><a href="#note3">[3]</a> We update this shadow table instead, and all is well again.</p>
<h3><a name="timerutil"></a>A Timer Utility</h3>
<p>Figuring these things out each time is going to get old. For that matter, most coroutine-based timers are going to have the same &#8220;look&#8221; to them, once we do get these details in order. We ought to roll this all up for reuse:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e39d625675462" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
function CoroPerformWithDelay( delay, func, n )
    local wrapped = coroutine.wrap( function( event )
        func( event )  -- Do the action...

        return "cancel"  -- ...then tell the timer to die when we're done.
    end )

    local event2  -- Our "shadow" event.

    return timer.performWithDelay( delay, function( event )
        event2 = event2 or { source = event.source }  -- On first run, save source...

        event2.count = event.count  -- ...update these every time.
        event2.time = event.time

        local result = wrapped( event2 )  -- Update the coroutine. It will pick up the event on the first run.

        if result == "cancel" then
            timer.cancel( event2.source )  -- After func completes, or on a cancel request, kill the timer.
        end
    end, n or 0 )
end
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e39d625675462-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e39d625675462-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e39d625675462-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e39d625675462-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e39d625675462-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e39d625675462-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e39d625675462-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e39d625675462-8">8</div><div class="crayon-num" data-line="crayon-5f8df2513e39d625675462-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e39d625675462-10">10</div><div class="crayon-num" data-line="crayon-5f8df2513e39d625675462-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e39d625675462-12">12</div><div class="crayon-num" data-line="crayon-5f8df2513e39d625675462-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e39d625675462-14">14</div><div class="crayon-num" data-line="crayon-5f8df2513e39d625675462-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e39d625675462-16">16</div><div class="crayon-num" data-line="crayon-5f8df2513e39d625675462-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e39d625675462-18">18</div><div class="crayon-num" data-line="crayon-5f8df2513e39d625675462-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e39d625675462-20">20</div><div class="crayon-num" data-line="crayon-5f8df2513e39d625675462-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e39d625675462-22">22</div><div class="crayon-num" data-line="crayon-5f8df2513e39d625675462-23">23</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e39d625675462-1"><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">CoroPerformWithDelay</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">delay</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">func</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">n</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e39d625675462-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">wrapped</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">wrap</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">event</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e39d625675462-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">func</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">event</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- Do the action...</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e39d625675462-4">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e39d625675462-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">"cancel"</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- ...then tell the timer to die when we're done.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e39d625675462-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e39d625675462-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e39d625675462-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">event2</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- Our "shadow" event.</span></div><div class="crayon-line" id="crayon-5f8df2513e39d625675462-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e39d625675462-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">timer</span><span class="crayon-sy">.</span><span class="crayon-e">performWithDelay</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">delay</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">event</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e39d625675462-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">event2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">event2</span><span class="crayon-h"> </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-v">source</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">event</span><span class="crayon-sy">.</span><span class="crayon-i">source</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- On first run, save source...</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e39d625675462-12">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e39d625675462-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">event2</span><span class="crayon-sy">.</span><span class="crayon-v">count</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">event</span><span class="crayon-sy">.</span><span class="crayon-v">count</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- ...update these every time.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e39d625675462-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">event2</span><span class="crayon-sy">.</span><span class="crayon-v">time</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">event</span><span class="crayon-sy">.</span><span class="crayon-e">time</span></div><div class="crayon-line" id="crayon-5f8df2513e39d625675462-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e39d625675462-16"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">wrapped</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">event2</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- Update the coroutine. It will pick up the event on the first run.</span></div><div class="crayon-line" id="crayon-5f8df2513e39d625675462-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e39d625675462-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"cancel"</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line" id="crayon-5f8df2513e39d625675462-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">timer</span><span class="crayon-sy">.</span><span class="crayon-e">cancel</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">event2</span><span class="crayon-sy">.</span><span class="crayon-i">source</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- After func completes, or on a cancel request, kill the timer.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e39d625675462-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df2513e39d625675462-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">n</span><span class="crayon-h"> </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e39d625675462-22"><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df2513e39d625675462-23">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0038 seconds] -->
<p>Now, we&#8217;ve been looking at timers, but the same ideas extend to <code>"enterFrame"</code> listeners, and even to repeating transitions. I tend to favor timers because of the customizable delay, and find them a bit more natural to cancel. If the coroutine is going to run forever anyway, however, it&#8217;s rather arbitrary.</p>
<p>Since we&#8217;ve brought up canceling, note that it&#8217;s perfectly fine to cancel the timer early. That said, it&#8217;s important to recognize that the timer and coroutine are two distinct things, so we would still need to yield the coroutine. Our helper function lets us do both at once (from inside the coroutine, of course) by calling <code>coroutine.yield("cancel")</code>.</p>
<h3><a name="waitutils"></a>Waiting Around</h3>
<p>So we have coroutines running on top of timers. Where do we go from here? Just using a timer encourages us to think of individual steps in the coroutine as taking place in time. If we apply this perspective to an earlier example, first we <code>DoSomething()</code>, then <i>later</i> we <code>DoSomethingElse()</code>. It&#8217;s a short leap from there to wanting something more explicitly chronological, like &#8220;<code>DoSomethingElse()</code> five seconds from now&#8221;. Can we achieve this?</p>
<p>Well, we do know when &#8220;now&#8221; is: we just ask <code>system.getTimer</code>. &#8220;The future,&#8221; then, is just &#8220;now&#8221; plus 5000 milliseconds. Once &#8220;the future&#8221; arrives, we know our five seconds are up. The most straightforward approach is to loop until then, yielding on each iteration. <a name="from_note4"></a><a href="#note1">[4]</a></p>
<p>Consider the following:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e3a3612561505" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
function WaitMS ( duration, update )
    local now = system.getTimer()
    local ends_at = now + duration

    while now &lt; ends_at do
        if update then -- Call any per-frame behavior. Yielding is discouraged, as it throws off our bookkeeping.
            update()
        end

        coroutine.yield()

        now = system.getTimer()
    end
end
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e3a3612561505-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3a3612561505-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e3a3612561505-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3a3612561505-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e3a3612561505-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3a3612561505-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e3a3612561505-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3a3612561505-8">8</div><div class="crayon-num" data-line="crayon-5f8df2513e3a3612561505-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3a3612561505-10">10</div><div class="crayon-num" data-line="crayon-5f8df2513e3a3612561505-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3a3612561505-12">12</div><div class="crayon-num" data-line="crayon-5f8df2513e3a3612561505-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3a3612561505-14">14</div><div class="crayon-num" data-line="crayon-5f8df2513e3a3612561505-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e3a3612561505-1"><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">WaitMS</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">duration</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">update</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3a3612561505-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">now</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">system</span><span class="crayon-sy">.</span><span class="crayon-e">getTimer</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3a3612561505-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">ends_at</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">now</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">duration</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3a3612561505-4">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e3a3612561505-5"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-v">now</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-e">ends_at </span><span class="crayon-st">do</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3a3612561505-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">update </span><span class="crayon-st">then</span><span class="crayon-h"> </span><span class="crayon-c">-- Call any per-frame behavior. Yielding is discouraged, as it throws off our bookkeeping.</span></div><div class="crayon-line" id="crayon-5f8df2513e3a3612561505-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">update</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3a3612561505-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df2513e3a3612561505-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3a3612561505-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">yield</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3a3612561505-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3a3612561505-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">now</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">system</span><span class="crayon-sy">.</span><span class="crayon-e">getTimer</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3a3612561505-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3a3612561505-14"><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df2513e3a3612561505-15">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0018 seconds] -->
<p>Then, lo and behold, we can do this:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e3a8735393851" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
DoSomething()
WaitMS( 5000 )
DoSomethingElse()
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e3a8735393851-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3a8735393851-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e3a8735393851-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3a8735393851-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e3a8735393851-1"><span class="crayon-e">DoSomething</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3a8735393851-2"><span class="crayon-e">WaitMS</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3a8735393851-3"><span class="crayon-e">DoSomethingElse</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3a8735393851-4">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>Five seconds may be a long time, relatively speaking, just to wait around. The optional <code>update</code> parameter lets us sneak in little batches of work, as necessary.</p>
<p>We can wait for something other than time, obviously. Perhaps some condition must be satisfied:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e3b1912025226" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
function WaitUntilTrue( func, update )
    while not func() do
        if update then
            update()
        end

        coroutine.yield()
    end
end
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e3b1912025226-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3b1912025226-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e3b1912025226-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3b1912025226-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e3b1912025226-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3b1912025226-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e3b1912025226-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3b1912025226-8">8</div><div class="crayon-num" data-line="crayon-5f8df2513e3b1912025226-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3b1912025226-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e3b1912025226-1"><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">WaitUntilTrue</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">func</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">update</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3b1912025226-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">func</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">do</span></div><div class="crayon-line" id="crayon-5f8df2513e3b1912025226-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">update </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3b1912025226-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">update</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3b1912025226-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3b1912025226-6">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e3b1912025226-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">yield</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3b1912025226-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df2513e3b1912025226-9"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3b1912025226-10">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>Let&#8217;s try it out! Here, we fire off a transition, then wait for it to finish:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e3b6732454838" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
local pos = { x = 20 }
local done = false  -- We haven't even started. Of course we're not done!

transition.to( pos, {
    x = 50,

    onComplete = function()
        done = true  -- NOW we're done.
    end
})

WaitUntilTrue( function()
    return done  -- Are we done yet?
end )
DoSomethingElse()
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e3b6732454838-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3b6732454838-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e3b6732454838-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3b6732454838-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e3b6732454838-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3b6732454838-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e3b6732454838-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3b6732454838-8">8</div><div class="crayon-num" data-line="crayon-5f8df2513e3b6732454838-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3b6732454838-10">10</div><div class="crayon-num" data-line="crayon-5f8df2513e3b6732454838-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3b6732454838-12">12</div><div class="crayon-num" data-line="crayon-5f8df2513e3b6732454838-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3b6732454838-14">14</div><div class="crayon-num" data-line="crayon-5f8df2513e3b6732454838-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3b6732454838-16">16</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e3b6732454838-1"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">pos</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3b6732454838-2"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">done</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">false</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- We haven't even started. Of course we're not done!</span></div><div class="crayon-line" id="crayon-5f8df2513e3b6732454838-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3b6732454838-4"><span class="crayon-v">transition</span><span class="crayon-sy">.</span><span class="crayon-st">to</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">pos</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5f8df2513e3b6732454838-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3b6732454838-6">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e3b6732454838-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">onComplete</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3b6732454838-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">done</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">true</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- NOW we're done.</span></div><div class="crayon-line" id="crayon-5f8df2513e3b6732454838-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3b6732454838-10"><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3b6732454838-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3b6732454838-12"><span class="crayon-e">WaitUntilTrue</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3b6732454838-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">done</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- Are we done yet?</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3b6732454838-14"><span class="crayon-st">end</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3b6732454838-15"><span class="crayon-e">DoSomethingElse</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3b6732454838-16">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0019 seconds] -->
<p>Similarly, we can wait for some property to be true:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e3ba719571594" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
function WaitUntilPropertyTrue( object, name, update )
    while not object[name] do
        if update then
            update()
        end

        coroutine.yield()
    end
end
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e3ba719571594-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3ba719571594-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e3ba719571594-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3ba719571594-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e3ba719571594-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3ba719571594-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e3ba719571594-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3ba719571594-8">8</div><div class="crayon-num" data-line="crayon-5f8df2513e3ba719571594-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3ba719571594-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e3ba719571594-1"><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">WaitUntilPropertyTrue</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">object</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">update</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3ba719571594-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">object</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">do</span></div><div class="crayon-line" id="crayon-5f8df2513e3ba719571594-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">update </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3ba719571594-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">update</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3ba719571594-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3ba719571594-6">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e3ba719571594-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">yield</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3ba719571594-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df2513e3ba719571594-9"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3ba719571594-10">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>Let&#8217;s use this to wait until an object becomes visible:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e3be185735418" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
local rect = display.newRect( 100, 100, 50, 50 )

rect.isVisible = false

timer.performWithDelay( 5000, function()
    rect.isVisible = true
end )

WaitUntilPropertyTrue( rect, "isVisible" )
DoSomethingElse()
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e3be185735418-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3be185735418-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e3be185735418-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3be185735418-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e3be185735418-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3be185735418-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e3be185735418-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3be185735418-8">8</div><div class="crayon-num" data-line="crayon-5f8df2513e3be185735418-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3be185735418-10">10</div><div class="crayon-num" data-line="crayon-5f8df2513e3be185735418-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e3be185735418-1"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">rect</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">display</span><span class="crayon-sy">.</span><span class="crayon-e">newRect</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3be185735418-2">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e3be185735418-3"><span class="crayon-v">rect</span><span class="crayon-sy">.</span><span class="crayon-v">isVisible</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">false</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3be185735418-4">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e3be185735418-5"><span class="crayon-v">timer</span><span class="crayon-sy">.</span><span class="crayon-e">performWithDelay</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3be185735418-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">rect</span><span class="crayon-sy">.</span><span class="crayon-v">isVisible</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">true</span></div><div class="crayon-line" id="crayon-5f8df2513e3be185735418-7"><span class="crayon-st">end</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3be185735418-8">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e3be185735418-9"><span class="crayon-e">WaitUntilPropertyTrue</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">rect</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"isVisible"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3be185735418-10"><span class="crayon-e">DoSomethingElse</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3be185735418-11">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
<p>Many more ideas could be explored. Obviously the &#8220;Wait until X is false&#8221; variants have their place. We can even watch multiple states, for which we&#8217;d have &#8220;Wait until all states in X are true&#8221;, &#8220;Wait until any state in X is true&#8221;, and so forth.</p>
<p>Each of these helper functions was fairly general, but nothing prevents us from making more specific ones. Compound operations, such as &#8220;Wait until object is visible, then wait ten seconds&#8221;, may also come in handy.</p>
<p>As the last examples show, coroutines play well with timers and transitions. Just one more tool in our kit.</p>
<h3><a name="statemachine"></a>State Machines</h3>
<p>Sometimes we&#8217;ll run across code like the following:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e3c3600870507" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
if state == 1 then
    DoState1()
elseif state == 2 then
    DoState2()
-- etc...
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e3c3600870507-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3c3600870507-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e3c3600870507-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3c3600870507-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e3c3600870507-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3c3600870507-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e3c3600870507-1"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3c3600870507-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">DoState1</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3c3600870507-3"><span class="crayon-st">elseif</span><span class="crayon-h"> </span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3c3600870507-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">DoState2</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3c3600870507-5"><span class="crayon-c">-- etc...</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3c3600870507-6">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>Or, using strings:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e3c7333097422" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
if state == "starting" then
    Start()
elseif state == "walking" then
    Walk()
elseif state == "waiting" then
    Wait()
-- etc...
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e3c7333097422-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3c7333097422-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e3c7333097422-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3c7333097422-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e3c7333097422-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3c7333097422-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e3c7333097422-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3c7333097422-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e3c7333097422-1"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"starting"</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3c7333097422-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">Start</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3c7333097422-3"><span class="crayon-st">elseif</span><span class="crayon-h"> </span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"walking"</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3c7333097422-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">Walk</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3c7333097422-5"><span class="crayon-st">elseif</span><span class="crayon-h"> </span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"waiting"</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3c7333097422-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">Wait</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3c7333097422-7"><span class="crayon-c">-- etc...</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3c7333097422-8">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
<p>This works well enough, but it&#8217;s often overkill, especially when we&#8217;re merely performing a sequence of actions. Beyond that, the pattern itself has some inherent dangers. When using integer states, we must remember which state belongs to what action. It doesn&#8217;t take long to lose our place. If we switch to the <span style="line-height: 1.5;">wrong state, say by mistyping the integer, we could easily have a debugging nightmare on our hands.</span></p>
<p>This isn&#8217;t such a problem with strings, of course, but we do have the hassle of thinking up good names. This is less trivial than it may seem. Things start out easy enough. We have <code>"starting"</code>, <code>"walking"</code>, and <code style="line-height: 1.5;">"waiting"</code><span style="line-height: 1.5;"> states&#8230; so far so good! </span>Then we&#8217;re walking again. Hmm. <code>"walking2"</code>? Sure, why not. Next it&#8217;s back to waiting. (<em>sigh</em>) <code>"waiting2"</code> it is.</p>
<p>Finally we come to the really awkward stuff. What do we call &#8220;updating x, choosing a fill color, and emptying an array&#8221;? We may end up making little functions, such as <code>Start</code>, <code>Walk</code>, and <code>Wait</code> in the last example, rather than inline <span style="line-height: 1.5;">code, just to reduce some of this visual congestion. The naming problem strikes again! This also reduces code locality: we need to go hunting to find </span><span style="line-height: 1.5;">those functions and see what&#8217;s in them. Furthermore, if we have several such functions, we&#8217;ve really only shifted the clutter around.</span></p>
<p>It would be better if the last snippet could instead be written:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e3cd079955235" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Start()
Walk()
Wait()
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e3cd079955235-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3cd079955235-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e3cd079955235-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3cd079955235-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e3cd079955235-1"><span class="crayon-e">Start</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3cd079955235-2"><span class="crayon-e">Walk</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3cd079955235-3"><span class="crayon-e">Wait</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3cd079955235-4">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>It should be obvious where this is headed. That style falls out quite naturally from moving our logic into a coroutine.</p>
<p>As a broader example, we might write the high-level game loop for some sort of sports title:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e3d5491312792" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
CoroPerformWithDelay( 30, function()
    OpeningSequence()

    for period = 1, NumberOfPeriods do
        WaitMS( 15000, PanCamera )  -- Show audience, stadium, etc.

        StartTheClock()

        repeat
            Play()  -- Basically, whatever happens between "serving the ball" and blowing the whistle.
        until OutOfTime()

        if period &lt; NumberOfPeriods then
            BetweenPeriodsSequence()  -- National anthem, hear from coaches, etc.
        else
            EndingSequence()  -- Fireworks!
        end
    end
end)
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e3d5491312792-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3d5491312792-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e3d5491312792-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3d5491312792-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e3d5491312792-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3d5491312792-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e3d5491312792-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3d5491312792-8">8</div><div class="crayon-num" data-line="crayon-5f8df2513e3d5491312792-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3d5491312792-10">10</div><div class="crayon-num" data-line="crayon-5f8df2513e3d5491312792-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3d5491312792-12">12</div><div class="crayon-num" data-line="crayon-5f8df2513e3d5491312792-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3d5491312792-14">14</div><div class="crayon-num" data-line="crayon-5f8df2513e3d5491312792-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3d5491312792-16">16</div><div class="crayon-num" data-line="crayon-5f8df2513e3d5491312792-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3d5491312792-18">18</div><div class="crayon-num" data-line="crayon-5f8df2513e3d5491312792-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3d5491312792-20">20</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e3d5491312792-1"><span class="crayon-e">CoroPerformWithDelay</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3d5491312792-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">OpeningSequence</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3d5491312792-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3d5491312792-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">period</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">NumberOfPeriods </span><span class="crayon-st">do</span></div><div class="crayon-line" id="crayon-5f8df2513e3d5491312792-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">WaitMS</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">15000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">PanCamera</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- Show audience, stadium, etc.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3d5491312792-6">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e3d5491312792-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">StartTheClock</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3d5491312792-8">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e3d5491312792-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">repeat</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3d5491312792-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">Play</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- Basically, whatever happens between "serving the ball" and blowing the whistle.</span></div><div class="crayon-line" id="crayon-5f8df2513e3d5491312792-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">until</span><span class="crayon-h"> </span><span class="crayon-e">OutOfTime</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3d5491312792-12">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e3d5491312792-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">period</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-e">NumberOfPeriods </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3d5491312792-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">BetweenPeriodsSequence</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- National anthem, hear from coaches, etc.</span></div><div class="crayon-line" id="crayon-5f8df2513e3d5491312792-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3d5491312792-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">EndingSequence</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- Fireworks!</span></div><div class="crayon-line" id="crayon-5f8df2513e3d5491312792-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3d5491312792-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df2513e3d5491312792-19"><span class="crayon-st">end</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3d5491312792-20">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0020 seconds] -->
<p></p>
<h3><a name="sm2"></a>State Machines, Take Two</h3>
<p>Now, we may <b>want</b> &#8220;conventional&#8221; state machines. Character AI, for instance, typically consists of several independent behaviors, each of them fairly significant, which the character cycles through. Thankfully, we can accommodate this as well.</p>
<p>Consider a very simple AI, for one of the players in our sports title:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e3da301500900" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
local States = {}

function States.Defensive()
    repeat
        GetCloserTo( Ball )

        if CloseTo( Ball ) then
            TryToGrabIt()
        end
    until GainedPossession()

    return States.Offensive()
end

function States.Offensive()
    repeat
        GetCloserTo( Goal )

        if CloseTo(Goal) then
            TryToScore()
        end
    until LostPossession()

    return States.Defensive()
end

local player = CoroPerformWithDelay( 30, States.Defensive )
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e3da301500900-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3da301500900-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e3da301500900-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3da301500900-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e3da301500900-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3da301500900-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e3da301500900-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3da301500900-8">8</div><div class="crayon-num" data-line="crayon-5f8df2513e3da301500900-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3da301500900-10">10</div><div class="crayon-num" data-line="crayon-5f8df2513e3da301500900-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3da301500900-12">12</div><div class="crayon-num" data-line="crayon-5f8df2513e3da301500900-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3da301500900-14">14</div><div class="crayon-num" data-line="crayon-5f8df2513e3da301500900-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3da301500900-16">16</div><div class="crayon-num" data-line="crayon-5f8df2513e3da301500900-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3da301500900-18">18</div><div class="crayon-num" data-line="crayon-5f8df2513e3da301500900-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3da301500900-20">20</div><div class="crayon-num" data-line="crayon-5f8df2513e3da301500900-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3da301500900-22">22</div><div class="crayon-num" data-line="crayon-5f8df2513e3da301500900-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3da301500900-24">24</div><div class="crayon-num" data-line="crayon-5f8df2513e3da301500900-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3da301500900-26">26</div><div class="crayon-num" data-line="crayon-5f8df2513e3da301500900-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3da301500900-28">28</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e3da301500900-1"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">States</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3da301500900-2">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e3da301500900-3"><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-v">States</span><span class="crayon-sy">.</span><span class="crayon-e">Defensive</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3da301500900-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">repeat</span></div><div class="crayon-line" id="crayon-5f8df2513e3da301500900-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">GetCloserTo</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">Ball</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3da301500900-6">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e3da301500900-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">CloseTo</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">Ball</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3da301500900-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">TryToGrabIt</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3da301500900-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3da301500900-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">until</span><span class="crayon-h"> </span><span class="crayon-e">GainedPossession</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3da301500900-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3da301500900-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">States</span><span class="crayon-sy">.</span><span class="crayon-e">Offensive</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3da301500900-13"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3da301500900-14">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e3da301500900-15"><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-v">States</span><span class="crayon-sy">.</span><span class="crayon-e">Offensive</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3da301500900-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">repeat</span></div><div class="crayon-line" id="crayon-5f8df2513e3da301500900-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">GetCloserTo</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">Goal</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3da301500900-18">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e3da301500900-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">CloseTo</span><span class="crayon-sy">(</span><span class="crayon-v">Goal</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3da301500900-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">TryToScore</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3da301500900-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3da301500900-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">until</span><span class="crayon-h"> </span><span class="crayon-e">LostPossession</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3da301500900-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3da301500900-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">States</span><span class="crayon-sy">.</span><span class="crayon-e">Defensive</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3da301500900-25"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3da301500900-26">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e3da301500900-27"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">player</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">CoroPerformWithDelay</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">States</span><span class="crayon-sy">.</span><span class="crayon-i">Defensive</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3da301500900-28">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0027 seconds] -->
<p>The player begins as the defender. The defensive strategy consists entirely of getting the ball away from the opponent (it isn&#8217;t a very sophisticated sport). With that objective in mind, the player tries to get in range of, and steal, the ball. If this succeeds, or the opponent lost the ball in some other way, the player has command of the ball and goes on the offensive.</p>
<p>Offense is a similar affair. The player tries to draw near the goal and score a point. If the opponent regains possession (ball was grabbed, the player scored, etc.), it&#8217;s back to defense.</p>
<p>Switching states is a simple matter of calling the appropriate function. I tend to lump all my states into a table, when doing this sort of thing. There usually isn&#8217;t any obviously correct order for the states, so forward declarations end up being too much hassle, especially as the switches become ever more tangled.</p>
<p>The <code>return state()</code> syntax is key. This is what is known as a <a href=http://www.lua.org/manual/5.1/manual.html?#2.5.8 target="_blank">tail call</a>. Whenever we call a function normally, Lua must leave behind some information so that, once the function finishes, execution can pick up where it left off. The trouble is, when we switch states, we have no intention of coming back! While we <b>can</b> hop around using the standard <code>state()</code> form, eventually so much of this bookkeeping piles up that it overflows the stack, and we crash. A tail call, on the other hand, in effect declares &#8220;I&#8217;m done here&#8221;. Lua honors this (by doing nothing) and the problem goes away.</p>
<p>Between the game loop and the player AI, we have two coroutines running. Nothing stops us from going further, say by making two full teams&#8217; worth of player AI. In the end, it comes down to what works.</p>
<h3><a name="long"></a>Long-Running Processes</h3>
<p>Timer-backed coroutines are great when it comes to events that span time. As it turns out, they&#8217;re perfect for tackling another class of problems, too: actions that just plain take a while!</p>
<p>&#8220;A while&#8221; could mean on the order of a minute or two, yet even a 50-millisecond operation will make our frame rate hiccup, if it doesn&#8217;t allow the rest of the program a chance to act.</p>
<p>A good example of this is loading a game level. We might find ourselves performing some quite time-consuming steps, such as unzipping large files or downloading images. The number of resources may also be significant. Each one takes time, and it adds up.</p>
<p>There&#8217;s not always much we can do about the predicament itself. What we probably <b>can</b> do is take some action between, or during, these many operations. If the long-running process is embedded in a coroutine, we can call <code>coroutine.yield</code> to temporarily cede control.</p>
<p>Yielding between might look like so:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e3e2495989829" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
DoHeavywork()

coroutine.yield()

DoMoreHeavyWork()
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e3e2495989829-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3e2495989829-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e3e2495989829-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3e2495989829-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e3e2495989829-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3e2495989829-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e3e2495989829-1"><span class="crayon-e">DoHeavywork</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3e2495989829-2">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e3e2495989829-3"><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">yield</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3e2495989829-4">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e3e2495989829-5"><span class="crayon-e">DoMoreHeavyWork</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3e2495989829-6">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>And during:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e3e9756784585" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">

local function DoHeavyWork()
    for i = 1, NumberOfThingsToProcess do
        DoSomeWork(i)

        coroutine.yield()
    end
end
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e3e9756784585-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3e9756784585-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e3e9756784585-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3e9756784585-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e3e9756784585-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3e9756784585-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e3e9756784585-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3e9756784585-8">8</div><div class="crayon-num" data-line="crayon-5f8df2513e3e9756784585-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e3e9756784585-1">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3e9756784585-2"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">DoHeavyWork</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3e9756784585-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">NumberOfThingsToProcess </span><span class="crayon-st">do</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3e9756784585-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">DoSomeWork</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3e9756784585-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3e9756784585-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">yield</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3e9756784585-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3e9756784585-8"><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df2513e3e9756784585-9">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>The yields put the action to sleep now and then, giving time back to Corona.</p>
<p>As with any long-running activity in Corona, it&#8217;s good practice to have something visual going on, be it the activity indicator, or a progress view, or even a simple animation. For particularly lengthy loads, we might even add a little mini-game as an overlay, to pass the time.</p>
<h3><a name="yieldutil"></a>Some Yield Helpers</h3>
<p>A shortcoming of using <code>coroutine.yield</code> directly is that, when we do yield, we&#8217;re done for that frame, even though there might still be time left for work. We can mitigate this somewhat by parametrizing the yield operation. That way, we can experiment with different strategies of staggering the yields, until we settle on a winner. The last snippet then becomes:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e3ee602096414" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
local function DoHeavyWork( yfunc )
    for i = 1, NumberOfThingsToProcess do
        DoSomeWork(i)

        yfunc()
    end
end
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e3ee602096414-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3ee602096414-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e3ee602096414-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3ee602096414-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e3ee602096414-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3ee602096414-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e3ee602096414-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3ee602096414-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e3ee602096414-1"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">DoHeavyWork</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">yfunc</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3ee602096414-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">NumberOfThingsToProcess </span><span class="crayon-st">do</span></div><div class="crayon-line" id="crayon-5f8df2513e3ee602096414-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">DoSomeWork</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3ee602096414-4">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e3ee602096414-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">yfunc</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3ee602096414-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df2513e3ee602096414-7"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3ee602096414-8">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>As an example, we might use the following routine. When called, it tries to yield, but only actually does so if a certain amount of time has elapsed:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e3f3749234453" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
do
    local since

    function YieldOnTimeout()
        local now = system.getTimer()

        if not since then
            since = now  -- On first try, just sync.
        elseif now - since &gt;= 15 then  -- 15 milliseconds, but could be customized or an argument.
            since = now

            coroutine.yield()
        end
    end
end
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e3f3749234453-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3f3749234453-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e3f3749234453-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3f3749234453-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e3f3749234453-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3f3749234453-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e3f3749234453-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3f3749234453-8">8</div><div class="crayon-num" data-line="crayon-5f8df2513e3f3749234453-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3f3749234453-10">10</div><div class="crayon-num" data-line="crayon-5f8df2513e3f3749234453-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3f3749234453-12">12</div><div class="crayon-num" data-line="crayon-5f8df2513e3f3749234453-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3f3749234453-14">14</div><div class="crayon-num" data-line="crayon-5f8df2513e3f3749234453-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3f3749234453-16">16</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e3f3749234453-1"><span class="crayon-st">do</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3f3749234453-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-e">since</span></div><div class="crayon-line" id="crayon-5f8df2513e3f3749234453-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3f3749234453-4"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">YieldOnTimeout</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3f3749234453-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">now</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">system</span><span class="crayon-sy">.</span><span class="crayon-e">getTimer</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3f3749234453-6">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e3f3749234453-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">since </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3f3749234453-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">since</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">now</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- On first try, just sync.</span></div><div class="crayon-line" id="crayon-5f8df2513e3f3749234453-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">elseif</span><span class="crayon-h"> </span><span class="crayon-v">now</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">since</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-h"> </span><span class="crayon-st">then</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- 15 milliseconds, but could be customized or an argument.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3f3749234453-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">since</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">now</span></div><div class="crayon-line" id="crayon-5f8df2513e3f3749234453-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3f3749234453-12"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">yield</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3f3749234453-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3f3749234453-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df2513e3f3749234453-15"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3f3749234453-16">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0017 seconds] -->
<p>(The <code>do</code>&#8211;<code>end</code> construction limits the scope of <code>since</code>, keeping it private to <code>YieldOnTimeout</code>.)</p>
<p>In use, it might look like:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e3f7664111331" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
    DoHeavyWork( YieldOnTimeout )
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e3f7664111331-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3f7664111331-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e3f7664111331-1"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">DoHeavyWork</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">YieldOnTimeout</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3f7664111331-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>This is no panacea, however. Sometimes we&#8217;ll get unlucky, say when there are only a couple milliseconds to spare and we run one more operation, which ends up taking five. To account for this, it may be best to underestimate the timeout.</p>
<p>Another possibility is to yield every few calls:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e3fb122166922" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
do
    local calls = 0

    function YieldEveryFewCalls()
        calls = calls + 1

        if calls == 4 then  -- Again, customizable and could be an argument.
            calls = 0

            coroutine.yield()
        end
    end
end
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e3fb122166922-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3fb122166922-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e3fb122166922-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3fb122166922-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e3fb122166922-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3fb122166922-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e3fb122166922-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3fb122166922-8">8</div><div class="crayon-num" data-line="crayon-5f8df2513e3fb122166922-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3fb122166922-10">10</div><div class="crayon-num" data-line="crayon-5f8df2513e3fb122166922-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3fb122166922-12">12</div><div class="crayon-num" data-line="crayon-5f8df2513e3fb122166922-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3fb122166922-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e3fb122166922-1"><span class="crayon-st">do</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3fb122166922-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">calls</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-5f8df2513e3fb122166922-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3fb122166922-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">YieldEveryFewCalls</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3fb122166922-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">calls</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">calls</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3fb122166922-6">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e3fb122166922-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">calls</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-st">then</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- Again, customizable and could be an argument.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3fb122166922-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">calls</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-5f8df2513e3fb122166922-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3fb122166922-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">yield</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e3fb122166922-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3fb122166922-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df2513e3fb122166922-13"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3fb122166922-14">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p>Yet another idea is to yield randomly, say 25% of the time:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e3ff248816839" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
function YieldOccasionally()
    if math.random( 100 ) &lt;= 25 then  -- Ditto.
        coroutine.yield()
    end
end
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e3ff248816839-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3ff248816839-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e3ff248816839-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3ff248816839-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e3ff248816839-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e3ff248816839-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e3ff248816839-1"><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">YieldOccasionally</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3ff248816839-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-h"> </span><span class="crayon-st">then</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- Ditto.</span></div><div class="crayon-line" id="crayon-5f8df2513e3ff248816839-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">yield</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3ff248816839-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df2513e3ff248816839-5"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e3ff248816839-6">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p></p>
<h3><a name="debug"></a>Coroutines as a Debugging Tool</h3>
<p>The <code>print()</code> statement is a hallmark of debugging, across a broad spectrum of programming languages. Sometimes this comes down to convenience, such as when it would take too much effort to configure a debugger, then place and watch breakpoints. On rare occasions, integrating a debugger may even <b>seem</b> to make the problem go away: an attack of the dreaded <a href=http://en.wikipedia.org/wiki/Heisenbug target="_blank">Heisenbug</a>!. A common strategy is to sprinkle <code>print()</code> statements around suspect points in the code, then compare the output with our expectations. If a message doesn&#8217;t appear, either the code in question was never visited or the program crashed along the way. As we narrow down the scope of the problem, we can remove instances of <code>print()</code> that are no longer necessary.</p>
<p>One concern in normal code is that most (or all) of these <code>print()</code> statements will execute, so we wind up with one long burst of messages. We might also need some sense of <b>when</b> a piece of code was executed, and what our program looked like at the time. It&#8217;s hard to guess where the process broke down.</p>
<p>Enter coroutines. If we can roughly isolate the troublesome code, it can be temporarily embedded in a coroutine. Then, by following each <code>print()</code> with a yield, we&#8217;re able to inspect the state of the world at that moment. Consider the following:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e408927195681" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
DoSomething()

-- We're curious about the snippet starting here...

local red = display.newRect( 100, 100, 30, 70 )

red:setFillColor( 1, 0, 0 )

print( "Added red rect" )

local blue = display.newCircle( 150, 30, 10 )

blue:setFillColor( 0, 0, 1 )

print( "Added blue circle" )

local green = display.newRect( 200, 100, 60, 20 )

green:setFillColor( 0, 1, 0 )

print( "Added green rect" )

-- ...and ending here.

DoSomethingElse()
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e408927195681-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e408927195681-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e408927195681-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e408927195681-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e408927195681-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e408927195681-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e408927195681-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e408927195681-8">8</div><div class="crayon-num" data-line="crayon-5f8df2513e408927195681-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e408927195681-10">10</div><div class="crayon-num" data-line="crayon-5f8df2513e408927195681-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e408927195681-12">12</div><div class="crayon-num" data-line="crayon-5f8df2513e408927195681-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e408927195681-14">14</div><div class="crayon-num" data-line="crayon-5f8df2513e408927195681-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e408927195681-16">16</div><div class="crayon-num" data-line="crayon-5f8df2513e408927195681-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e408927195681-18">18</div><div class="crayon-num" data-line="crayon-5f8df2513e408927195681-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e408927195681-20">20</div><div class="crayon-num" data-line="crayon-5f8df2513e408927195681-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e408927195681-22">22</div><div class="crayon-num" data-line="crayon-5f8df2513e408927195681-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e408927195681-24">24</div><div class="crayon-num" data-line="crayon-5f8df2513e408927195681-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e408927195681-26">26</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e408927195681-1"><span class="crayon-e">DoSomething</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e408927195681-2">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e408927195681-3"><span class="crayon-c">-- We're curious about the snippet starting here...</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e408927195681-4">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e408927195681-5"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">red</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">display</span><span class="crayon-sy">.</span><span class="crayon-e">newRect</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e408927195681-6">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e408927195681-7"><span class="crayon-v">red</span><span class="crayon-o">:</span><span class="crayon-e">setFillColor</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e408927195681-8">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e408927195681-9"><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"Added red rect"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e408927195681-10">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e408927195681-11"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">blue</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">display</span><span class="crayon-sy">.</span><span class="crayon-e">newCircle</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">150</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e408927195681-12">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e408927195681-13"><span class="crayon-v">blue</span><span class="crayon-o">:</span><span class="crayon-e">setFillColor</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e408927195681-14">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e408927195681-15"><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"Added blue circle"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e408927195681-16">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e408927195681-17"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">green</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">display</span><span class="crayon-sy">.</span><span class="crayon-e">newRect</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e408927195681-18">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e408927195681-19"><span class="crayon-v">green</span><span class="crayon-o">:</span><span class="crayon-e">setFillColor</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e408927195681-20">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e408927195681-21"><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"Added green rect"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e408927195681-22">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e408927195681-23"><span class="crayon-c">-- ...and ending here.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e408927195681-24">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e408927195681-25"><span class="crayon-e">DoSomethingElse</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e408927195681-26">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0029 seconds] -->
<p>All of our messages and display objects show up at once.</p>
<p>With coroutines:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e40d049644078" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
DoSomething()

-- Start of temporary debugging code...
local function print2( ... )
    print( ... )
    coroutine.yield()
end

CoroPerformWithDelay( 2000, function()  -- Wait 2 seconds after each print statement.
-- ...end of temporary debugging code

local red = display.newRect( 100, 100, 30, 70 )

red:setFillColor( 1, 0, 0 )

print2( "Added red rect" )

local blue = display.newCircle( 150, 30, 10 )

blue:setFillColor( 0, 0, 1 )

print2( "Added blue circle" )

local green = display.newRect( 200, 100, 60, 20 )

green:setFillColor( 0, 1, 0 )

print2( "Added green rect" )

-- Start of temporary debugging code...
end )
-- ...end of temporary debugging code

DoSomethingElse()
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e40d049644078-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e40d049644078-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e40d049644078-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e40d049644078-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e40d049644078-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e40d049644078-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e40d049644078-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e40d049644078-8">8</div><div class="crayon-num" data-line="crayon-5f8df2513e40d049644078-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e40d049644078-10">10</div><div class="crayon-num" data-line="crayon-5f8df2513e40d049644078-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e40d049644078-12">12</div><div class="crayon-num" data-line="crayon-5f8df2513e40d049644078-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e40d049644078-14">14</div><div class="crayon-num" data-line="crayon-5f8df2513e40d049644078-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e40d049644078-16">16</div><div class="crayon-num" data-line="crayon-5f8df2513e40d049644078-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e40d049644078-18">18</div><div class="crayon-num" data-line="crayon-5f8df2513e40d049644078-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e40d049644078-20">20</div><div class="crayon-num" data-line="crayon-5f8df2513e40d049644078-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e40d049644078-22">22</div><div class="crayon-num" data-line="crayon-5f8df2513e40d049644078-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e40d049644078-24">24</div><div class="crayon-num" data-line="crayon-5f8df2513e40d049644078-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e40d049644078-26">26</div><div class="crayon-num" data-line="crayon-5f8df2513e40d049644078-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e40d049644078-28">28</div><div class="crayon-num" data-line="crayon-5f8df2513e40d049644078-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e40d049644078-30">30</div><div class="crayon-num" data-line="crayon-5f8df2513e40d049644078-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e40d049644078-32">32</div><div class="crayon-num" data-line="crayon-5f8df2513e40d049644078-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e40d049644078-34">34</div><div class="crayon-num" data-line="crayon-5f8df2513e40d049644078-35">35</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e40d049644078-1"><span class="crayon-e">DoSomething</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e40d049644078-2">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e40d049644078-3"><span class="crayon-c">-- Start of temporary debugging code...</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e40d049644078-4"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">print2</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e40d049644078-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e40d049644078-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">yield</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e40d049644078-7"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e40d049644078-8">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e40d049644078-9"><span class="crayon-e">CoroPerformWithDelay</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">2000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- Wait 2 seconds after each print statement.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e40d049644078-10"><span class="crayon-c">-- ...end of temporary debugging code</span></div><div class="crayon-line" id="crayon-5f8df2513e40d049644078-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e40d049644078-12"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">red</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">display</span><span class="crayon-sy">.</span><span class="crayon-e">newRect</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e40d049644078-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e40d049644078-14"><span class="crayon-v">red</span><span class="crayon-o">:</span><span class="crayon-e">setFillColor</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e40d049644078-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e40d049644078-16"><span class="crayon-e">print2</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"Added red rect"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e40d049644078-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e40d049644078-18"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">blue</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">display</span><span class="crayon-sy">.</span><span class="crayon-e">newCircle</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">150</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e40d049644078-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e40d049644078-20"><span class="crayon-v">blue</span><span class="crayon-o">:</span><span class="crayon-e">setFillColor</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e40d049644078-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e40d049644078-22"><span class="crayon-e">print2</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"Added blue circle"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e40d049644078-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e40d049644078-24"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">green</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">display</span><span class="crayon-sy">.</span><span class="crayon-e">newRect</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e40d049644078-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e40d049644078-26"><span class="crayon-v">green</span><span class="crayon-o">:</span><span class="crayon-e">setFillColor</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e40d049644078-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e40d049644078-28"><span class="crayon-e">print2</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"Added green rect"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e40d049644078-29">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e40d049644078-30"><span class="crayon-c">-- Start of temporary debugging code...</span></div><div class="crayon-line" id="crayon-5f8df2513e40d049644078-31"><span class="crayon-st">end</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e40d049644078-32"><span class="crayon-c">-- ...end of temporary debugging code</span></div><div class="crayon-line" id="crayon-5f8df2513e40d049644078-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e40d049644078-34"><span class="crayon-e">DoSomethingElse</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e40d049644078-35">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0039 seconds] -->
<p>By using coroutines, we get to watch the action unfold. In the example above, we now have a couple seconds to review the state of affairs after each <code>print2</code>, without significantly changing the code shape. If we only need to do some visual inspection, we can even just use <code>coroutine.yield</code> directly.</p>
<p>I employed this technique quite recently, in order to test some <a href=http://code.coronalabs.com/code/layout-helpers target="_blank">layout routines</a>. Since these primarily involve display objects, <code>print()</code> only got me so far. Many of the operations consist of one object being positioned relative to another, so if something went wrong in the middle, the whole layout fell apart. By viewing the steps one at a time, I was able to pinpoint when and where things went awry.</p>
<p>Bear in mind that this method does slightly alter the program flow, on account of the yields. Therefore, we must include this in our notion of isolation. In the previous example, for instance, <code>DoSomethingElse</code> shouldn&#8217;t depend on what happens inside the wrapped-up code.</p>
<h3><a name="touch"></a>The Magic Touch</h3>
<p>A timer won&#8217;t always be the best fit for debugging. With a short delay, the steps may go by too soon. Much longer, and we might instead grow weary waiting, especially if the problem tends to show up quite late.</p>
<p>Fortunately, time isn&#8217;t the only way to drive a coroutine. We hinted earlier at using wrapped coroutines as event listeners. <code>"touch"</code> listeners are one such choice, and in fact give us direct control: on each touch, we resume the wrapped-up code.</p>
<p>With Corona, it&#8217;s easy to create a dummy display object and assign it such a listener. Then, instead of waiting around for the timer, we just click rapidly through any steps we want to ignore. Once we find something suspicious, we can take our time.</p>
<p>The previous example then becomes:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e414992902317" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
DoSomething()

-- Start of temporary debugging code...
local function print2( ... )
    print( ... )
    coroutine.yield()
end

local co = coroutine.create( function()  -- Wait for next touch event.
-- ...end of temporary debugging code

local red = display.newRect( 100, 100, 30, 70 )

red:setFillColor( 1, 0, 0 )

print2( "Added red rect" )

local blue = display.newCircle( 150, 30, 10 )

blue:setFillColor( 0, 0, 1 )

print2( "Added blue circle" )

local green = display.newRect( 200, 100, 60, 20 )

green:setFillColor( 0, 1, 0 )

print2( "Added green rect" )

-- Start of temporary debugging code...
end )

local button = display.newCircle( 20, 20, 10 )

button:setFillColor( .7 )
button:addEventListener( "touch", function( event )
    if event.phase == "began" then
        local ok, err = coroutine.resume( co )

        if not ok then
            print( err )  -- What went wrong?
        end
    end

    return true
end)
-- ...end of temporary debugging code --

DoSomethingElse()
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-8">8</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-10">10</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-12">12</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-14">14</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-16">16</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-18">18</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-20">20</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-22">22</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-24">24</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-26">26</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-28">28</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-30">30</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-32">32</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-34">34</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-36">36</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-38">38</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-40">40</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-42">42</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-44">44</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-46">46</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-48">48</div><div class="crayon-num" data-line="crayon-5f8df2513e414992902317-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e414992902317-50">50</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e414992902317-1"><span class="crayon-e">DoSomething</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-2">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e414992902317-3"><span class="crayon-c">-- Start of temporary debugging code...</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-4"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-h"> </span><span class="crayon-e">print2</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e414992902317-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">yield</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e414992902317-7"><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-8">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e414992902317-9"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">co</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">create</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- Wait for next touch event.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-10"><span class="crayon-c">-- ...end of temporary debugging code</span></div><div class="crayon-line" id="crayon-5f8df2513e414992902317-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-12"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">red</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">display</span><span class="crayon-sy">.</span><span class="crayon-e">newRect</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e414992902317-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-14"><span class="crayon-v">red</span><span class="crayon-o">:</span><span class="crayon-e">setFillColor</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e414992902317-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-16"><span class="crayon-e">print2</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"Added red rect"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e414992902317-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-18"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">blue</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">display</span><span class="crayon-sy">.</span><span class="crayon-e">newCircle</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">150</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e414992902317-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-20"><span class="crayon-v">blue</span><span class="crayon-o">:</span><span class="crayon-e">setFillColor</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e414992902317-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-22"><span class="crayon-e">print2</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"Added blue circle"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e414992902317-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-24"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">green</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">display</span><span class="crayon-sy">.</span><span class="crayon-e">newRect</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e414992902317-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-26"><span class="crayon-v">green</span><span class="crayon-o">:</span><span class="crayon-e">setFillColor</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e414992902317-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-28"><span class="crayon-e">print2</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"Added green rect"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e414992902317-29">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-30"><span class="crayon-c">-- Start of temporary debugging code...</span></div><div class="crayon-line" id="crayon-5f8df2513e414992902317-31"><span class="crayon-st">end</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-32">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e414992902317-33"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">button</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">display</span><span class="crayon-sy">.</span><span class="crayon-e">newCircle</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-34">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e414992902317-35"><span class="crayon-v">button</span><span class="crayon-o">:</span><span class="crayon-e">setFillColor</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-cn">7</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-36"><span class="crayon-v">button</span><span class="crayon-o">:</span><span class="crayon-e">addEventListener</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"touch"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">event</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e414992902317-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">event</span><span class="crayon-sy">.</span><span class="crayon-v">phase</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"began"</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">ok</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">err</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">resume</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">co</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e414992902317-39">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">ok </span><span class="crayon-st">then</span></div><div class="crayon-line" id="crayon-5f8df2513e414992902317-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">err</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- What went wrong?</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df2513e414992902317-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-44">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e414992902317-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-r">true</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-46"><span class="crayon-st">end</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5f8df2513e414992902317-47"><span class="crayon-c">-- ...end of temporary debugging code --</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-48">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e414992902317-49"><span class="crayon-e">DoSomethingElse</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e414992902317-50">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0061 seconds] -->
<p>After one click, we see:</p>
<p><a href=/wordpress/wp-content/uploads/2015/02/debug1.jpg><img class="size-full wp-image-61378 aligncenter" src=/wordpress/wp-content/uploads/2015/02/debug1.jpg alt="debug1" width="320" height="300" /></a></p>
<p><span style="line-height: 1.5;">(The gray circle is our &#8220;button&#8221;, the dummy display object.)</span></p>
<p>After another:</p>
<p><a href=/wordpress/wp-content/uploads/2015/02/debug2.jpg><img class="size-full wp-image-61379 aligncenter" src=/wordpress/wp-content/uploads/2015/02/debug2.jpg alt="debug2" width="320" height="300" /></a></p>
<p>Finally:</p>
<p><a href=/wordpress/wp-content/uploads/2015/02/debug3.jpg><img class="size-full wp-image-61380 aligncenter" src=/wordpress/wp-content/uploads/2015/02/debug3.jpg alt="debug3" width="320" height="300" /></a></p>
<p>This is actually a situation where <code>coroutine.create</code> and <code>coroutine.resume</code> are more appropriate. We don&#8217;t want <span style="line-height: 1.5;">to crash our program just because we clicked too many times and ran a dead coroutine. We also end up with a basic sandbox, where an error </span><span style="line-height: 1.5;">can occur without bringing down our whole program (the coroutine will then be dead, of course). If our code snippet was properly isolated, </span><span style="line-height: 1.5;">this should work just fine.</span></p>
<p>Once everything is good to go, we can remove all the &#8220;temporary debugging code&#8221; and move on.</p>
<h3><a name="gotchas"></a>Gotchas</h3>
<p>There are a few specific cases where coroutines break, owing mainly to some quirks in the interaction between Lua and C. Thanks to some redesign in the codebase, these have been fixed in Lua 5.2+. Corona is based on 5.1, though, so for the time being these issues are a fact of life.</p>
<p>Two such problem areas involve <a href=http://www.lua.org/manual/5.1/manual.html?#pdf-pcall target="_blank">protected calls</a> and <a href=http://www.lua.org/manual/5.1/manual.html?#2.8 target="_blank">metamethods</a>, as Peter &#8220;Corsix&#8221; Cawley <a href=http://www.corsix.org/content/look-lua-52-work3 target="_blank">points out on his blog</a> (see point #2). Note that the article itself mainly concerns 5.2, whereas we only care about the 5.1-related misbehavior. There have been some attempts to deal with protected calls, such as <a href=https://github.com/keplerproject/coxpcall target="_blank">Coxpcall</a>, created expressly to allow them in <a href=https://github.com/keplerproject/copas target="_blank">Copas</a> (a library for building TCP/IP servers atop coroutines).</p>
<p><a href=http://www.lua.org/manual/5.1/manual.html?#2.4.5 target="_blank">Iterators</a> are the other problem spot:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e420060397907" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
local wrapped = coroutine.wrap( function()
    for _ in function()  -- An (obviously not useful!) iterator body.
        print( "Before" )

        coroutine.yield()  -- In 5.1, gives error: attempt to yield across metamethod / C-call boundary.

        print( "After" )
    end do
        print( "Loop!" )
    end
end )

wrapped()
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e420060397907-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e420060397907-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e420060397907-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e420060397907-4">4</div><div class="crayon-num" data-line="crayon-5f8df2513e420060397907-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e420060397907-6">6</div><div class="crayon-num" data-line="crayon-5f8df2513e420060397907-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e420060397907-8">8</div><div class="crayon-num" data-line="crayon-5f8df2513e420060397907-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e420060397907-10">10</div><div class="crayon-num" data-line="crayon-5f8df2513e420060397907-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e420060397907-12">12</div><div class="crayon-num" data-line="crayon-5f8df2513e420060397907-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e420060397907-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e420060397907-1"><span class="crayon-r">local</span><span class="crayon-h"> </span><span class="crayon-v">wrapped</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">wrap</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e420060397907-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-r">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- An (obviously not useful!) iterator body.</span></div><div class="crayon-line" id="crayon-5f8df2513e420060397907-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"Before"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e420060397907-4">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e420060397907-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coroutine</span><span class="crayon-sy">.</span><span class="crayon-e">yield</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">-- In 5.1, gives error: attempt to yield across metamethod / C-call boundary.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e420060397907-6">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e420060397907-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"After"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e420060397907-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span><span class="crayon-h"> </span><span class="crayon-st">do</span></div><div class="crayon-line" id="crayon-5f8df2513e420060397907-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">print</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">"Loop!"</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e420060397907-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">end</span></div><div class="crayon-line" id="crayon-5f8df2513e420060397907-11"><span class="crayon-st">end</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e420060397907-12">&nbsp;</div><div class="crayon-line" id="crayon-5f8df2513e420060397907-13"><span class="crayon-e">wrapped</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e420060397907-14">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0016 seconds] -->
<p>This is a rather lame iterator (it doesn&#8217;t even attempt to iterate!), but it demonstrates the issue. Attempting to yield directly from the so-called iterator function results in an error, in Lua 5.1. We see the message <b>&#8220;Before&#8221;</b>, and then our program goes down in flames. Note that this is <b>not</b> the same as <a href=http://www.lua.org/pil/9.3.html target="_blank">using coroutines as iterators</a> (an incredibly useful feature but, alas, an entire topic of its own!).</p>
<p>Thankfully these all tend to be rare situations, but it&#8217;s good to be aware of them.</p>
<h3><a name="saving"></a>Saving</h3>
<p>The final gotcha comes from a design perspective. Being able to yield offers us great flexibility, but the flip side is that we do actually need to traverse the coroutine body to arrive at a given point in our code, with all of our local variables and program state in order. We can&#8217;t just jump to somewhere in the middle, in general. This presents a problem if the application must be able to save and later restore itself exactly where it left off. This isn&#8217;t insurmountable, but does need to be accounted for early on. It will almost certainly be difficult, and probably not worth the hassle.</p>
<p>If the application only needs to be saved every now and then (say between levels or at checkpoints, in a game), or has some leeway regarding what gets restored, this is a much smaller issue.</p>
<h3><a name="examples"></a>Examples</h3>
<p>Most of the code in this article has been adapted from the samples repository <a href=https://github.com/ggcrunchy/samples/tree/master/coroutines target="_blank">found here</a>. It can be downloaded from <a href=https://github.com/ggcrunchy/samples/archive/master.zip target="_blank">here</a>. These samples were made to be shown during a <a href=/blog/coronageek/corona-geek-122/ target="_blank">Corona Geek hangout</a>, so I wrote in a <span style="line-height: 1.5;">style which allows entire segments of the program to be turned on and off quickly. In particular, code gets blocked in </span><a style="line-height: 1.5;" href=http://www.lua.org/pil/1.3.html target="_blank">long comments</a><span style="line-height: 1.5;">. Doing so lets us start with a commented-out section:</span></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e42b537529770" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
--[[
DoSomething() -- Commented out, does not run.
--]]
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e42b537529770-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e42b537529770-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e42b537529770-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e42b537529770-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e42b537529770-1"><span class="crayon-c">--[[</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e42b537529770-2"><span class="crayon-c">DoSomething() -- Commented out, does not run.</span></div><div class="crayon-line" id="crayon-5f8df2513e42b537529770-3"><span class="crayon-c">--]]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e42b537529770-4">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>We can then enable all its code at once, simply by adding another hyphen at the beginning of the comment:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5f8df2513e430869470389" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Lua</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
---[[
DoSomething() -- No longer commented, will run.
--]]
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5f8df2513e430869470389-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e430869470389-2">2</div><div class="crayon-num" data-line="crayon-5f8df2513e430869470389-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5f8df2513e430869470389-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5f8df2513e430869470389-1"><span class="crayon-c">---[[</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e430869470389-2"><span class="crayon-e">DoSomething</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c">-- No longer commented, will run.</span></div><div class="crayon-line" id="crayon-5f8df2513e430869470389-3"><span class="crayon-c">--]]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5f8df2513e430869470389-4">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>To disable it once more, just remove the hyphen. I used this blocking method in <code>main.lua</code>, to <code>require()</code> each example, as well as within the modules themselves.</p>
<p>Also, in order to reduce switches between the simulator and console while recording, I overrode <code>print()</code> in <code>main.lua</code>, such that messages show up on the screen (as text objects) rather than the console. To disable this, simply remove or comment out the assignment to <code>print()</code>.</p>
<h3><a name="summary"></a>In Summary</h3>
<p>Coroutines are a truly powerful feature of Lua which, when combined with such mechanisms as Corona&#8217;s timers and event listeners, offer us a novel and useful approach to a whole host of difficult problems. We&#8217;ve only scratched the surface. <a href=http://www.lua.org/pil/9.html target="_blank">Chapter 9</a> of <b>Programming in Lua</b> covers several topics only <span style="line-height: 1.5;">touched on here. Explore, and have fun!</span></p>
<hr />
<p><a name="note1"></a><a href="#from_note1">[1]</a> A coroutine <b>is</b> a thread. The reverse is also true, with one very important exception: the main thread. This is the &#8220;normal&#8221; part of the program, where our code runs when it&#8217;s not inside a coroutine.</p>
<p><a name="note2"></a><a href="#from_note2">[2]</a> Typically, but not always. We could, for instance, assign the same wrapper to several listeners. Then, as these fire off piecemeal, the coroutine is gradually driven forward.</p>
<p>Another use case is to abort complex code. We might find ourselves in the middle of some heavy operation, ten function calls deep, when we realize we just can&#8217;t deal with it. It&#8217;s easy enough to <code>return</code> out of one function. Getting out of nine more is a different story! On the other hand, if this is all inside a coroutine, we can just yield. Suddenly we&#8217;re back in the <a href="#note1">main thread</a>, and can just throw the coroutine away. Another way to achieve this is to <code>error()</code> out, although this seems a bit impolite if we don&#8217;t actually have an error.</p>
<p>As the saying goes, &#8220;It&#8217;s better to ask forgiveness than permission.&#8221; Essentially, if it&#8217;s too much trouble to figure out up front whether an operation has even a chance of success, the best idea might be to just go for it. When we combine this approach with a set of choices, we arrive at a technique called backtracking, which can be summed up in another expression, &#8220;If at first you don&#8217;t succeed, try again.&#8221;</p>
<p>We might want to do normal yields in the coroutine. The ability to send data through <code>coroutine.yield</code> comes to our rescue here. At the outset, we reserve a couple values, <b>&#8220;success&#8221;</b> and <b>&#8220;failure&#8221;</b> perhaps, then resume until we run across one or the other.</p>
<p><a name="note3"></a><a href="#from_note3">[3]</a> Creating shadow tables reintroduces garbage, of course. However, coroutine-based timers will by and large be created far less frequently than garden variety timers, and be longer-running besides, so this is unlikely to be a problem in practice.</p>
<p><a name="note4"></a><a href="#from_note4">[4]</a> Another possibility, when yielding, is to pass control of the coroutine to a scheduler, which will later resume the coroutine once it&#8217;s ready to go. This has its pros and cons. Since we&#8217;re no longer spinning in a loop, it may prove more efficient, especially when we have several coroutines going. At the <span style="line-height: 1.5;">same time, if we still need to do updates, these costs just reappear in a different form, say as </span><code style="line-height: 1.5;">"enterFrame"</code><span style="line-height: 1.5;"> listener overhead.</span></p>
<p>Scheduler implementations abound. Some examples in pure Lua are <a href=https://github.com/xopxe/Lumen target="_blank">Lumen</a> and <a href=https://gist.github.com/Deco/1818054 target="_blank">this Gist</a>. Others, coded partially in C and C++, include <a href=https://github.com/lefcha/concurrentlua target="_blank">ConcurrentLua</a>, <a href=https://github.com/SierraWireless/luasched target="_blank">luasched</a>, and <a href=https://github.com/dmattp/nylon target="_blank">Nylon</a>. Unfortunately, we can&#8217;t simply drop these last few into a Corona codebase. That said, enough of their code <b>is</b> written in Lua to reward some study.</p>
<hr />
					</div>
				</div>
			</div>
		
			<div class="single_tags clearfix">
            <div class="tags_text">
				<h5>Tags:</h5>
				<a href="/blog/tags/coroutine/" rel="tag">coroutine</a>, <a href="/blog/tags/tutorial/" rel="tag">tutorial</a>			</div>
		</div>
	    		<div class="author_description">
		<div class="author_description_inner">
			<div class="image">
				<img alt="" src='/wordpress/wp-content/uploads/gravatar/5899ac6747b049ebcebca1d2013e3d47-s75.jpg' class="avatar avatar-75" width="75" height="75" />			</div>
			<div class="author_text_holder">
				<h5 class="author_name vcard author">
				<span class="fu">
				Brent Sorrentino			    </span>
				</h5>
				<span class="author_email">brent@coronalabs.com</span>
									<div class="author_text">
						<p>Brent Sorrentino is a full-time Developer Evangelist and technical writer who assists others with game development, code, and in overcoming other challenges to help them bring their app dreams to life.</p>
					</div>
							</div>
		</div>
	</div>
</article>										</div>
										
										<div class="comment_holder clearfix" id="comments">
<div class="comment_number"><div class="comment_number_inner"><h5>14 Comments</h5></div></div>
<div class="comments">

	<ul class="comment-list">
		
<li id="comment-4100">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/02bb337689f673f5bb6a1058ef23c82a-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name">Andrzej // Futuretro Studios</h5>
			<span class="comment_date">Posted at 03:27h, 11 February</span>
						<div class="text_holder" id="comment-4100">
				<p>Thank you Steven for this great tutorial. I&#8217;ve been looking for a way into coroutines to prevent frame stutter on heavy load operations and you&#8217;ve finally provided one I can understand and adapt to my own purposes. Brilliant stuff!</p>
			</div>
		</div>
	</div>                          
                
<ul class="children">

<li id="comment-4104">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/28a2de026f9abed6f3820ef245fbe286-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name"><a href='http://www.pinkeye.be/' rel='external nofollow' class='url'>Thomas Vanden Abeele</a></h5>
			<span class="comment_date">Posted at 09:45h, 11 February</span>
						<div class="text_holder" id="comment-4104">
				<p>Let me know if this fixes problems with heavy load operations &#8211; because as far as I know coroutines, in contrast to threading (which coroutines are not), will not help you fix this. But I&#8217;m hoping I&#8217;m wrong here!</p>
			</div>
		</div>
	</div>                          
                
<ul class="children">

<li id="comment-4105">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/aaaba44865e96be70caa15f6fc3078f7-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name"><a href='http://www.xibalbastudios.com/' rel='external nofollow' class='url'>Steven Johnson (Star Crunch)</a></h5>
			<span class="comment_date">Posted at 17:22h, 11 February</span>
						<div class="text_holder" id="comment-4105">
				<p>Thanks for all the kinds words, everybody!</p>
<p>Thomas, it&#8217;s too bad this was already queued up by the time you mentioned image loading in those other threads, or I might have  incorporated some of those caveats here.</p>
<p>In the end, it will depend upon whether the bottlenecks are fine-grained enough that you can accommodate them. A blocking API call like <b>newImageSheet</b> (and probably most, if not all, other resources) won&#8217;t be, unfortunately. If there&#8217;s ever some asynchronous or incremental way to load one, on the other hand, it could easily piggyback on the &#8220;long-running processes&#8221; approach.</p>
<p>That said, if the &#8220;heavy load operation&#8221; is just scores or hundreds of small- or medium-sized resources, then we&#8217;re getting somewhere!</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

<li id="comment-4101">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/28a2de026f9abed6f3820ef245fbe286-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name"><a href='http://www.pinkeye.be/' rel='external nofollow' class='url'>Thomas Vanden Abeele</a></h5>
			<span class="comment_date">Posted at 04:23h, 11 February</span>
						<div class="text_holder" id="comment-4101">
				<p>Alright! Very cool to see some in depth info about Lua coding here! Please, more of this stuff!!!</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->

<li id="comment-4102">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/e64cbfb305deffb381a8966586ceb6c1-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name">JCH_APPLE</h5>
			<span class="comment_date">Posted at 05:02h, 11 February</span>
						<div class="text_holder" id="comment-4102">
				<p>Really very interesting, thank you for this brilliant &#8220;more than tutorial&#8221;</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->

<li id="comment-4103">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/317afe1f656c3dddbc88428402cc54a7-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name"><a href='http://www.mindmagicgames.com/' rel='external nofollow' class='url'>Rachel</a></h5>
			<span class="comment_date">Posted at 09:09h, 11 February</span>
						<div class="text_holder" id="comment-4103">
				<p>Love it! In-depth Lua code like this really helps out the community. Please keep it coming!</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->

<li id="comment-4106">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/a5fd7fca18c6a92621c7a9a3108538c1-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name">Conor O'Nolan</h5>
			<span class="comment_date">Posted at 07:00h, 12 February</span>
						<div class="text_holder" id="comment-4106">
				<p>I was hoping this might help give the illusion of speeding things up in response to a buttonclick. I tried firing part 1 of my script on &#8216;began&#8217; phase and part 2 on &#8216;ended&#8217; phase.<br />
Seems not to work.<br />
In my code, I put up a dialogbox then load a large graphic.<br />
The dialogbox doesn&#8217;t show ordinarily until the file is loaded. So no illusion here.</p>
<p>If the coroutine did as I expected, the dialogbox would show instantly and then the file would load while user distracted.</p>
<p>Also tried firing twice with one function, but that doesn&#8217;t work either.<br />
Any thoughts?</p>
			</div>
		</div>
	</div>                          
                
<ul class="children">

<li id="comment-4107">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/aaaba44865e96be70caa15f6fc3078f7-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name"><a href='http://www.xibalbastudios.com/' rel='external nofollow' class='url'>Star Crunch</a></h5>
			<span class="comment_date">Posted at 14:32h, 12 February</span>
						<div class="text_holder" id="comment-4107">
				<p>Hi Conor.</p>
<p>The interim between <code>&amp;quot;began&amp;quot;</code> and <code>&amp;quot;ended&amp;quot;</code> will probably be too tight to make much difference, in the general case. How does it behave when you hold the touch for a while?</p>
<p>Maybe I could say more if I saw some code. In that case, though, it&#8217;d be better off in the forum since I&#8217;d see responses.</p>
			</div>
		</div>
	</div>                          
                
<ul class="children">

<li id="comment-4108">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/a5fd7fca18c6a92621c7a9a3108538c1-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name">Conor O'Nolan</h5>
			<span class="comment_date">Posted at 13:59h, 15 February</span>
						<div class="text_holder" id="comment-4108">
				<p>Started in Lua forum<br />
<a href="http://forums.coronalabs.com/topic/54565-coroutine-issue/" rel="nofollow">http://forums.coronalabs.com/topic/54565-coroutine-issue/</a></p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

<li id="comment-4109">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/cb69e2a84b0b513f22f573aeeea7c518-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name"><a href='http://MichaelPiercy.ie/' rel='external nofollow' class='url'>Michael</a></h5>
			<span class="comment_date">Posted at 14:41h, 02 March</span>
						<div class="text_holder" id="comment-4109">
				<p>Excellent post. Very detailed and filled with some easy to follow and incredibly useful code. Thanks for sharing!</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->

<li id="comment-4110">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/df3057ab12c6f6f4f4e3e4fb43ebc6c8-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name">Jens-Christian Finnerup</h5>
			<span class="comment_date">Posted at 01:09h, 03 March</span>
						<div class="text_holder" id="comment-4110">
				<p>Thanks for this awesome post! </p>
<p>Its great to see some Lua focused tutorials,<br />
Looking forward to future ones</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->

<li id="comment-4111">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/16ad3473d920aa9f4c37ddb6138408db-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name">Stephen</h5>
			<span class="comment_date">Posted at 16:38h, 21 March</span>
						<div class="text_holder" id="comment-4111">
				<p>Can&#8217;t get it to work&#8230;.hummm</p>
<p>Here is my code<br />
&#8212;&#8212;&#8212;&#8212; start of code &#8212;&#8212;&#8212;&#8212;<br />
local done = false<br />
local function DoSomething()<br />
    print(&#8220;Did Something&#8221;)<br />
end<br />
local function DoSomethingElse()<br />
    print (&#8220;Did Something Else&#8221;)<br />
end<br />
local function WaitUntilTrue( func, update )<br />
    while not func() do<br />
        if update then<br />
            update()<br />
        end<br />
        coroutine.yield()     &#8212; attempt to yield across metamethod/C-call boundary<br />
    end<br />
end</p>
<p>local pos = { x = 20 }<br />
DoSomething()</p>
<p>transition.to( pos, {<br />
    x = 50,</p>
<p>    onComplete = function()<br />
        done = true  &#8212; NOW we&#8217;re done.<br />
    end<br />
})</p>
<p>WaitUntilTrue( function()<br />
    return done  &#8212; Are we done yet?<br />
end )<br />
DoSomethingElse()</p>
<p>&#8212;&#8212;&#8212;&#8212;&#8211; end of code &#8212;&#8212;&#8212;&#8212;-</p>
<p>errors at coroutine.yield() with &#8220;attempt to yield across metamethod/C-call boundary&#8221;</p>
<p>am i suppose to put a coroutine.create or wrap somewhere??</p>
<p>help, i must be stupid. 🙁</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->

<li id="comment-4112">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/5a8151f8134d3ee8395e5da43244ab3f-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name">Ben</h5>
			<span class="comment_date">Posted at 10:50h, 09 August</span>
						<div class="text_holder" id="comment-4112">
				<p>Heres my question, imagine the following scenario : starting multiples coroutines that access the same global variable. Would this create a race condition and lead to data loss or even worse?</p>
			</div>
		</div>
	</div>                          
                
<ul class="children">

<li id="comment-4113">
	<div class="comment">
		<div class="image"> <img alt="" src='/wordpress/wp-content/uploads/gravatar/5fe5451355e7a006bc1dc1176ef23933-s75.jpg' class="avatar avatar-75" width="75" height="75" /> </div>
		<div class="text">
			<h5 class="name">Rob Miracle</h5>
			<span class="comment_date">Posted at 14:31h, 09 August</span>
						<div class="text_holder" id="comment-4113">
				<p>In any multi-threaded system (or in this case Coroutines) there will be race conditions when accessing common data and it&#8217;s the programmer&#8217;s responsibility to defend against it.</p>
			</div>
		</div>
	</div>                          
                
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	</ul>



 </div></div>
 <div class="comment_pager">
	<p></p>
 </div>
 <div class="comment_form">
	</div>
						
								
							


 
									</div>
								</div>	
								<div class="column2"> 
										<div class="column_inner">
		<aside class="sidebar">
							
			<div id="search-2" class="widget widget_search posts_holder"><h5>Search</h5><form role="search" method="get" id="searchform" action="/">
    <div><label class="screen-reader-text" for="s">Search for:</label>
        <input type="text" value="" placeholder="Search Here" name="s" id="s" />
        <input type="submit" id="searchsubmit" value="&#xf002" />
    </div>
</form></div>		<div id="recent-posts-9" class="widget widget_recent_entries posts_holder">		<h5>Recent Posts</h5>		<ul>
											<li>
					<a href="/blog/2020/04/30/future-of-corona/">Future of Corona</a>
									</li>
											<li>
					<a href="/blog/2020/04/30/the-forums-are-moving/">The Forums are moving&#8230;</a>
									</li>
											<li>
					<a href="/blog/2020/04/22/corona-labs-transition-update-22-april-2020/">Corona Labs transition update 22-April-2020</a>
									</li>
											<li>
					<a href="/blog/2020/04/16/google-64-bit-deadline-coming-august-1-2020/">Google 64-bit deadline coming August 1, 2020</a>
									</li>
											<li>
					<a href="/blog/2020/03/24/keep-calm-and-corona-the-game-engine-no-relation-on/">Keep Calm and Corona (the game engine, no relation) On!</a>
									</li>
					</ul>
		</div><div id="categories-8" class="widget widget_categories posts_holder"><h5>Categories</h5><form action="/" method="get"><label class="screen-reader-text" for="cat">Categories</label><select  name='cat' id='cat' class='postform' >
	<option value='-1'>Select Category</option>
	<option class="level-0" value="68">Amazon Kindle&nbsp;&nbsp;(3)</option>
	<option class="level-0" value="45">Android&nbsp;&nbsp;(21)</option>
	<option class="level-0" value="887">Art&nbsp;&nbsp;(5)</option>
	<option class="level-0" value="889">Business&nbsp;&nbsp;(2)</option>
	<option class="level-0" value="599">Business of Apps&nbsp;&nbsp;(10)</option>
	<option class="level-0" value="419">Case Study&nbsp;&nbsp;(12)</option>
	<option class="level-0" value="420">Case Study &#8211; Education&nbsp;&nbsp;(3)</option>
	<option class="level-0" value="435">Case Study &#8211; Game Studios&nbsp;&nbsp;(6)</option>
	<option class="level-0" value="37">Composer&nbsp;&nbsp;(3)</option>
	<option class="level-0" value="617">Corona Ads&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="266">Corona Editor&nbsp;&nbsp;(5)</option>
	<option class="level-0" value="54">Corona Geek&nbsp;&nbsp;(320)</option>
	<option class="level-0" value="858">Corona Geek Developer Interviews&nbsp;&nbsp;(2)</option>
	<option class="level-0" value="624">Corona Marketplace&nbsp;&nbsp;(5)</option>
	<option class="level-0" value="136">Corona native builds&nbsp;&nbsp;(21)</option>
	<option class="level-0" value="257">Corona Professional Services&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="13">Corona SDK&nbsp;&nbsp;(175)</option>
	<option class="level-0" value="284">CoronaCards&nbsp;&nbsp;(12)</option>
	<option class="level-0" value="39">Daily Build&nbsp;&nbsp;(38)</option>
	<option class="level-0" value="890">Design&nbsp;&nbsp;(9)</option>
	<option class="level-0" value="591">eBooks&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="421">Education&nbsp;&nbsp;(4)</option>
	<option class="level-0" value="63">FAQ&nbsp;&nbsp;(13)</option>
	<option class="level-0" value="458">Featured App&nbsp;&nbsp;(51)</option>
	<option class="level-0" value="67">Friday Night Forum&nbsp;&nbsp;(5)</option>
	<option class="level-0" value="268">From the Forum&nbsp;&nbsp;(179)</option>
	<option class="level-0" value="383">From the Store&nbsp;&nbsp;(34)</option>
	<option class="level-0" value="468">Fuse Powered&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="14">Game Development&nbsp;&nbsp;(60)</option>
	<option class="level-0" value="641">Google+ Hangouts&nbsp;&nbsp;(293)</option>
	<option class="level-0" value="15">Guest Bloggers&nbsp;&nbsp;(77)</option>
	<option class="level-0" value="316">iOS&nbsp;&nbsp;(15)</option>
	<option class="level-0" value="56">iPad&nbsp;&nbsp;(9)</option>
	<option class="level-0" value="58">iPhone&nbsp;&nbsp;(10)</option>
	<option class="level-0" value="43">Lua&nbsp;&nbsp;(5)</option>
	<option class="level-0" value="57">Mobile App of the Week&nbsp;&nbsp;(51)</option>
	<option class="level-0" value="451">Monetization&nbsp;&nbsp;(43)</option>
	<option class="level-0" value="892">Music&nbsp;&nbsp;(3)</option>
	<option class="level-0" value="17">News &amp; Announcements&nbsp;&nbsp;(248)</option>
	<option class="level-0" value="69">NOOK&nbsp;&nbsp;(2)</option>
	<option class="level-0" value="413">OS-X&nbsp;&nbsp;(5)</option>
	<option class="level-0" value="98">Partners&nbsp;&nbsp;(6)</option>
	<option class="level-0" value="895">Photography&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="50">Plugins&nbsp;&nbsp;(88)</option>
	<option class="level-0" value="897">Sport&nbsp;&nbsp;(2)</option>
	<option class="level-0" value="112">Tech&nbsp;&nbsp;(2)</option>
	<option class="level-0" value="515">Third-Party Tools&nbsp;&nbsp;(3)</option>
	<option class="level-0" value="379">Tutorial Treasury&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="7">Tutorials, Tips and Demos&nbsp;&nbsp;(42)</option>
	<option class="level-0" value="411">tvOS&nbsp;&nbsp;(5)</option>
	<option class="level-0" value="1">Uncategorized&nbsp;&nbsp;(24)</option>
	<option class="level-0" value="195">Videos&nbsp;&nbsp;(2)</option>
	<option class="level-0" value="443">Win32&nbsp;&nbsp;(3)</option>
	<option class="level-0" value="289">Windows Phone&nbsp;&nbsp;(2)</option>
</select>
</form>
<script type='text/javascript'>
/* <![CDATA[ */
(function() {
	var dropdown = document.getElementById( "cat" );
	function onCatChange() {
		if ( dropdown.options[ dropdown.selectedIndex ].value > 0 ) {
			dropdown.parentNode.submit();
		}
	}
	dropdown.onchange = onCatChange;
})();
/* ]]> */
</script>

</div><div id="custom_html-4" class="widget_text widget widget_custom_html posts_holder"><div class="textwidget custom-html-widget"><a class="sidebar_viewall" href="/blog/topics/">View all</a></div></div><div id="tag_cloud-8" class="widget widget_tag_cloud posts_holder"><h5>Tags</h5><div class="tagcloud"><a href="/blog/tags/ads/" class="tag-cloud-link tag-link-428 tag-link-position-1" aria-label="ads (9 items)">ads</a>
<a href="/blog/tags/analytics/" class="tag-cloud-link tag-link-120 tag-link-position-2" aria-label="Analytics (6 items)">Analytics</a>
<a href="/blog/tags/android-2/" class="tag-cloud-link tag-link-51 tag-link-position-3" aria-label="android (27 items)">android</a>
<a href="/blog/tags/app-development/" class="tag-cloud-link tag-link-162 tag-link-position-4" aria-label="app development (13 items)">app development</a>
<a href="/blog/tags/app-marketing/" class="tag-cloud-link tag-link-598 tag-link-position-5" aria-label="App Marketing (11 items)">App Marketing</a>
<a href="/blog/tags/app-monetization/" class="tag-cloud-link tag-link-135 tag-link-position-6" aria-label="App Monetization (11 items)">App Monetization</a>
<a href="/blog/tags/art/" class="tag-cloud-link tag-link-574 tag-link-position-7" aria-label="art (7 items)">art</a>
<a href="/blog/tags/articles/" class="tag-cloud-link tag-link-902 tag-link-position-8" aria-label="Articles (9 items)">Articles</a>
<a href="/blog/tags/business-2/" class="tag-cloud-link tag-link-74 tag-link-position-9" aria-label="business (11 items)">business</a>
<a href="/blog/tags/cloud/" class="tag-cloud-link tag-link-415 tag-link-position-10" aria-label="cloud (8 items)">cloud</a>
<a href="/blog/tags/code-samples/" class="tag-cloud-link tag-link-471 tag-link-position-11" aria-label="Code Samples (13 items)">Code Samples</a>
<a href="/blog/tags/collision-detection/" class="tag-cloud-link tag-link-178 tag-link-position-12" aria-label="collision detection (7 items)">collision detection</a>
<a href="/blog/tags/composer/" class="tag-cloud-link tag-link-36 tag-link-position-13" aria-label="composer (11 items)">composer</a>
<a href="/blog/tags/corona/" class="tag-cloud-link tag-link-75 tag-link-position-14" aria-label="corona (16 items)">corona</a>
<a href="/blog/tags/corona-plug-ins/" class="tag-cloud-link tag-link-139 tag-link-position-15" aria-label="Corona Plug-ins (7 items)">Corona Plug-ins</a>
<a href="/blog/tags/corona-sdk/" class="tag-cloud-link tag-link-80 tag-link-position-16" aria-label="Corona SDK (14 items)">Corona SDK</a>
<a href="/blog/tags/coronasdk/" class="tag-cloud-link tag-link-61 tag-link-position-17" aria-label="CoronaSDK (10 items)">CoronaSDK</a>
<a href="/blog/tags/coronium/" class="tag-cloud-link tag-link-475 tag-link-position-18" aria-label="Coronium (11 items)">Coronium</a>
<a href="/blog/tags/desktop-game-development/" class="tag-cloud-link tag-link-841 tag-link-position-19" aria-label="desktop game development (20 items)">desktop game development</a>
<a href="/blog/tags/facebook/" class="tag-cloud-link tag-link-22 tag-link-position-20" aria-label="Facebook (9 items)">Facebook</a>
<a href="/blog/tags/faq/" class="tag-cloud-link tag-link-64 tag-link-position-21" aria-label="FAQ (6 items)">FAQ</a>
<a href="/blog/tags/game/" class="tag-cloud-link tag-link-82 tag-link-position-22" aria-label="game (22 items)">game</a>
<a href="/blog/tags/game-design/" class="tag-cloud-link tag-link-473 tag-link-position-23" aria-label="Game Design (23 items)">Game Design</a>
<a href="/blog/tags/game-development-2/" class="tag-cloud-link tag-link-587 tag-link-position-24" aria-label="game development (28 items)">game development</a>
<a href="/blog/tags/game-development/" class="tag-cloud-link tag-link-211 tag-link-position-25" aria-label="Game Development (33 items)">Game Development</a>
<a href="/blog/tags/gpgs/" class="tag-cloud-link tag-link-49 tag-link-position-26" aria-label="GPGS (7 items)">GPGS</a>
<a href="/blog/tags/graphics-2/" class="tag-cloud-link tag-link-103 tag-link-position-27" aria-label="graphics (8 items)">graphics</a>
<a href="/blog/tags/graphics-2-0/" class="tag-cloud-link tag-link-31 tag-link-position-28" aria-label="Graphics 2.0 (11 items)">Graphics 2.0</a>
<a href="/blog/tags/hackathon/" class="tag-cloud-link tag-link-109 tag-link-position-29" aria-label="hackathon (6 items)">hackathon</a>
<a href="/blog/tags/indie/" class="tag-cloud-link tag-link-83 tag-link-position-30" aria-label="indie (10 items)">indie</a>
<a href="/blog/tags/ios/" class="tag-cloud-link tag-link-52 tag-link-position-31" aria-label="iOS (36 items)">iOS</a>
<a href="/blog/tags/ipad-2/" class="tag-cloud-link tag-link-76 tag-link-position-32" aria-label="ipad (11 items)">ipad</a>
<a href="/blog/tags/iphone-2/" class="tag-cloud-link tag-link-77 tag-link-position-33" aria-label="iphone (10 items)">iphone</a>
<a href="/blog/tags/level-design/" class="tag-cloud-link tag-link-822 tag-link-position-34" aria-label="level design (7 items)">level design</a>
<a href="/blog/tags/lua-2/" class="tag-cloud-link tag-link-44 tag-link-position-35" aria-label="lua (7 items)">lua</a>
<a href="/blog/tags/marketplace/" class="tag-cloud-link tag-link-596 tag-link-position-36" aria-label="marketplace (29 items)">marketplace</a>
<a href="/blog/tags/monetization-2/" class="tag-cloud-link tag-link-151 tag-link-position-37" aria-label="monetization (24 items)">monetization</a>
<a href="/blog/tags/physics/" class="tag-cloud-link tag-link-55 tag-link-position-38" aria-label="physics (14 items)">physics</a>
<a href="/blog/tags/physics-examples/" class="tag-cloud-link tag-link-809 tag-link-position-39" aria-label="Physics Examples (11 items)">Physics Examples</a>
<a href="/blog/tags/plugin/" class="tag-cloud-link tag-link-140 tag-link-position-40" aria-label="plugin (16 items)">plugin</a>
<a href="/blog/tags/plugins/" class="tag-cloud-link tag-link-104 tag-link-position-41" aria-label="plugins (26 items)">plugins</a>
<a href="/blog/tags/sample-code/" class="tag-cloud-link tag-link-363 tag-link-position-42" aria-label="Sample Code (8 items)">Sample Code</a>
<a href="/blog/tags/tutorial/" class="tag-cloud-link tag-link-6 tag-link-position-43" aria-label="tutorial (32 items)">tutorial</a>
<a href="/blog/tags/utility-2/" class="tag-cloud-link tag-link-78 tag-link-position-44" aria-label="utility (6 items)">utility</a>
<a href="/blog/tags/widget-2/" class="tag-cloud-link tag-link-35 tag-link-position-45" aria-label="widget (7 items)">widget</a></div>
</div><div id="custom_html-5" class="widget_text widget widget_custom_html posts_holder"><div class="textwidget custom-html-widget"><a class="sidebar_viewall" href="/blog/tags/">View all</a></div></div>		</aside>
	</div>
								</div>
							</div>
											</div>
                                 </div>
	


		
	</div>
</div>



	<footer >
		<div class="footer_inner clearfix">
				<div class="footer_top_holder">
                            <div style="background-color: #ededed;height: 1px" class="footer_top_border"></div>
            			<div class="footer_top">
								<div class="container">
					<div class="container_inner">
																	<div class="four_columns clearfix">
								<div class="column1 footer_col1">
									<div class="column_inner">
										<div id="text_icl-3" class="widget widget_text_icl"><h5>About</h5>		<div class="textwidget"><hr class="footer_hr_list" />

<ul class="footer_nav">
<li><a title="" href="/product/">Product</a></li>
<li><a title="FAQ" href="/faq/">FAQ</a></li>
<li><a href="/roadmap/">Roadmap</a></li>
<li><a href="/contact/">Contact</a></li>
<li><a href="/presskit.pdf" target="_blank" rel="noopener">Press Kit</a></li>
</ul></div>
		</div>									</div>
								</div>
								<div class="column2 footer_col2">
									<div class="column_inner">
										<div id="text-15" class="widget widget_text"><h5>Learn</h5>			<div class="textwidget"><hr class="footer_hr_list" />
<ul class="footer_nav">
<li>
    <a href="https://docs.coronalabs.com/guide/programming/index.html" target="_blank" rel="noopener">Getting started</a>
  </li>
<li>
    <a href="https://docs.coronalabs.com/guide/index.html" target="_blank" rel="noopener">Developer guides</a>
  </li>
<li>
    <a href="https://docs.coronalabs.com/" target="_blank" rel="noopener">Documentation</a>
  </li>
<li>
    <a href="https://docs.coronalabs.com/tutorial/" target="_blank" rel="noopener">Tutorials</a>
  </li>
<li>
    <a href="https://docs.coronalabs.com/guide/start/introLua/index.html" target="_blank" rel="noopener">Learn Lua</a>
  </li>
</ul>
</div>
		</div>									</div>
								</div>
								<div class="column3 footer_col3">
									<div class="column_inner">
										<div id="text-6" class="widget widget_text"><h5>Community</h5>			<div class="textwidget"><hr class="footer_hr_list" />

<ul class="footer_nav">
 	<li><a href="https://forums.solar2d.com/" target="_blank" rel="noopener">Forum</a></li>
 	<li><a href="https://marketplace.coronalabs.com/" target="_blank" rel="noopener">Marketplace</a></li>
 	<li><a href="/blog/">Blog</a></li>
 	<li><a href="/support/">Support</a></li>
</ul></div>
		</div>									</div>
								</div>
								<div class="column4 footer_col4">
									<div class="column_inner">
										<div id="text-2" class="widget widget_text">			<div class="textwidget"><p><span class='q_social_icon_holder normal_social' ><a itemprop='url' href='https://www.facebook.com/CoronaLabs' target='_blank'><i class="qode_icon_font_awesome fa fa-facebook fa-lg simple_social" style="font-size: 15px;" ></i></a></span> <span class='q_social_icon_holder normal_social' ><a itemprop='url' href='https://twitter.com/coronalabs' target='_blank'><i class="qode_icon_font_awesome fa fa-twitter fa-lg simple_social" style="font-size: 15px;" ></i></a></span> <span class='q_social_icon_holder normal_social' ><a itemprop='url' href='https://vk.com/corona_pub' target='_blank'><i class="qode_icon_font_awesome fa fa-vk fa-lg simple_social" style="font-size: 15px;" ></i></a></span> <span class='q_social_icon_holder normal_social' ><a itemprop='url' href='https://t.me/CoronaRu' target='_blank'><i class="qode_icon_font_awesome fa fa-telegram fa-lg simple_social" style="font-size: 15px;" ></i></a></span> <span class='q_social_icon_holder normal_social' ><a itemprop='url' href='https://www.linkedin.com/company/corona-labs' target='_blank'><i class="qode_icon_font_awesome fa fa-linkedin fa-lg simple_social" style="font-size: 15px;" ></i></a></span> <span class='q_social_icon_holder normal_social' ><a itemprop='url' href='https://www.youtube.com/user/CoronaLabs' target='_blank'><i class="qode_icon_font_awesome fa fa-youtube fa-lg simple_social" style="font-size: 15px;" ></i></a></span> <span class='q_social_icon_holder normal_social' ><a itemprop='url' href='https://github.com/coronalabs' target='_blank'><i class="qode_icon_font_awesome fa fa-github fa-lg simple_social" style="font-size: 15px;" ></i></a></span> <span class='q_social_icon_holder normal_social' ><a itemprop='url' href='/slack/' target='_self'><i class="qode_icon_font_awesome fa fa-slack fa-lg simple_social" style="font-size: 15px;" ></i></a></span></p>
<hr class="footer_hr_list" />
<div class="separator  transparent center" style="margin-top: 1px;margin-bottom: 1px;"></div>

<p><img class="footer_logo" style="width: 50%;" src="/wordpress/wp-content/uploads/2017/06/corona_logo_footer2906.png" alt="logo" /></p>
<div class="separator  transparent center" style="margin-top: 1px;margin-bottom: 1px;"></div>

<p style="font-size: 15px; line-height: 22px;">Our mission is to enable anyone to create great mobile apps. Our flagship product, Corona, is the world’s most advanced 2D mobile development platform.</p>
</div>
		</div>									</div>
								</div>
							</div>
															</div>
				</div>
							</div>
					</div>
							<div class="footer_bottom_holder">
                									<div class="footer_bottom">
						<div class="textwidget">© 2018 Corona Labs Inc. <a style="text-decoration: underline; color: #707a89;" href="/terms-and-conditions/"> Terms of service</a> &amp; <a style="text-decoration: underline; color: #707a89;" href="/privacy-policy/">Privacy policy</a></div>
					</div>
								</div>
				</div>
	</footer>
		
</div>
</div>
<div class="wppopups-whole" style="display: none"><div class="spu-bg" id="spu-bg-76435"></div><div class="spu-box spu-animation-fade spu-theme-elegant spu-position-centered" id="spu-76435" data-id="76435" data-parent="0" data-settings="{&quot;position&quot;:{&quot;position&quot;:&quot;centered&quot;},&quot;animation&quot;:{&quot;animation&quot;:&quot;fade&quot;},&quot;colors&quot;:{&quot;show_overlay&quot;:&quot;yes-color&quot;,&quot;overlay_color&quot;:&quot;rgba(117, 169, 177, 0.33)&quot;,&quot;overlay_blur&quot;:&quot;2&quot;,&quot;bg_color&quot;:&quot;rgb(246, 246, 240)&quot;,&quot;bg_img&quot;:&quot;&quot;,&quot;bg_img_repeat&quot;:&quot;no-repeat&quot;,&quot;bg_img_size&quot;:&quot;cover&quot;},&quot;close&quot;:{&quot;close_color&quot;:&quot;rgb(255, 255, 255)&quot;,&quot;close_hover_color&quot;:&quot;#000&quot;,&quot;close_shadow_color&quot;:&quot;#000&quot;,&quot;close_size&quot;:&quot;40&quot;,&quot;close_position&quot;:&quot;top_right&quot;},&quot;popup_box&quot;:{&quot;width&quot;:&quot;750px&quot;,&quot;padding&quot;:&quot;50&quot;,&quot;auto_height&quot;:&quot;yes&quot;,&quot;height&quot;:&quot;430px&quot;},&quot;border&quot;:{&quot;border_type&quot;:&quot;solid&quot;,&quot;border_color&quot;:&quot;rgb(6, 94, 79)&quot;,&quot;border_width&quot;:&quot;5&quot;,&quot;border_radius&quot;:&quot;0&quot;,&quot;border_margin&quot;:&quot;14&quot;},&quot;shadow&quot;:{&quot;shadow_color&quot;:&quot;#ccc&quot;,&quot;shadow_type&quot;:&quot;outset&quot;,&quot;shadow_x_offset&quot;:&quot;5&quot;,&quot;shadow_y_offset&quot;:&quot;5&quot;,&quot;shadow_blur&quot;:&quot;5&quot;,&quot;shadow_spread&quot;:&quot;0&quot;},&quot;css&quot;:{&quot;custom_css&quot;:&quot;&quot;},&quot;id&quot;:&quot;76435&quot;,&quot;rules&quot;:{&quot;group_0&quot;:{&quot;rule_0&quot;:{&quot;rule&quot;:&quot;page_type&quot;,&quot;operator&quot;:&quot;==&quot;,&quot;value&quot;:&quot;all_pages&quot;}}},&quot;settings&quot;:{&quot;popup_title&quot;:&quot;Corona SDK is now Solar2D&quot;,&quot;popup_desc&quot;:&quot;&quot;,&quot;test_mode&quot;:&quot;0&quot;,&quot;powered_link&quot;:&quot;0&quot;,&quot;popup_class&quot;:&quot;&quot;,&quot;popup_hidden_class&quot;:&quot;spu-theme-elegant&quot;,&quot;close_on_conversion&quot;:&quot;0&quot;,&quot;conversion_cookie_name&quot;:&quot;now_solar2d&quot;,&quot;conversion_cookie_duration&quot;:&quot;1&quot;,&quot;conversion_cookie_type&quot;:&quot;h&quot;,&quot;closing_cookie_name&quot;:&quot;now_solar2d_close&quot;,&quot;closing_cookie_duration&quot;:&quot;1&quot;,&quot;closing_cookie_type&quot;:&quot;h&quot;},&quot;triggers&quot;:{&quot;trigger_0&quot;:{&quot;trigger&quot;:&quot;seconds&quot;,&quot;value&quot;:&quot;1&quot;}}}"><div class="spu-container"><div class="spu-content"><div style="text-align: center; font-family: 'Lato',Open Sans;">
<h5 style="text-align: center; color: #646464;">The website is no longer being updated, and is for archival purposes only.</h5>
<p>&nbsp;</p>
<h3>Corona SDK is now Solar2D</h3>
<p><a href="https://Solar2D.com/"><img class="alignnone size-medium wp-image-76413" style="font-size: 16px;" src="/wordpress/wp-content/uploads/2020/04/finalpost-art-300x124.png" alt="" width="300" height="124" srcset="/wordpress/wp-content/uploads/2020/04/finalpost-art-300x124.png 300w, /wordpress/wp-content/uploads/2020/04/finalpost-art-768x317.png 768w, /wordpress/wp-content/uploads/2020/04/finalpost-art-1024x423.png 1024w, /wordpress/wp-content/uploads/2020/04/finalpost-art-700x289.png 700w, /wordpress/wp-content/uploads/2020/04/finalpost-art-125x52.png 125w, /wordpress/wp-content/uploads/2020/04/finalpost-art.png 1240w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3><a href="https://Solar2D.com/">https://Solar2D.com/</a></h3>
</div>
</div><a href="#" class="spu-close spu-close-popup spu-close-top_right">&times;</a><span class="spu-timer"></span></div></div><!--spu-box--></div><script type='text/javascript'>
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"cached":"1"};
/* ]]> */
</script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/plugins/contact-form-7/includes/js/scripts-44ab35495eb13b448ea9307a96f479f3.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wppopups_vars = {"is_admin":"","ajax_url":"\/wordpress\/wp-admin\/admin-ajax.php?lang=en","pid":"61368","is_front_page":"","is_blog_page":"","is_category":"","site_url":"\/wordpress","is_archive":"","is_search":"","is_singular":"1","is_preview":"","facebook":"","twitter":"","nonce":"b47d1a0f1c"};
/* ]]> */
</script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/plugins/wp-popups-lite/src/assets/js/wppopups-933b528a2d57748fe8c83f115a193bac.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var qodeLike = {"ajaxurl":"\/wordpress\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='/wordpress/wp-content/themes/bridge/js/qode-like.min.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/core.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/widget.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/accordion.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/position.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/menu.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-includes/js/wp-a11y.min.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var uiAutocompleteL10n = {"noResults":"No results found.","oneResult":"1 result found. Use up and down arrow keys to navigate.","manyResults":"%d results found. Use up and down arrow keys to navigate.","itemSelected":"Item selected."};
/* ]]> */
</script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/autocomplete.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/button.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/datepicker.min-1.11.4.js'></script>
<script type='text/javascript'>
jQuery(document).ready(function(jQuery){jQuery.datepicker.setDefaults({"closeText":"Close","currentText":"Today","monthNames":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthNamesShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"nextText":"Next","prevText":"Previous","dayNames":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"dayNamesShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"dayNamesMin":["S","M","T","W","T","F","S"],"dateFormat":"MM d, yy","firstDay":1,"isRTL":false});});
</script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/mouse.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/resizable.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/draggable.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/dialog.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/droppable.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/progressbar.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/selectable.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/sortable.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/slider.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/spinner.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/tooltip.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/tabs.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-blind.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-bounce.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-clip.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-drop.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-explode.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-fade.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-fold.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-highlight.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-pulsate.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-size.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-scale.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-shake.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-slide.min-1.11.4.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-includes/js/jquery/ui/effect-transfer.min-1.11.4.js'></script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/themes/bridge/js/plugins-301fe8920786443d62854aa56f62d416.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/themes/bridge/js/jquery.carouFredSel-6.2.1.min.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/themes/bridge/js/lemmon-slider.min.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/themes/bridge/js/jquery.fullPage.min.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/themes/bridge/js/jquery.mousewheel.min.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/themes/bridge/js/jquery.touchSwipe.min.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-content/plugins/js_composer/assets/lib/bower/isotope/dist/isotope.pkgd.min-5.5.5.js'></script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/themes/bridge/js/jquery.stretch-589214c34f008189ea441c146f569db3.js'></script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/themes/bridge/js/default_dynamic-7509df77330fcb9cc352a1e134790124.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var QodeAdminAjax = {"ajaxurl":"\/wordpress\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='/wordpress/wp-content/themes/bridge/js/default.min.js'></script>
<script data-minify="1" type='text/javascript' src='/wordpress/wp-content/cache/min/1/wordpress/wp-content/themes/bridge/js/custom_js-46e09ba307b0b6c4b86ea442fd0f8392.js'></script>
<script type='text/javascript' src='/wordpress/wp-includes/js/comment-reply.min.js'></script>
<script type='text/javascript' src='/wordpress/wp-content/cache/busting/1/wordpress/wp-content/plugins/js_composer/assets/js/dist/js_composer_front.min-5.5.5.js'></script>
<script type="text/javascript">
                WebFontConfig = {
                    google: { families: [ 'Lato:100,200,300,400,500,600,700,800,900,300italic,400italic:latin,latin-ext', 'Exo 2:100,200,300,400,500,600,700,800,900,300italic,400italic:latin,latin-ext', 'Exo:100,200,300,400,500,600,700,800,900,300italic,400italic:latin,latin-ext', 'Open Sans:400,300:latin' ] }
        };
        (function() {
            var wf = document.createElement('script');
            wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
                '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
            wf.type = 'text/javascript';
            wf.async = 'true';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(wf, s);
        })(); </script>
<script>
jQuery( document ).ready(function() {
jQuery('a[title="Forum"]').click(function(e) {trackOutboundLink('https://forums.coronalabs.com/', "outboundForum"); console.log("Forum clicked");});
jQuery('a[title="Marketplace"]').click(function(e) {trackOutboundLink('https://marketplace.coronalabs.com/', "outboundMarketplace"); console.log("Marketplace clicked");});
});
</script>


</body>
</html>	
<!-- This website is like a Rocket, isn't it? Performance optimized by WP Rocket. Learn more: https://wp-rocket.me -->